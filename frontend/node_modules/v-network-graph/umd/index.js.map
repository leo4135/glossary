{"version":3,"file":"index.js","sources":["../src/common/types.ts","../src/common/common.ts","../src/composables/container.ts","../node_modules/lodash-es/_freeGlobal.js","../node_modules/lodash-es/_root.js","../node_modules/lodash-es/_Symbol.js","../node_modules/lodash-es/_getRawTag.js","../node_modules/lodash-es/_objectToString.js","../node_modules/lodash-es/_baseGetTag.js","../node_modules/lodash-es/isObjectLike.js","../node_modules/lodash-es/isSymbol.js","../node_modules/lodash-es/_arrayMap.js","../node_modules/lodash-es/isArray.js","../node_modules/lodash-es/_baseToString.js","../node_modules/lodash-es/_trimmedEndIndex.js","../node_modules/lodash-es/_baseTrim.js","../node_modules/lodash-es/isObject.js","../node_modules/lodash-es/toNumber.js","../node_modules/lodash-es/toFinite.js","../node_modules/lodash-es/toInteger.js","../node_modules/lodash-es/identity.js","../node_modules/lodash-es/isFunction.js","../node_modules/lodash-es/_coreJsData.js","../node_modules/lodash-es/_isMasked.js","../node_modules/lodash-es/_toSource.js","../node_modules/lodash-es/_baseIsNative.js","../node_modules/lodash-es/_getValue.js","../node_modules/lodash-es/_getNative.js","../node_modules/lodash-es/_WeakMap.js","../node_modules/lodash-es/_baseCreate.js","../node_modules/lodash-es/_apply.js","../node_modules/lodash-es/noop.js","../node_modules/lodash-es/_copyArray.js","../node_modules/lodash-es/_shortOut.js","../node_modules/lodash-es/constant.js","../node_modules/lodash-es/_defineProperty.js","../node_modules/lodash-es/_baseSetToString.js","../node_modules/lodash-es/_setToString.js","../node_modules/lodash-es/_baseFindIndex.js","../node_modules/lodash-es/_baseIsNaN.js","../node_modules/lodash-es/_strictIndexOf.js","../node_modules/lodash-es/_baseIndexOf.js","../node_modules/lodash-es/_arrayIncludes.js","../node_modules/lodash-es/_isIndex.js","../node_modules/lodash-es/_baseAssignValue.js","../node_modules/lodash-es/eq.js","../node_modules/lodash-es/_assignValue.js","../node_modules/lodash-es/_copyObject.js","../node_modules/lodash-es/_overRest.js","../node_modules/lodash-es/_baseRest.js","../node_modules/lodash-es/isLength.js","../node_modules/lodash-es/isArrayLike.js","../node_modules/lodash-es/_isIterateeCall.js","../node_modules/lodash-es/_createAssigner.js","../node_modules/lodash-es/_isPrototype.js","../node_modules/lodash-es/_baseTimes.js","../node_modules/lodash-es/_baseIsArguments.js","../node_modules/lodash-es/isArguments.js","../node_modules/lodash-es/stubFalse.js","../node_modules/lodash-es/isBuffer.js","../node_modules/lodash-es/_baseIsTypedArray.js","../node_modules/lodash-es/_baseUnary.js","../node_modules/lodash-es/_nodeUtil.js","../node_modules/lodash-es/isTypedArray.js","../node_modules/lodash-es/_arrayLikeKeys.js","../node_modules/lodash-es/_overArg.js","../node_modules/lodash-es/_nativeKeys.js","../node_modules/lodash-es/_baseKeys.js","../node_modules/lodash-es/keys.js","../node_modules/lodash-es/_nativeKeysIn.js","../node_modules/lodash-es/_baseKeysIn.js","../node_modules/lodash-es/keysIn.js","../node_modules/lodash-es/_nativeCreate.js","../node_modules/lodash-es/_hashClear.js","../node_modules/lodash-es/_hashDelete.js","../node_modules/lodash-es/_hashGet.js","../node_modules/lodash-es/_hashHas.js","../node_modules/lodash-es/_hashSet.js","../node_modules/lodash-es/_Hash.js","../node_modules/lodash-es/_listCacheClear.js","../node_modules/lodash-es/_assocIndexOf.js","../node_modules/lodash-es/_listCacheDelete.js","../node_modules/lodash-es/_listCacheGet.js","../node_modules/lodash-es/_listCacheHas.js","../node_modules/lodash-es/_listCacheSet.js","../node_modules/lodash-es/_ListCache.js","../node_modules/lodash-es/_Map.js","../node_modules/lodash-es/_mapCacheClear.js","../node_modules/lodash-es/_isKeyable.js","../node_modules/lodash-es/_getMapData.js","../node_modules/lodash-es/_mapCacheDelete.js","../node_modules/lodash-es/_mapCacheGet.js","../node_modules/lodash-es/_mapCacheHas.js","../node_modules/lodash-es/_mapCacheSet.js","../node_modules/lodash-es/_MapCache.js","../node_modules/lodash-es/toString.js","../node_modules/lodash-es/_arrayPush.js","../node_modules/lodash-es/_getPrototype.js","../node_modules/lodash-es/isPlainObject.js","../node_modules/lodash-es/_baseSlice.js","../node_modules/lodash-es/_createRound.js","../node_modules/lodash-es/chunk.js","../node_modules/lodash-es/_stackClear.js","../node_modules/lodash-es/_stackDelete.js","../node_modules/lodash-es/_stackGet.js","../node_modules/lodash-es/_stackHas.js","../node_modules/lodash-es/_stackSet.js","../node_modules/lodash-es/_Stack.js","../node_modules/lodash-es/_cloneBuffer.js","../node_modules/lodash-es/_arrayFilter.js","../node_modules/lodash-es/stubArray.js","../node_modules/lodash-es/_getSymbols.js","../node_modules/lodash-es/_baseGetAllKeys.js","../node_modules/lodash-es/_getAllKeys.js","../node_modules/lodash-es/_DataView.js","../node_modules/lodash-es/_Promise.js","../node_modules/lodash-es/_Set.js","../node_modules/lodash-es/_getTag.js","../node_modules/lodash-es/_Uint8Array.js","../node_modules/lodash-es/_cloneArrayBuffer.js","../node_modules/lodash-es/_cloneTypedArray.js","../node_modules/lodash-es/_initCloneObject.js","../node_modules/lodash-es/_setCacheAdd.js","../node_modules/lodash-es/_setCacheHas.js","../node_modules/lodash-es/_SetCache.js","../node_modules/lodash-es/_arraySome.js","../node_modules/lodash-es/_cacheHas.js","../node_modules/lodash-es/_equalArrays.js","../node_modules/lodash-es/_mapToArray.js","../node_modules/lodash-es/_setToArray.js","../node_modules/lodash-es/_equalByTag.js","../node_modules/lodash-es/_equalObjects.js","../node_modules/lodash-es/_baseIsEqualDeep.js","../node_modules/lodash-es/_baseIsEqual.js","../node_modules/lodash-es/_createBaseFor.js","../node_modules/lodash-es/_baseFor.js","../node_modules/lodash-es/now.js","../node_modules/lodash-es/debounce.js","../node_modules/lodash-es/_assignMergeValue.js","../node_modules/lodash-es/isArrayLikeObject.js","../node_modules/lodash-es/_safeGet.js","../node_modules/lodash-es/toPlainObject.js","../node_modules/lodash-es/_baseMergeDeep.js","../node_modules/lodash-es/_baseMerge.js","../node_modules/lodash-es/mergeWith.js","../node_modules/lodash-es/isEqual.js","../node_modules/lodash-es/merge.js","../node_modules/lodash-es/round.js","../node_modules/lodash-es/_createSet.js","../node_modules/lodash-es/_baseUniq.js","../node_modules/lodash-es/uniq.js","../src/common/configs.ts","../src/utils/visual.ts","../src/layouts/simple.ts","../src/common/config-defaults.ts","../src/composables/config.ts","../src/composables/id.ts","../src/utils/object.ts","../src/modules/edge/group.ts","../src/modules/vector2d/methods.ts","../src/modules/vector2d/vector2d.ts","../src/modules/vector2d/index.ts","../src/modules/calculation/line.ts","../src/modules/calculation/point.ts","../src/modules/calculation/2d.ts","../src/modules/node/node.ts","../src/utils/collection.ts","../src/modules/calculation/path.ts","../src/composables/objectState.ts","../src/utils/string.ts","../src/composables/marker.ts","../src/composables/state.ts","../src/utils/map.ts","../src/composables/mouse/core.ts","../src/composables/mouse/node.ts","../src/composables/mouse/edge.ts","../src/composables/mouse/container.ts","../src/composables/mouse/path.ts","../src/utils/download.ts","../src/utils/svg.ts","../src/composables/mouse/boxSelection.ts","../src/composables/mouse/index.ts","../node_modules/mitt/dist/mitt.mjs","../src/composables/event-emitter.ts","../node_modules/@dash14/svg-pan-zoom/src/utilities.js","../node_modules/@dash14/svg-pan-zoom/src/uniwheel.js","../node_modules/@dash14/svg-pan-zoom/src/svg-utilities.js","../node_modules/@dash14/svg-pan-zoom/src/control-icons.js","../node_modules/@dash14/svg-pan-zoom/src/shadow-viewport.js","../node_modules/@dash14/svg-pan-zoom/src/svg-pan-zoom.js","../src/modules/svg-pan-zoom-ex.ts","../src/composables/svg-pan-zoom.ts","../src/composables/zoom.ts","../src/composables/transition.ts","../src/composables/object.ts","../src/utils/props.ts","../src/composables/selection.ts","../src/composables/layout.ts","../src/modules/collection/iterate.ts","../src/modules/collection/array.ts","../src/composables/layer.ts","../src/modules/vue/nextTick.ts","../src/utils/box.ts","../src/modules/view/fit.ts","../src/components/marker/VMarkerHeadArrow.vue","../src/components/marker/VMarkerHeadAngle.vue","../src/components/marker/VMarkerHead.vue","../src/components/background/VBackgroundGrid.vue","../src/components/background/VBackgroundViewport.vue","../src/components/edge/VEdgeBackground.vue","../src/components/edge/VEdgeBackgrounds.vue","../src/components/base/VLine.vue","../src/components/base/VArc.vue","../src/components/edge/VEdgeCurved.vue","../src/components/edge/VEdge.vue","../src/components/base/VShape.vue","../src/components/base/VLabelText.vue","../src/components/edge/VEdgeSummarized.vue","../src/components/edge/VEdgeOverlay.vue","../src/components/edge/VEdgeGroups.vue","../src/components/layers/VEdgesLayer.vue","../src/components/edge/VEdgeLabelPlace.vue","../src/components/edge/VEdgeLabelsPlace.vue","../src/components/edge/VEdgeLabels.vue","../src/components/node/VNodeFocusRing.vue","../src/components/layers/VFocusringLayer.vue","../src/components/node/VNode.vue","../src/components/layers/VNodesLayer.vue","../src/modules/node/label.ts","../src/components/node/VNodeLabel.vue","../src/components/layers/VNodeLabelsLayer.vue","../src/components/path/VPath.vue","../src/components/path/VPaths.vue","../src/components/VNetworkGraph.vue","../src/components/base/VStyle.vue","../src/components/edge/VEdgeLabel.vue","../src/layouts/grid.ts","../src/index.ts"],"sourcesContent":["import { RecursivePartial } from \"./common\"\n\n/* ------------------------------------------ *\n * Core types\n * ------------------------------------------ */\n\nexport interface Position {\n  x: number\n  y: number\n}\n\nexport interface LinePosition {\n  p1: Position\n  p2: Position\n}\n\nexport interface Size {\n  width: number\n  height: number\n}\n\nexport interface Rectangle {\n  pos: Position\n  size: Size\n}\n\n/** An object with a field named id */\nexport interface IdentifiedObject {\n  id: string\n}\n\nexport interface Box {\n  top: number\n  bottom: number\n  left: number\n  right: number\n}\n\n/* ------------------------------------------ *\n * Network graph elements\n * ------------------------------------------ */\n\nexport interface Node {\n  name?: string\n  // any properties\n  [x: string]: any\n}\n\nexport type Nodes = Record<string, Node>\nexport type NodeWithId = Node & IdentifiedObject\n\nexport interface Edge {\n  source: string\n  target: string\n  // any properties\n  [x: string]: any\n}\n\nexport type Edges = Record<string, Edge>\nexport type EdgeWithId = Edge & IdentifiedObject\n\nexport type LayerName = \"edges\" | \"edge-labels\" | \"focusring\" | \"nodes\" | \"node-labels\" | \"paths\"\n\nexport type LayerPosition = LayerName | \"base\" | \"grid\" | \"background\" | \"root\"\n\nexport type Layers = Record<string, LayerPosition>\n\nexport const LayerPositions: readonly LayerPosition[] = [\n  \"paths\",\n  \"node-labels\",\n  \"nodes\",\n  \"focusring\",\n  \"edge-labels\",\n  \"edges\",\n  \"base\",\n  \"grid\",\n  \"background\",\n  \"root\",\n]\n\n/* ------------------------------------------ *\n * View\n * ------------------------------------------ */\n\nexport type ViewMode = \"default\" | \"node\" | \"edge\" | \"path\" | \"box-selection\"\n\n/* ------------------------------------------ *\n * Layouts\n * ------------------------------------------ */\n\nexport interface FixablePosition extends Position {\n  fixed?: boolean\n}\n\nexport type NodePositions = Record<string, FixablePosition>\n\nexport interface Layouts {\n  nodes: NodePositions\n}\n/** for User Specified */\nexport type UserLayouts = RecursivePartial<Layouts>\n\n/* ------------------------------------------ *\n * Edge labels\n * ------------------------------------------ */\n\nexport interface EdgePosition {\n  source: Position\n  target: Position\n}\n\nexport interface EdgeLabelArea {\n  source: {\n    above: Position\n    below: Position\n  }\n  target: {\n    above: Position\n    below: Position\n  }\n}\n\n/* ------------------------------------------ *\n * Paths\n * ------------------------------------------ */\n\nexport interface Path {\n  id?: string\n  edges: string[]\n  // any properties\n  [x: string]: any\n}\n\nexport type Paths = Record<string, Path>\n\n// When specified in a list, the ID is not needed for a while to\n// keep compatibility.\n// TODO: After a while, remove `| Path[]`.\nexport type InputPaths = Record<string, Path> | Path[]\n\n// line: point | curve: [control-point, control-point, target-point] | \"arc\" | move to next point: null\nexport type PositionOrCurve = Position | Position[] | string | null\n\n/* ------------------------------------------ *\n * Events\n * ------------------------------------------ */\n\nexport type ViewEvent<T extends Event> = { event: T }\nexport type NodeEvent<T extends Event> = { node: string; event: T }\nexport type EdgeEvent<T extends Event> =\n  | { edge: string; edges: string[]; summarized: false; event: T }\n  | { edge?: undefined; edges: string[]; summarized: true; event: T }\nexport type PathEvent<T extends Event> = { path: string; event: T }\n\n// For compatibility with previous versions\nexport type NodePointerEvent = NodeEvent<PointerEvent>\nexport type EdgePointerEvent = EdgeEvent<PointerEvent>\n\nexport type Events = {\n  \"view:load\": undefined\n  \"view:unload\": undefined\n  \"view:mode\": ViewMode\n  \"view:zoom\": number\n  \"view:pan\": { x: number; y: number }\n  \"view:fit\": undefined\n  \"view:resize\": { x: number; y: number; width: number; height: number }\n  \"view:click\": ViewEvent<MouseEvent>\n  \"view:dblclick\": ViewEvent<MouseEvent>\n  \"view:contextmenu\": ViewEvent<MouseEvent>\n  \"node:click\": NodeEvent<MouseEvent>\n  \"node:dblclick\": NodeEvent<MouseEvent>\n  \"node:pointerover\": NodeEvent<PointerEvent>\n  \"node:pointerout\": NodeEvent<PointerEvent>\n  \"node:pointerup\": NodeEvent<PointerEvent>\n  \"node:pointerdown\": NodeEvent<PointerEvent>\n  \"node:contextmenu\": NodeEvent<MouseEvent>\n  \"node:dragstart\": { [name: string]: Position }\n  \"node:pointermove\": { [name: string]: Position }\n  \"node:dragend\": { [name: string]: Position }\n  \"node:select\": string[]\n  \"edge:pointerup\": EdgeEvent<PointerEvent>\n  \"edge:pointerdown\": EdgeEvent<PointerEvent>\n  \"edge:click\": EdgeEvent<MouseEvent>\n  \"edge:dblclick\": EdgeEvent<MouseEvent>\n  \"edge:pointerover\": EdgeEvent<PointerEvent>\n  \"edge:pointerout\": EdgeEvent<PointerEvent>\n  \"edge:contextmenu\": EdgeEvent<MouseEvent>\n  \"edge:select\": string[]\n  \"path:select\": string[]\n  \"path:pointerup\": PathEvent<PointerEvent>\n  \"path:pointerdown\": PathEvent<PointerEvent>\n  \"path:click\": PathEvent<MouseEvent>\n  \"path:dblclick\": PathEvent<MouseEvent>\n  \"path:pointerover\": PathEvent<PointerEvent>\n  \"path:pointerout\": PathEvent<PointerEvent>\n  \"path:contextmenu\": PathEvent<MouseEvent>\n}\n\nexport type EventHandlers = {\n  \"*\"?: <T extends keyof Events>(type: T, event: Events[T]) => void\n} & {\n  [K in keyof Events]?: (event: Events[K]) => void\n}\n\nexport type OnClickHandler = (param: NodeEvent<MouseEvent>) => void\nexport type OnDragHandler = (param: { [name: string]: Position }) => void\n\n/* ------------------------------------------ *\n * SVG area\n * ------------------------------------------ */\n\nexport interface Point {\n  x: number\n  y: number\n}\n\nexport interface ViewBox {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\nexport interface Sizes {\n  width: number\n  height: number\n  viewBox: ViewBox\n}\n","import { isReactive, reactive } from \"vue\"\n\n/* ------------------------------------------ *\n * Utility\n * ------------------------------------------ */\n\nexport type RecursivePartial<T> = {\n  [P in keyof T]?: T[P] extends (infer U)[]\n    ? RecursivePartial<U>[]\n    : T[P] extends (infer U)[] | undefined\n    ? RecursivePartial<U>[]\n    : // eslint-disable-next-line @typescript-eslint/ban-types\n    T[P] extends object\n    ? RecursivePartial<T[P]>\n    : // eslint-disable-next-line @typescript-eslint/ban-types\n    T[P] extends object | undefined\n    ? RecursivePartial<T[P]>\n    : T[P]\n}\n\ndeclare class Id<T extends string> {\n  private IDENTITY: T\n}\n\nexport type Reactive<T> = Id<\"Reactive\"> & T\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function Reactive<T extends object>(value: T): Reactive<T> {\n  if (isReactive(value)) {\n    return value as Reactive<T>\n  } else {\n    return reactive(value) as unknown as Reactive<T>\n  }\n}\n\nexport interface ReadonlyRef<T> {\n  readonly value: T\n}\n\nexport function nonNull<T>(val?: T | null, name = \"Parameter\"): T {\n  if (val === undefined || val === null) {\n    throw new Error(`${name} is null`)\n  }\n  return val\n}\n","import { provide, inject, InjectionKey, Ref } from \"vue\"\nimport { SvgPanZoomInstance } from \"@/modules/svg-pan-zoom-ex\"\nimport { nonNull } from \"@/common/common\"\n\ninterface ProvideContainers {\n  container: Ref<HTMLDivElement>\n  svg: Ref<SVGElement>\n  viewport: Ref<SVGGElement>\n  svgPanZoom: Ref<SvgPanZoomInstance | undefined>\n}\n\ninterface Containers {\n  container: Ref<HTMLDivElement | undefined>\n  svg: Ref<SVGElement | undefined>\n  viewport: Ref<SVGGElement | undefined>\n  svgPanZoom: Ref<SvgPanZoomInstance | undefined>\n}\n\nconst containersKey = Symbol(\"containers\") as InjectionKey<Containers>\n\nexport function provideContainers(containers: Containers): void {\n  provide(containersKey, containers)\n}\n\nexport function useContainers(): ProvideContainers {\n  const containers = nonNull(inject(containersKey), \"containers\")\n  return {\n    container: containers.container as Ref<HTMLDivElement>,\n    svg: containers.svg as Ref<SVGElement>,\n    viewport: containers.viewport as Ref<SVGGElement>,\n    svgPanZoom: containers.svgPanZoom\n  }\n}\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import toNumber from './toNumber.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nexport default toFinite;\n","import toFinite from './toFinite.js';\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nexport default toInteger;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import isObject from './isObject.js';\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nexport default baseCreate;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nexport default copyArray;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n","import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import eq from './eq.js';\nimport isArrayLike from './isArrayLike.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nexport default isIterateeCall;\n","import baseRest from './_baseRest.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nexport default createAssigner;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n","import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","/**\n * The base implementation of `_.slice` without an iteratee call guard.\n *\n * @private\n * @param {Array} array The array to slice.\n * @param {number} [start=0] The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the slice of `array`.\n */\nfunction baseSlice(array, start, end) {\n  var index = -1,\n      length = array.length;\n\n  if (start < 0) {\n    start = -start > length ? 0 : (length + start);\n  }\n  end = end > length ? length : end;\n  if (end < 0) {\n    end += length;\n  }\n  length = start > end ? 0 : ((end - start) >>> 0);\n  start >>>= 0;\n\n  var result = Array(length);\n  while (++index < length) {\n    result[index] = array[index + start];\n  }\n  return result;\n}\n\nexport default baseSlice;\n","import root from './_root.js';\nimport toInteger from './toInteger.js';\nimport toNumber from './toNumber.js';\nimport toString from './toString.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite,\n    nativeMin = Math.min;\n\n/**\n * Creates a function like `_.round`.\n *\n * @private\n * @param {string} methodName The name of the `Math` method to use when rounding.\n * @returns {Function} Returns the new round function.\n */\nfunction createRound(methodName) {\n  var func = Math[methodName];\n  return function(number, precision) {\n    number = toNumber(number);\n    precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n    if (precision && nativeIsFinite(number)) {\n      // Shift with exponential notation to avoid floating-point issues.\n      // See [MDN](https://mdn.io/round#Examples) for more details.\n      var pair = (toString(number) + 'e').split('e'),\n          value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n      pair = (toString(value) + 'e').split('e');\n      return +(pair[0] + 'e' + (+pair[1] - precision));\n    }\n    return func(number);\n  };\n}\n\nexport default createRound;\n","import baseSlice from './_baseSlice.js';\nimport isIterateeCall from './_isIterateeCall.js';\nimport toInteger from './toInteger.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeCeil = Math.ceil,\n    nativeMax = Math.max;\n\n/**\n * Creates an array of elements split into groups the length of `size`.\n * If `array` can't be split evenly, the final chunk will be the remaining\n * elements.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Array\n * @param {Array} array The array to process.\n * @param {number} [size=1] The length of each chunk\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Array} Returns the new array of chunks.\n * @example\n *\n * _.chunk(['a', 'b', 'c', 'd'], 2);\n * // => [['a', 'b'], ['c', 'd']]\n *\n * _.chunk(['a', 'b', 'c', 'd'], 3);\n * // => [['a', 'b', 'c'], ['d']]\n */\nfunction chunk(array, size, guard) {\n  if ((guard ? isIterateeCall(array, size, guard) : size === undefined)) {\n    size = 1;\n  } else {\n    size = nativeMax(toInteger(size), 0);\n  }\n  var length = array == null ? 0 : array.length;\n  if (!length || size < 1) {\n    return [];\n  }\n  var index = 0,\n      resIndex = 0,\n      result = Array(nativeCeil(length / size));\n\n  while (index < length) {\n    result[resIndex++] = baseSlice(array, index, (index += size));\n  }\n  return result;\n}\n\nexport default chunk;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n","import baseCreate from './_baseCreate.js';\nimport getPrototype from './_getPrototype.js';\nimport isPrototype from './_isPrototype.js';\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nexport default initCloneObject;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nexport default createBaseFor;\n","import createBaseFor from './_createBaseFor.js';\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nexport default baseFor;\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignMergeValue;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nexport default safeGet;\n","import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nexport default toPlainObject;\n","import assignMergeValue from './_assignMergeValue.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\nimport copyArray from './_copyArray.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\nimport isBuffer from './isBuffer.js';\nimport isFunction from './isFunction.js';\nimport isObject from './isObject.js';\nimport isPlainObject from './isPlainObject.js';\nimport isTypedArray from './isTypedArray.js';\nimport safeGet from './_safeGet.js';\nimport toPlainObject from './toPlainObject.js';\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nexport default baseMergeDeep;\n","import Stack from './_Stack.js';\nimport assignMergeValue from './_assignMergeValue.js';\nimport baseFor from './_baseFor.js';\nimport baseMergeDeep from './_baseMergeDeep.js';\nimport isObject from './isObject.js';\nimport keysIn from './keysIn.js';\nimport safeGet from './_safeGet.js';\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nexport default baseMerge;\n","import baseMerge from './_baseMerge.js';\nimport createAssigner from './_createAssigner.js';\n\n/**\n * This method is like `_.merge` except that it accepts `customizer` which\n * is invoked to produce the merged values of the destination and source\n * properties. If `customizer` returns `undefined`, merging is handled by the\n * method instead. The `customizer` is invoked with six arguments:\n * (objValue, srcValue, key, object, source, stack).\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} sources The source objects.\n * @param {Function} customizer The function to customize assigned values.\n * @returns {Object} Returns `object`.\n * @example\n *\n * function customizer(objValue, srcValue) {\n *   if (_.isArray(objValue)) {\n *     return objValue.concat(srcValue);\n *   }\n * }\n *\n * var object = { 'a': [1], 'b': [2] };\n * var other = { 'a': [3], 'b': [4] };\n *\n * _.mergeWith(object, other, customizer);\n * // => { 'a': [1, 3], 'b': [2, 4] }\n */\nvar mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n  baseMerge(object, source, srcIndex, customizer);\n});\n\nexport default mergeWith;\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","import baseMerge from './_baseMerge.js';\nimport createAssigner from './_createAssigner.js';\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nexport default merge;\n","import createRound from './_createRound.js';\n\n/**\n * Computes `number` rounded to `precision`.\n *\n * @static\n * @memberOf _\n * @since 3.10.0\n * @category Math\n * @param {number} number The number to round.\n * @param {number} [precision=0] The precision to round to.\n * @returns {number} Returns the rounded number.\n * @example\n *\n * _.round(4.006);\n * // => 4\n *\n * _.round(4.006, 2);\n * // => 4.01\n *\n * _.round(4060, -2);\n * // => 4100\n */\nvar round = createRound('round');\n\nexport default round;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport cacheHas from './_cacheHas.js';\nimport createSet from './_createSet.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseUniq;\n","import baseUniq from './_baseUniq.js';\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nexport default uniq;\n","import { SvgPanZoomInstance } from \"@/modules/svg-pan-zoom-ex\"\nimport { LayoutHandler } from \"../layouts/handler\"\nimport { RecursivePartial } from \"./common\"\nimport { Edge, Edges, LayerName, Node, Path, Position } from \"./types\"\n\ntype CallableValue<V, T> = V | ((target: T) => V)\n\ntype CallableValues<V, T> = {\n  [K in keyof V]: CallableValue<V[K], T>\n}\n\nexport class Config {\n  static value<V, T>(value: CallableValue<V, T>, target: T): V {\n    return value instanceof Function ? value(target) : value\n  }\n\n  static values<V, T>(value: CallableValues<V, T>, target: T): V {\n    if (Object.values(value).filter(v => v instanceof Function).length === 0) {\n      return value as V // all config are literals\n    }\n    return Object.fromEntries(\n      Object.entries(value).map(([k, v]) => [k, v instanceof Function ? v(target) : v])\n    ) as V\n  }\n}\n\n/* View configuration */\n\nexport interface GridLine {\n  color: string\n  width: number\n  dasharray?: string | number\n}\n\nexport interface GridConfig {\n  visible: boolean\n  interval: number\n  thickIncrements: number | false\n  line: GridLine\n  thick: GridLine\n}\n\nexport interface BasicShapeStyle {\n  strokeWidth: number\n  strokeColor?: string\n  strokeDasharray?: string | number\n  color: string\n}\n\ntype Percent = `${number}%`;\ntype Pixel = `${number}px`;\ntype NumericString = `${number}`\nexport type MarginValue = Percent | Pixel | NumericString | number\nexport type FitContentMargin = MarginValue | {\n  top?: MarginValue\n  left?: MarginValue\n  right?: MarginValue\n  bottom?: MarginValue\n}\n\nexport interface ViewConfig {\n  scalingObjects: boolean\n  panEnabled: boolean\n  zoomEnabled: boolean\n  minZoomLevel: number\n  maxZoomLevel: number\n  doubleClickZoomEnabled: boolean\n  mouseWheelZoomEnabled: boolean\n  boxSelectionEnabled: boolean\n  fit?: boolean // Deprecated\n  autoPanAndZoomOnLoad: false | \"center-zero\" | \"center-content\" | \"fit-content\"\n  fitContentMargin: FitContentMargin\n  autoPanOnResize: boolean\n  layoutHandler: LayoutHandler\n  onSvgPanZoomInitialized?: (instance: SvgPanZoomInstance) => void\n  grid: GridConfig\n  selection: {\n    box: BasicShapeStyle\n    detector: (event: KeyboardEvent) => boolean\n  }\n  builtInLayerOrder: Readonly<LayerName[]>\n  onBeforeInitialDisplay?: (() => Promise<any>) | (() => any)\n}\n\n/* Shape style */\n\nexport type ShapeStyleBase = BasicShapeStyle\n\nexport type ShapeType = \"circle\" | \"rect\"\n\ninterface CircleShape extends ShapeStyleBase {\n  radius: number\n}\n\ninterface RectangleShape extends ShapeStyleBase {\n  width: number\n  height: number\n  borderRadius: number\n}\n\n// `Shape` is an object whose fields can change depending on\n// the type value.\n// Normally, Union Types would be used, but in order to minimize\n// the use of type guards when users build and use the configuration,\n// we define it as an object that contains all fields.\n\ntype ShapeBase<T extends ShapeType = ShapeType> = {\n  type: T\n}\n\nexport type ShapeStyle = ShapeBase & CircleShape & RectangleShape\nexport type CircleShapeStyle = ShapeBase<\"circle\"> & CircleShape\nexport type RectangleShapeStyle = ShapeBase<\"rect\"> & RectangleShape\nexport type AnyShapeStyle = CircleShapeStyle | RectangleShapeStyle\n\n/* Label style */\n\ninterface Padding {\n  vertical: number\n  horizontal: number\n}\nexport interface LabelBackgroundStyle {\n  visible: boolean\n  color?: string\n  padding?: number | Padding\n  borderRadius?: number\n}\n\nexport interface LabelStyle {\n  fontFamily?: string\n  fontSize: number\n  color: string\n  background?: LabelBackgroundStyle\n  lineHeight: number\n}\n\n/* Z-Order config */\n\nexport interface ZOrderConfig<T> {\n  enabled: boolean\n  zIndex: CallableValue<number, T>\n  bringToFrontOnHover: boolean\n  bringToFrontOnSelected: boolean\n}\n\n/* Object common config */\n\nexport interface ObjectConfigs<O> {\n  selectable: CallableValue<boolean, O> | number\n  zOrder: ZOrderConfig<O>\n}\n\n/* Node style */\n\nexport enum NodeLabelDirection {\n  CENTER = \"center\",\n  NORTH = \"north\",\n  NORTH_EAST = \"north-east\",\n  EAST = \"east\",\n  SOUTH_EAST = \"south-east\",\n  SOUTH = \"south\",\n  SOUTH_WEST = \"south-west\",\n  WEST = \"west\",\n  NORTH_WEST = \"north-west\",\n}\n\nexport type NodeLabelDirectionType =\n  | \"center\"\n  | \"north\"\n  | \"north-east\"\n  | \"east\"\n  | \"south-east\"\n  | \"south\"\n  | \"south-west\"\n  | \"west\"\n  | \"north-west\"\n\nexport interface OppositeNode {\n  nodeId: string\n  pos: Position\n}\n\n// { edgeId: { nodeId, pos } }\nexport type OppositeNodes = Record<string, OppositeNode>\n\nexport interface NodeLabelDirectionHandlerParams {\n  nodeId: string\n  pos: Position\n  oppositeNodes: OppositeNodes\n}\n\nexport type NodeLabelDirectionAutoAdjustmentHandler = (\n  params: NodeLabelDirectionHandlerParams\n) => NodeLabelDirectionType | null\n\nexport interface NodeLabelStyle extends LabelStyle {\n  visible: boolean\n  margin: number\n  direction: NodeLabelDirectionType\n  directionAutoAdjustment: boolean | NodeLabelDirectionAutoAdjustmentHandler\n  text: string\n  handleNodeEvents: boolean\n}\n\nexport interface NodeFocusRingStyle {\n  visible: boolean\n  width: number\n  padding: number\n  color: string\n  dasharray?: string | number\n}\n\nexport interface NodeConfig<N extends Node = Node> {\n  normal: CallableValues<ShapeStyle, N>\n  hover?: CallableValues<ShapeStyle, N>\n  selected?: CallableValues<ShapeStyle, N>\n  draggable: CallableValue<boolean, N>\n  selectable: CallableValue<boolean, N> | number\n  label: CallableValues<NodeLabelStyle, N>\n  focusring: NodeFocusRingStyle\n  zOrder: ZOrderConfig<N>\n  transition?: string\n}\n\n/* Edge style */\n\nexport interface StrokeStyle {\n  width: number\n  color: string\n  dasharray?: string | number\n  linecap?: \"butt\" | \"round\" | \"square\"\n  animate: boolean\n  animationSpeed: number\n}\n\nexport interface EdgeLabelStyle extends LabelStyle {\n  margin: number\n  padding: number\n}\n\nexport type EdgeHeadType = \"none\" | \"arrow\" | \"angle\" | \"circle\" | \"custom\"\nexport type MarkerUnits = \"strokeWidth\" | \"userSpaceOnUse\"\n\nexport interface MarkerStyle {\n  type: EdgeHeadType\n  width: number\n  height: number\n  margin: number\n  offset: number\n  units: MarkerUnits\n  color: string | null\n  customId?: string\n}\n\nexport type EdgeType = \"straight\" | \"curve\"\n\n// Orientation to be considered when keeping multiple edge alignments.\n//   \"clock\": Keep the forward/backward when viewed as a clock.\n//   \"vertical\": Keep the vertical alignment.\n//   \"horizontal\": Keep the horizontal alignment.\nexport type EdgeKeepOrderType = \"clock\" | \"vertical\" | \"horizontal\"\n\nexport interface SelfLoopEdgeStyle {\n  radius: number\n  offset: number\n  angle: number\n  isClockwise: boolean\n}\n\nexport interface EdgeConfig<E extends Edge = Edge> {\n  normal: CallableValues<StrokeStyle, E>\n  hover?: CallableValues<StrokeStyle, E>\n  selected: CallableValues<StrokeStyle, E>\n  selectable: CallableValue<boolean, E> | number\n  gap: number | ((edges: Edges, configs: Configs) => number)\n  type: EdgeType\n  marker: {\n    source: CallableValues<MarkerStyle, [E, StrokeStyle]>\n    target: CallableValues<MarkerStyle, [E, StrokeStyle]>\n  }\n  margin: number | null\n  summarize: boolean | ((edges: Edges, configs: Configs) => boolean | null)\n  summarized: {\n    label: CallableValues<LabelStyle, Record<string, E>>\n    shape: CallableValues<ShapeStyle, Record<string, E>>\n    stroke: CallableValues<StrokeStyle, Record<string, E>>\n  }\n  selfLoop: CallableValues<SelfLoopEdgeStyle, E>\n  keepOrder: EdgeKeepOrderType\n  label: CallableValues<EdgeLabelStyle, E>\n  zOrder: ZOrderConfig<E>\n}\n\n/* Path config */\nexport interface PathStrokeStyle extends StrokeStyle {\n  linejoin: \"miter\" | \"round\" | \"bevel\"\n}\n\nexport type PathEndType = \"centerOfNode\" | \"edgeOfNode\"\n\nexport interface PathConfig<P extends Path = Path> {\n  visible: boolean\n  clickable: CallableValue<boolean, P>\n  hoverable: CallableValue<boolean, P>\n  curveInNode: boolean\n  end: PathEndType\n  margin: CallableValue<number, P>\n\n  // @Deprecated\n  path: CallableValues<PathStrokeStyle, P>\n\n  normal: CallableValues<PathStrokeStyle, P>\n  hover?: CallableValues<PathStrokeStyle, P>\n  selected: CallableValues<PathStrokeStyle, P>\n\n  selectable: CallableValue<boolean, P> | number\n  zOrder: ZOrderConfig<P>\n  transition?: string\n}\n\n/* Configuration */\n\nexport interface Configs<N extends Node = Node, E extends Edge = Edge, P extends Path = Path> {\n  view: ViewConfig\n  node: NodeConfig<N>\n  edge: EdgeConfig<E>\n  path: PathConfig<P>\n}\n\n/** For specification by the user */\nexport type UserConfigs<\n  N extends Node = Node,\n  E extends Edge = Edge,\n  P extends Path = Path\n> = RecursivePartial<Configs<N, E, P>>\n\n/** Make a config with self object */\nexport function withSelf<T extends { [name: string]: any }>(callback: (self: T) => T): T {\n  const self = {} as T\n  return Object.assign(self, callback(self))\n}\n\n/** @deprecated */\nexport function configsWithType<\n  N extends Node = Node,\n  E extends Edge = Edge,\n  P extends Path = Path,\n  U extends UserConfigs<N, E, P> = UserConfigs<N, E, P>\n>(configs: U): U & UserConfigs<N, E, P> {\n  return configs\n}\n\n/** Define configurations */\nexport function defineConfigs<\n  N extends Node = Node,\n  E extends Edge = Edge,\n  P extends Path = Path,\n  U extends UserConfigs<N, E, P> = UserConfigs<N, E, P>\n>(configs: U): U & UserConfigs<N, E, P> {\n  return configs\n}\n","import { Node, Position, Size } from \"@/common/types\"\nimport { Config, NodeConfig, StrokeStyle } from \"@/common/configs\"\n\nexport function getNodeSize(node: Node, style: NodeConfig, scale: number): Size {\n  const shape = Config.values(style.normal, node)\n  if (shape.type == \"circle\") {\n    return {\n      width: shape.radius * 2 * scale,\n      height: shape.radius * 2 * scale,\n    }\n  } else {\n    return {\n      width: shape.width * scale,\n      height: shape.height * scale,\n    }\n  }\n}\n\nexport function areNodesCollision(\n  nodePos: Position,\n  nodeSize: Size,\n  targetNodePos: Position,\n  targetNodeSize: Size\n): boolean {\n  // x方向の衝突チェック\n  const distanceX = Math.abs(nodePos.x - targetNodePos.x)\n  const collisionX = distanceX < nodeSize.width / 2 + targetNodeSize.width / 2\n\n  // y方向の衝突チェック\n  const distanceY = Math.abs(nodePos.y - targetNodePos.y)\n  const collisionY = distanceY < nodeSize.height / 2 + targetNodeSize.height / 2\n  return collisionX && collisionY\n}\n\nexport function applyScaleToDasharray(dasharray: number | string | undefined, scale: number) {\n  let result: number | string = 0\n  if (scale === 1 || dasharray === undefined || dasharray === \"none\") {\n    result = dasharray ?? 0\n  } else if (typeof dasharray === \"string\") {\n    result = dasharray\n      .split(/\\s+/)\n      .map(v => parseInt(v) * scale)\n      .filter(v => !isNaN(v))\n      .join(\" \")\n  } else {\n    result = dasharray * scale\n  }\n  return result && result !== \"0\" ? result : undefined\n}\n\nexport function getDasharrayUnit(dasharray: number | string | undefined) {\n  let result: number | string = 0\n  if (dasharray === undefined || dasharray === \"none\") {\n    result = 0\n  } else if (typeof dasharray === \"string\") {\n    const array = dasharray\n      .split(/\\s+/)\n      .map(v => parseInt(v))\n      .filter(v => !isNaN(v))\n    if (array.length % 2 === 0) {\n      // ex: 1 2 -> -  -  -  - ...\n      result = array.reduce((s, n) => s + n, 0)\n    } else {\n      // ex: 1 2 3 -> -  --- --   -  --- ...\n      result = array.reduce((s, n) => s + n, 0) * 2\n    }\n  } else {\n    result = dasharray * 2 // 2 <- border and space\n  }\n  return result\n}\n\nexport function getAnimationSpeed(key: string, config: StrokeStyle, scale: number): Record<string, number|undefined> {\n  const speed = config.animate\n    ? getDasharrayUnit(config.dasharray) * config.animationSpeed * scale\n    : undefined\n  return {[key]: speed}\n}\n","import { Ref, toRef, watch } from \"vue\"\nimport { isEqual, round } from \"lodash-es\"\nimport { NodePositions, OnDragHandler, Position } from \"@/common/types\"\nimport { getNodeSize, areNodesCollision } from \"@/utils/visual\"\nimport { LayoutActivateParameters, LayoutHandler } from \"./handler\"\n\nconst NEW_NODE_POSITION_MARGIN = 20\n\nexport class SimpleLayout implements LayoutHandler {\n  private onDeactivate?: () => void\n\n  activate(parameters: LayoutActivateParameters): void {\n    const { nodePositions, nodes, configs, emitter, scale, svgPanZoom } = parameters\n    const onDrag: OnDragHandler = positions => {\n      for (const [id, pos] of Object.entries(positions)) {\n        const layout = this.getOrCreateNodePosition(nodePositions, id)\n        this.setNodePosition(layout, pos)\n      }\n    }\n\n    const setNewNodePositions = (nodeIds: string[]) => {\n      // decide new node's position\n      const newNodes = nodeIds.filter(n => !(n in nodePositions.value))\n      const area = svgPanZoom.getViewArea()\n      const s = scale.value\n      for (const nodeId of newNodes) {\n        const node = nodes.value[nodeId]\n        const nodeSize = getNodeSize(node, configs.node, s)\n        const candidate = { ...area.center }\n        for (;;) {\n          let collision = false\n          for (const [id, pos] of Object.entries(nodePositions.value)) {\n            if (nodeId === id) continue\n            const targetNode = nodes.value[id]\n            if (!targetNode) continue\n            const targetNodeSize = getNodeSize(targetNode, configs.node, s)\n            collision = areNodesCollision(candidate, nodeSize, pos, targetNodeSize)\n            if (collision) {\n              break\n            }\n          }\n          if (collision) {\n            // Slide the width of one node + margin in the horizontal direction.\n            // If it reaches the edge of the display area, it moves downward.\n            candidate.x += nodeSize.width + NEW_NODE_POSITION_MARGIN * s\n            if (candidate.x + nodeSize.width / 2 > area.box.right) {\n              candidate.x = area.center.x\n              candidate.y += nodeSize.height + NEW_NODE_POSITION_MARGIN * s\n            }\n          } else {\n            break\n          }\n        }\n        const layout = this.getOrCreateNodePosition(nodePositions, nodeId)\n        this.setNodePosition(layout, candidate)\n      }\n    }\n\n    setNewNodePositions(Object.keys(nodes.value))\n    const stopNodeWatch = watch(\n      () => isEqual(new Set(Object.keys(nodes.value)), new Set(Object.keys(nodePositions.value))),\n      (equality: boolean) => {\n        if (!equality) setNewNodePositions(Object.keys(nodes.value))\n      }\n    )\n\n    emitter.on(\"node:dragstart\", onDrag)\n    emitter.on(\"node:pointermove\", onDrag)\n    emitter.on(\"node:dragend\", onDrag)\n\n    this.onDeactivate = () => {\n      stopNodeWatch()\n      emitter.off(\"node:dragstart\", onDrag)\n      emitter.off(\"node:pointermove\", onDrag)\n      emitter.off(\"node:dragend\", onDrag)\n    }\n  }\n\n  deactivate(): void {\n    if (this.onDeactivate) {\n      this.onDeactivate()\n    }\n  }\n\n  protected setNodePosition(nodeLayout: Ref<Position>, pos: Position) {\n    nodeLayout.value.x = round(pos.x, 3)\n    nodeLayout.value.y = round(pos.y, 3)\n  }\n\n  private getOrCreateNodePosition(nodePositions: Ref<NodePositions>, node: string) {\n    const layout = toRef(nodePositions.value, node)\n    if (!layout.value) {\n      layout.value = { x: 0, y: 0 }\n    }\n    return layout\n  }\n}\n","import { merge } from \"lodash-es\"\nimport { reactive } from \"vue\"\nimport { SimpleLayout } from \"../layouts/simple\"\nimport { Config, Configs, NodeLabelDirection, UserConfigs, withSelf } from \"./configs\"\nimport { Edge, Edges, Node, Path } from \"./types\"\n\n/**\n * Get all default configs.\n * @returns configs\n */\nexport function getConfigDefaults(): Configs {\n  return {\n    view: {\n      scalingObjects: false,\n      panEnabled: true,\n      zoomEnabled: true,\n      minZoomLevel: 0.1,\n      maxZoomLevel: 64,\n      doubleClickZoomEnabled: true,\n      mouseWheelZoomEnabled: true,\n      boxSelectionEnabled: false,\n      autoPanAndZoomOnLoad: \"center-content\",\n      fitContentMargin: \"8%\",\n      autoPanOnResize: true,\n      layoutHandler: new SimpleLayout(),\n      onSvgPanZoomInitialized: undefined,\n      grid: {\n        visible: false,\n        interval: 10,\n        thickIncrements: 5,\n        line: {\n          color: \"#e0e0e0\",\n          width: 1,\n          dasharray: 1,\n        },\n        thick: {\n          color: \"#cccccc\",\n          width: 1,\n          dasharray: 0,\n        },\n      },\n      selection: {\n        box: {\n          color: \"#0000ff20\",\n          strokeWidth: 1,\n          strokeColor: \"#aaaaff\",\n          strokeDasharray: 0,\n        },\n        detector: (event: KeyboardEvent) => {\n          const detect = /Mac OS/.test(navigator.userAgent) ? event.metaKey : event.ctrlKey\n          return event.type === \"keydown\" ? detect : !detect\n        },\n      },\n      builtInLayerOrder: [],\n      onBeforeInitialDisplay: undefined,\n    },\n    node: withSelf(self => ({\n      normal: {\n        type: \"circle\",\n        radius: 16,\n        // for rect -->\n        width: 32,\n        height: 32,\n        borderRadius: 4,\n        // <-- for rect\n        color: \"#4466cc\",\n        strokeWidth: 0,\n        strokeColor: \"#000000\",\n        strokeDasharray: 0,\n      },\n      hover: {\n        type: node => Config.value(self.normal.type, node) as any,\n        radius: node => (Config.value(self.normal.radius, node) ?? 0) + 2,\n        width: node => (Config.value(self.normal.width, node) ?? 0) + 2,\n        height: node => (Config.value(self.normal.height, node) ?? 0) + 2,\n        borderRadius: node => Config.value(self.normal.borderRadius, node) ?? 0,\n        strokeWidth: node => Config.value(self.normal.strokeWidth, node),\n        strokeColor: node => Config.value(self.normal.strokeColor, node),\n        strokeDasharray: node => Config.value(self.normal.strokeDasharray, node),\n        color: \"#3355bb\",\n      },\n      selected: undefined,\n      draggable: true,\n      selectable: false,\n      label: {\n        visible: true,\n        fontFamily: undefined,\n        fontSize: 11,\n        lineHeight: 1.1,\n        color: \"#000000\",\n        background: undefined,\n        // background: {\n        //   visible: true,\n        //   color: \"#ffffff\",\n        //   padding: {\n        //     vertical: 1,\n        //     horizontal: 4,\n        //   },\n        //   borderRadius: 2\n        // },\n        margin: 4,\n        direction: NodeLabelDirection.SOUTH,\n        directionAutoAdjustment: false,\n        text: \"name\",\n        handleNodeEvents: true,\n      },\n      focusring: {\n        visible: true,\n        width: 4,\n        padding: 3,\n        color: \"#eebb00\",\n      },\n      zOrder: {\n        enabled: false,\n        zIndex: 0,\n        bringToFrontOnHover: true,\n        bringToFrontOnSelected: true,\n      },\n      transition: undefined,\n    })),\n    edge: withSelf(self => ({\n      normal: {\n        width: 2,\n        color: \"#4466cc\",\n        dasharray: 0,\n        linecap: \"butt\",\n        animate: false,\n        animationSpeed: 50,\n      },\n      hover: {\n        width: edge => Config.value(self.normal.width, edge) + 1,\n        color: \"#3355bb\",\n        dasharray: edge => Config.value(self.normal.dasharray, edge),\n        linecap: edge => Config.value(self.normal.linecap, edge),\n        animate: edge => Config.value(self.normal.animate, edge),\n        animationSpeed: edge => Config.value(self.normal.animationSpeed, edge),\n      },\n      selected: {\n        width: edge => Config.value(self.normal.width, edge) + 1,\n        color: \"#dd8800\",\n        dasharray: edge => {\n          const w = Config.value(self.normal.width, edge)\n          return `${w * 1.5} ${w * 2}`\n        },\n        linecap: edge => Config.value(self.normal.linecap, edge),\n        animate: edge => Config.value(self.normal.animate, edge),\n        animationSpeed: edge => Config.value(self.normal.animationSpeed, edge),\n      },\n      selectable: false,\n      gap: 3,\n      type: \"straight\",\n      marker: {\n        source: {\n          type: \"none\",\n          width: 5,\n          height: 5,\n          margin: -1,\n          offset: 0,\n          units: \"strokeWidth\",\n          color: null,\n        },\n        target: {\n          type: \"none\",\n          width: 5,\n          height: 5,\n          margin: -1,\n          offset: 0,\n          units: \"strokeWidth\",\n          color: null,\n        },\n      },\n      margin: null,\n      summarize: (_edges: Edges, configs: Configs) => {\n        return configs.edge.type == \"curve\" ? false : null\n      },\n      summarized: {\n        label: {\n          fontSize: 10,\n          lineHeight: 1,\n          color: \"#4466cc\",\n        },\n        shape: {\n          type: \"rect\",\n          // for circle -->\n          radius: 6,\n          // <-- for circle\n          width: 12,\n          height: 12,\n          borderRadius: 3,\n          color: \"#ffffff\",\n          strokeWidth: 1,\n          strokeColor: \"#4466cc\",\n          strokeDasharray: undefined,\n        },\n        stroke: {\n          width: 5,\n          color: \"#4466cc\",\n          dasharray: undefined,\n          linecap: undefined,\n          animate: false,\n          animationSpeed: 50,\n        },\n      },\n      selfLoop: {\n        radius: 12,\n        isClockwise: true,\n        offset: 10,\n        angle: 270,\n      },\n      keepOrder: \"clock\",\n      label: {\n        fontFamily: undefined,\n        fontSize: 11,\n        lineHeight: 1.1,\n        color: \"#000000\",\n        background: undefined,\n        // background: {\n        //   visible: true,\n        //   color: \"#ffffff\",\n        //   padding: {\n        //     vertical: 1,\n        //     horizontal: 4,\n        //   },\n        //   borderRadius: 2\n        // },\n        margin: 4,\n        padding: 4,\n      },\n      zOrder: {\n        enabled: false,\n        zIndex: 0,\n        bringToFrontOnHover: true,\n        bringToFrontOnSelected: true,\n      },\n    })),\n    path: withSelf(self => ({\n      visible: false,\n      clickable: false,\n      hoverable: false,\n      curveInNode: false,\n      end: \"centerOfNode\",\n      margin: 0,\n      // @Deprecated\n      path: reactive({\n        width: 6,\n        color: p => {\n          const list = [\n            \"#d5000088\",\n            \"#c5116288\",\n            \"#aa00ff88\",\n            \"#6200ea88\",\n            \"#304ffe88\",\n            \"#2962ff88\",\n            \"#0091ea88\",\n            \"#00b8d488\",\n            \"#00bfa588\",\n            \"#00c85388\",\n            \"#64dd1788\",\n            \"#aeea0088\",\n            \"#ffd60088\",\n            \"#ffab0088\",\n            \"#ff6d0088\",\n            \"#dd2c0088\",\n          ]\n          const hash = p.edges\n            .map(s =>\n              s.split(\"\").reduce((a, b) => {\n                a = (a << 5) - a + b.charCodeAt(0)\n                return a & a\n              }, 0)\n            )\n            .reduce((a, b) => a + b, 0)\n          return list[Math.abs(hash) % list.length]\n        },\n        dasharray: undefined,\n        linecap: \"round\",\n        linejoin: \"round\",\n        animate: false,\n        animationSpeed: 50,\n      }),\n      normal: {\n        width: path => Config.value(self.path.width, path),\n        color: path => Config.value(self.path.color, path),\n        dasharray: path => Config.value(self.path.dasharray, path),\n        linecap: path => Config.value(self.path.linecap, path),\n        linejoin: path => Config.value(self.path.linejoin, path),\n        animate: path => Config.value(self.path.animate, path),\n        animationSpeed: path => Config.value(self.path.animationSpeed, path),\n      },\n      hover: {\n        width: path => Config.value(self.normal.width, path) + 2,\n        color: path => Config.value(self.normal.color, path),\n        dasharray: path => Config.value(self.normal.dasharray, path),\n        linecap: path => Config.value(self.normal.linecap, path),\n        linejoin: path => Config.value(self.normal.linejoin, path),\n        animate: path => Config.value(self.normal.animate, path),\n        animationSpeed: path => Config.value(self.normal.animationSpeed, path),\n      },\n      selected: {\n        width: path => Config.value(self.normal.width, path) + 2,\n        color: path => Config.value(self.normal.color, path),\n        dasharray: \"6 12\",\n        linecap: path => Config.value(self.normal.linecap, path),\n        linejoin: path => Config.value(self.normal.linejoin, path),\n        animate: path => Config.value(self.normal.animate, path),\n        animationSpeed: path => Config.value(self.normal.animationSpeed, path),\n      },\n      selectable: false,\n      zOrder: {\n        enabled: false,\n        zIndex: 0,\n        bringToFrontOnHover: true,\n        bringToFrontOnSelected: true,\n      },\n      transition: undefined,\n    })),\n  }\n}\n\nexport function getFullConfigs<N extends Node = Node, E extends Edge = Edge, P extends Path = Path>(\n  config?: UserConfigs<N, E, P>\n): Configs {\n  const configs = getConfigDefaults()\n  if (config) {\n    merge(configs, config)\n  }\n  return configs\n}\n","import { inject, InjectionKey, provide, reactive, Ref, watch } from \"vue\"\nimport { isPlainObject, merge, mergeWith } from \"lodash-es\"\nimport { nonNull } from \"@/common/common\"\nimport { Configs, UserConfigs } from \"@/common/configs\"\nimport { getConfigDefaults } from \"@/common/config-defaults\"\n\nconst injectionKey = Symbol(\"style\") as InjectionKey<Configs>\n\nfunction merger(destination: any, source: any) {\n  if (isPlainObject(destination)) {\n    return merge(destination, source)\n  } else {\n    return source // overwrite\n  }\n}\n\nexport function provideConfigs(configs: Ref<UserConfigs>) {\n  const results: Configs = reactive(getConfigDefaults())\n  const styleKeys = Object.keys(results) as (keyof Configs)[]\n  for (const key of styleKeys) {\n    watch(() => configs.value[key], () => {\n      mergeWith(results[key], configs.value[key] || {}, merger)\n    }, { immediate: true, deep: true })\n  }\n\n  provide(injectionKey, results)\n  return results\n}\n\nfunction injectConfig<T extends keyof Configs>(key: T) {\n  return nonNull(inject(injectionKey), `Configs(${key})`)[key]\n}\n\nexport function useAllConfigs() {\n  return nonNull(inject(injectionKey))\n}\n\nexport function useViewConfig() {\n  return injectConfig(\"view\")\n}\n\nexport function useNodeConfig() {\n  return injectConfig(\"node\")\n}\n\nexport function useEdgeConfig() {\n  return injectConfig(\"edge\")\n}\n\nexport function usePathConfig() {\n  return injectConfig(\"path\")\n}\n","let nextId = 1\n\n/** Generate unique ID in v-network-graph instances */\nexport function useId(): number {\n  return nextId++\n}\n","import { isEqual } from \"lodash-es\"\n\nexport function keyOf<T extends object>(obj: T): (keyof T)[] {\n  return Object.keys(obj) as Array<keyof T>\n}\n\nexport function entriesOf<T extends object, K extends keyof T>(obj: T): [K, T[K]][] {\n  return Object.entries(obj) as [K, T[K]][]\n}\n\nexport function updateObjectDiff<T extends Record<string, any>>(target: T, from: T) {\n  const keys = new Set<keyof T>(Object.keys(target))\n  entriesOf(from).forEach(([key, value]) => {\n    if (!isEqual(target[key], value)) {\n      target[key] = value\n    }\n    keys.delete(key)\n  })\n  keys.forEach(k => delete target[k])\n}\n\nexport function isPromise(obj: any): boolean {\n  return obj instanceof Promise || (obj && typeof obj.then === 'function')\n}\n","import { Ref, watchEffect } from \"vue\"\nimport { Reactive } from \"@/common/common\"\nimport { Edge, Edges, LinePosition, Nodes, Position } from \"@/common/types\"\nimport { Config, Configs, EdgeKeepOrderType } from \"@/common/configs\"\nimport { EdgeGroup, EdgeGroupStates, EdgeLayoutPoint } from \"@/models/edge\"\nimport { updateObjectDiff } from \"@/utils/object\"\n\n// -----------------------------------------------------------------------\n// Type definition\n// -----------------------------------------------------------------------\n\n// -----------------------------------------------------------------------\n// Exported functions\n// -----------------------------------------------------------------------\n\n/**\n * Make the states for edge group.\n * @param nodes nodes\n * @param edges edges\n * @param configs configs\n * @returns the states object for edge group\n */\nexport function makeEdgeGroupStates(\n  nodes: Ref<Nodes>,\n  edges: Ref<Edges>,\n  configs: Readonly<Configs>\n): Reactive<EdgeGroupStates> {\n  // Calculate position map\n  const state = Reactive<EdgeGroupStates>({\n    edgeLayoutPoints: {},\n    edgeGroups: {},\n    summarizedEdges: {},\n  })\n\n  watchEffect(() => {\n    const { edgeLayoutPoints, edgeGroups } = calculateEdgeGroupAndPositions(\n      configs,\n      nodes.value,\n      edges.value\n    )\n    updateObjectDiff(state.edgeLayoutPoints, edgeLayoutPoints)\n    updateObjectDiff(state.edgeGroups, edgeGroups)\n  })\n\n  // calc layout and check summarize\n  watchEffect(() => {\n    const summarizedEdges: Record<string, true> = {}\n    for (const [id, { edges, groupWidth }] of Object.entries(state.edgeGroups)) {\n      let summarize = false\n      if (groupWidth == 0) {\n        summarize = false\n      } else if (configs.edge.summarize instanceof Function) {\n        const s = configs.edge.summarize(edges, configs)\n        if (s === null) {\n          summarize = defaultCheckSummarize(nodes.value, edges, configs, groupWidth)\n        } else {\n          summarize = s\n        }\n      } else if (configs.edge.summarize) {\n        summarize = defaultCheckSummarize(nodes.value, edges, configs, groupWidth)\n      } else {\n        summarize = false\n      }\n      state.edgeGroups[id].summarize = summarize\n      if (summarize) {\n        Object.keys(edges).forEach(id => (summarizedEdges[id] = true))\n      }\n    }\n    updateObjectDiff(state.summarizedEdges, summarizedEdges)\n  })\n\n  return state\n}\n\n/**\n * Calculate the edge position by applying a shift.\n * @param p relative layout information of edges\n * @param isSummarized summarize or not\n * @param source position of source node\n * @param target position of target node\n * @param scale scale factor\n * @param keepOrder edge positional type config\n * @returns the edge position by applying a shift\n */\nexport function calculateEdgeShiftedPosition(\n  p: EdgeLayoutPoint | undefined,\n  isSummarized: boolean,\n  source: Position,\n  target: Position,\n  scale: number,\n  keepOrder: EdgeKeepOrderType\n): LinePosition {\n  if (!p) {\n    return { p1: { x: 0, y: 0 }, p2: { x: 0, y: 0 } } // sanitized\n  }\n  if (isSummarized) {\n    // summarize\n    return calculateEdgePositionInner(p.edge, source, target, scale, 0, 0, keepOrder)\n  } else {\n    return calculateEdgePositionInner(\n      p.edge,\n      source,\n      target,\n      scale,\n      p.groupWidth,\n      p.pointInGroup,\n      keepOrder\n    )\n  }\n}\n\n// -----------------------------------------------------------------------\n// Private functions\n// -----------------------------------------------------------------------\n\nfunction calculateEdgeGroupAndPositions(configs: Configs, nodes: Nodes, edges: Edges) {\n  const edgeLayoutPoints: Record<string, EdgeLayoutPoint> = {}\n  const edgeGroups: Record<string, EdgeGroup> = {}\n\n  // edges in nodes\n  // const edgesInNodes: Record<string, EdgesInNodes> = {}\n\n  // edge groups between same nodes\n  const map: Record<string, Edges> = {}\n\n  for (const [id, edge] of Object.entries(edges)) {\n    if (!(edge.source in nodes && edge.target in nodes)) {\n      // reject if no node ID is found on the nodes\n      continue\n    }\n    const key = [edge.source, edge.target].sort().join(\"<=>\")\n    const values = map[key] || {}\n    values[id] = edge\n    map[key] = values\n\n    // edgesInNodes[edge.source] ||= {}\n    // edgesInNodes[edge.target] ||= {}\n    // edgesInNodes[edge.source][id] = { opposite: edge.target }\n    // edgesInNodes[edge.target][id] = { opposite: edge.source }\n  }\n\n  // Calculate the following:\n  // - the starting point of each line\n  // - the width between the centers of the lines at both ends\n  // *Note*: the drawing position of the line is the center of the line.\n  const calcGap =\n    configs.edge.gap instanceof Function\n      ? configs.edge.gap\n      : (_e: Edges, _c: Configs) => configs.edge.gap as number\n  for (const [key, edges] of Object.entries(map)) {\n    const edgeLen = Object.keys(edges).length\n    if (edgeLen == 0) continue\n\n    const gap = calcGap(edges, configs)\n    const [edgeId, edge] = Object.entries(edges)[0]\n    if (edgeLen === 1) {\n      edgeLayoutPoints[edgeId] = { edge, pointInGroup: 0, groupWidth: 0 }\n      edgeGroups[key] = { edges, groupWidth: 0, summarize: false }\n    } else {\n      let pointInGroup = 0\n      const lineHalfWidths = Object.entries(edges).map(([id, edge]) => {\n        let width = Config.value(configs.edge.normal.width, edge)\n        if (isNaN(+width)) {\n          console.warn(\n            \"[v-network-graph] Edge width is invalid value. id=[%s] value=[%s]\",\n            id,\n            width\n          )\n          width = 1\n        }\n        return width / 2\n      })\n      const points = Object.entries(edges).map(([edgeId, edge], i) => {\n        if (i > 0) {\n          pointInGroup += lineHalfWidths[i - 1] + gap + lineHalfWidths[i]\n        }\n        return [edgeId, edge, pointInGroup] as [string, Edge, number]\n      })\n      const groupWidth = pointInGroup\n      points.forEach(([edgeId, edge, pointInGroup]) => {\n        edgeLayoutPoints[edgeId] = { edge, pointInGroup, groupWidth }\n      })\n      edgeGroups[key] = { edges, groupWidth, summarize: false }\n    }\n  }\n\n  return { edgeLayoutPoints, edgeGroups }\n}\n\nfunction defaultCheckSummarize(nodes: Nodes, edges: Edges, configs: Configs, width: number) {\n  // aggregate if the edge width and gap width exceed the size of the node\n  const edgeCount = Object.entries(edges).length\n  if (edgeCount === 1) return false\n\n  // const width =\n  //   Object.values(edges)\n  //     .map(e => Config.value(configs.edge.normal.width, e))\n  //     .reduce((sum, v) => sum + v, 0) +\n  //   configs.edge.gap * (edgeCount - 1)\n\n  const minWidth = Math.min(\n    ...Object.values(edges)\n      .flatMap(e => [nodes[e.source], nodes[e.target]])\n      .filter(v => v)\n      .map(node => {\n        const shape = Config.values(configs.node.normal, node)\n        if (shape.type === \"circle\") {\n          return shape.radius * 2\n        } else {\n          return Math.min(shape.width, shape.height)\n        }\n      })\n  )\n  return width > minWidth\n}\n\nfunction calculateEdgePositionInner(\n  edge: Edge,\n  source: Position | undefined,\n  target: Position | undefined,\n  scale: number,\n  groupWidth: number,\n  pointInGroup: number,\n  keepOrder: EdgeKeepOrderType\n): LinePosition {\n  let x1, y1, x2, y2\n  if (edge.source < edge.target) {\n    ;[x1, y1, x2, y2] = calculateLinePosition(\n      source?.x ?? 0,\n      source?.y ?? 0,\n      target?.x ?? 0,\n      target?.y ?? 0,\n      scale,\n      groupWidth,\n      pointInGroup,\n      keepOrder\n    )\n  } else {\n    ;[x2, y2, x1, y1] = calculateLinePosition(\n      target?.x ?? 0,\n      target?.y ?? 0,\n      source?.x ?? 0,\n      source?.y ?? 0,\n      scale,\n      groupWidth,\n      pointInGroup,\n      keepOrder\n    )\n  }\n  return { p1: { x: x1, y: y1 }, p2: { x: x2, y: y2 } }\n}\n\nfunction calculateLinePosition(\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  scale: number,\n  groupWidth: number,\n  pointInGroup: number,\n  keepOrder: EdgeKeepOrderType\n): [number, number, number, number] {\n  const dx = x2 - x1\n  const dy = y2 - y1\n\n  // Shifting width from center\n  let diff = (groupWidth / 2 - pointInGroup) * scale\n\n  // Adjust the relative position.\n  if (diff !== 0 && keepOrder !== \"clock\") {\n    const radian = Math.atan2(y2 - y1, x2 - x1)\n    if (keepOrder === \"vertical\") {\n      // Keep the vertical alignment of multiple edges.\n      const perpendicular = Math.PI / 2\n      if (radian < -perpendicular || radian >= perpendicular) {\n        diff *= -1\n      }\n    } else if (keepOrder === \"horizontal\") {\n      // Keep the horizontal alignment of multiple edges.\n      if (radian < 0) {\n        diff *= -1\n      }\n    }\n  }\n\n  if (dx === 0) {\n    const sign = dy < 0 ? -1 : 1\n    return [x1 + diff * sign, y1, x2 + diff * sign, y2]\n  } else if (dy === 0) {\n    const sign = dx < 0 ? 1 : -1\n    return [x1, y1 + diff * sign, x2, y2 + diff * sign]\n  } else {\n    const slope = dy / dx\n    const moveSlope = -1 / slope\n    if (dy < 0) {\n      diff = -diff\n    }\n    const diffX = diff / Math.sqrt(1 + Math.pow(moveSlope, 2))\n    return [x1 + diffX, y1 + diffX * moveSlope, x2 + diffX, y2 + diffX * moveSlope]\n  }\n}\n","import { Point2D } from \"./core\"\n\nexport function add(v1: Point2D, v2: Point2D): Point2D\nexport function add<T extends Point2D>(v1: Point2D, v2: Point2D, target: T): T\nexport function add(v1: Point2D, v2: Point2D, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  target.x = v1.x + v2.x\n  target.y = v1.y + v2.y\n  return target\n}\n\nexport function subtract(v1: Point2D, v2: Point2D): Point2D\nexport function subtract<T extends Point2D>(v1: Point2D, v2: Point2D, target: T): T\nexport function subtract(v1: Point2D, v2: Point2D, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  target.x = v1.x - v2.x\n  target.y = v1.y - v2.y\n  return target\n}\n\nexport function multiply(v1: Point2D, v2: Point2D): Point2D\nexport function multiply<T extends Point2D>(v1: Point2D, v2: Point2D, target: T): T\nexport function multiply(v1: Point2D, v2: Point2D, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  target.x = v1.x * v2.x\n  target.y = v1.y * v2.y\n  return target\n}\n\nexport function multiplyScalar(v: Point2D, scalar: number): Point2D\nexport function multiplyScalar<T extends Point2D>(v: Point2D, scalar: number, target: T): T\nexport function multiplyScalar(v: Point2D, scalar: number, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  target.x = v.x * scalar\n  target.y = v.y * scalar\n  return target\n}\n\nexport function divide(v1: Point2D, v2: Point2D): Point2D\nexport function divide<T extends Point2D>(v1: Point2D, v2: Point2D, target: T): T\nexport function divide(v1: Point2D, v2: Point2D, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  target.x = v1.x / v2.x\n  target.y = v1.y / v2.y\n  return target\n}\n\nexport function dot(v1: Point2D, v2: Point2D): number {\n  return v1.x * v2.x + v1.y * v2.y\n}\n\nexport function cross(v1: Point2D, v2: Point2D): number {\n  return v1.x * v2.y - v1.y * v2.x\n}\n\nexport function lengthSquared(v: Point2D): number {\n  return v.x * v.x + v.y * v.y\n}\n\nexport function length(v: Point2D): number {\n  return Math.sqrt(lengthSquared(v))\n}\n\nexport function distanceSquared(v1: Point2D, v2: Point2D): number {\n  const dx = v1.x - v2.x\n  const dy = v1.y - v2.y\n  return dx * dx + dy * dy\n}\n\nexport function distance(v1: Point2D, v2: Point2D): number {\n  return Math.sqrt(distanceSquared(v1, v2))\n}\n\nexport function normalize(v: Point2D): Point2D\nexport function normalize<T extends Point2D>(v: Point2D, target: T): T\nexport function normalize(v: Point2D, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  const len = length(v)\n  if (len === 0) {\n    target.x = 1\n    target.y = 0\n  } else {\n    divide(v, { x: len, y: len }, target)\n  }\n  return target\n}\n\nexport function rotate(v: Point2D, angle: number): Point2D\nexport function rotate<T extends Point2D>(v: Point2D, angle: number, target: T): T\nexport function rotate(v: Point2D, angle: number, target?: Point2D): Point2D {\n  if (!target) {\n    target = { x: 0, y: 0 }\n  }\n  // rotate in radians CCW from +X axis\n  const newX = v.x * Math.cos(angle) - v.y * Math.sin(angle)\n  const newY = v.x * Math.sin(angle) + v.y * Math.cos(angle)\n  target.x = newX\n  target.y = newY\n  return target\n}\n\nconst DEGREES = 180 / Math.PI\n\nfunction rad2deg(rad: number) {\n  return rad * DEGREES\n}\n\nexport function angle(v: Point2D) {\n  return Math.atan2(v.y, v.x)\n}\n\nexport function angleDegree(v: Point2D) {\n  return rad2deg(angle(v))\n}\n","import { Point2D } from \"./core\"\nimport { add, angle, angleDegree, cross, distance, distanceSquared, divide } from \"./methods\"\nimport { dot, length, lengthSquared, multiply, multiplyScalar, normalize } from \"./methods\"\nimport { rotate, subtract } from \"./methods\"\n\nexport class Vector2D implements Point2D {\n  public x: number\n  public y: number\n\n  static fromArray(array: number[]) {\n    return new Vector2D(array[0] || 0, array[1] || 0)\n  }\n\n  static fromObject(obj: Point2D) {\n    return new Vector2D(obj.x, obj.y)\n  }\n\n  constructor(x: number, y: number) {\n    this.x = x\n    this.y = y\n  }\n\n  // instance methods\n  add(v: Point2D): Vector2D {\n    return add(this, v, this)\n  }\n\n  subtract(v: Point2D): Vector2D {\n    return subtract(this, v, this)\n  }\n\n  multiply(v: Point2D): Vector2D {\n    return multiply(this, v, this)\n  }\n\n  multiplyScalar(scalar: number): Vector2D {\n    return multiplyScalar(this, scalar, this)\n  }\n\n  divide(v: Point2D): Vector2D {\n    return divide(this, v, this)\n  }\n\n  dot(v: Point2D): number {\n    return dot(this, v)\n  }\n\n  cross(v: Point2D): number {\n    return cross(this, v)\n  }\n\n  lengthSquared(): number {\n    return lengthSquared(this)\n  }\n\n  length(): number {\n    return length(this)\n  }\n\n  distanceSquared(v: Point2D): number {\n    return distanceSquared(this, v)\n  }\n\n  distance(v: Point2D): number {\n    return distance(this, v)\n  }\n\n  normalize(): Vector2D {\n    return normalize(this, this)\n  }\n\n  angle(): number {\n    return angle(this)\n  }\n\n  angleDegree(): number {\n    return angleDegree(this)\n  }\n\n  rotate(angle: number): Vector2D {\n    return rotate(this, angle, this)\n  }\n\n  isEqualTo(v: Point2D): boolean {\n    return this.x === v.x && this.y === v.y\n  }\n\n  clone(): Vector2D {\n    return new Vector2D(this.x, this.y)\n  }\n\n  toObject(): Point2D {\n    return { x: this.x, y: this.y }\n  }\n\n  toArray(): [number, number] {\n    return [this.x, this.y]\n  }\n}\n","export { Vector2D } from \"./vector2d\"\nexport * from \"./methods\"\n\nimport { Vector2D } from \"./vector2d\"\nimport * as V from \"./methods\"\n\nexport default {\n  Vector2D,\n  ...V\n}\n","import { LinePosition, Position } from \"@/common/types\"\nimport { Vector2D } from \"@/modules/vector2d\"\n\n// ---------------------------\n// Line information by vectors\n// ---------------------------\n\nexport class VectorLine {\n  public source: Vector2D\n  public target: Vector2D\n  public v: Vector2D\n\n  constructor(source: Vector2D, target: Vector2D, v: Vector2D) {\n    this.source = source\n    this.target = target\n    this.v = v\n  }\n\n  static fromLinePosition(line: LinePosition): VectorLine {\n    const source = Vector2D.fromObject(line.p1)\n    const target = Vector2D.fromObject(line.p2)\n    return new VectorLine(source, target, toLineVector(source, target))\n  }\n\n  static fromPositions(sourcePos: Position, targetPos: Position): VectorLine {\n    const source = Vector2D.fromObject(sourcePos)\n    const target = Vector2D.fromObject(targetPos)\n    return new VectorLine(source, target, toLineVector(source, target))\n  }\n\n  static fromVectors(source: Vector2D, target: Vector2D): VectorLine {\n    return new VectorLine(source, target, toLineVector(source, target))\n  }\n}\n\nexport function toLineVector(source: Vector2D, target: Vector2D): Vector2D {\n  return target.clone().subtract(source)\n}\n\nexport function toVectorsFromLinePosition(line: LinePosition): [Vector2D, Vector2D] {\n  return [Vector2D.fromObject(line.p1), Vector2D.fromObject(line.p2)]\n}\n\nexport function getCenterOfLinePosition(line: LinePosition): Vector2D {\n  return new Vector2D((line.p1.x + line.p2.x) / 2, (line.p1.y + line.p2.y) / 2)\n}\n\n// -------------------------------\n// Calculation functions for Lines\n// -------------------------------\n\n/**\n * Convert two `Position` to `LinePosition`\n * @param p1 source position of the line\n * @param p2 target position of the line\n * @returns `LinePosition` instance\n */\n export function toLinePosition(p1: Position, p2: Position): LinePosition {\n  return { p1, p2 }\n}\n\n/**\n * Calculates the line position to which the margin is applied.\n * @param linePos original position of the line\n * @param sourceMargin margin for source side\n * @param targetMargin margin for target side\n * @returns the line position\n */\n export function applyMargin(\n  linePos: LinePosition,\n  sourceMargin: number,\n  targetMargin: number\n): LinePosition {\n  const line = VectorLine.fromLinePosition(linePos)\n  return applyMarginInner(line, sourceMargin, targetMargin)\n}\n\nfunction applyMarginInner(\n  line: VectorLine,\n  sourceMargin: number,\n  targetMargin: number\n): LinePosition {\n  const normalized = line.v.clone().normalize()\n\n  const sv = line.source.clone().add(normalized.clone().multiplyScalar(sourceMargin))\n\n  const tv = line.target.clone().subtract(normalized.clone().multiplyScalar(targetMargin))\n\n  let p1 = sv.toObject()\n  let p2 = tv.toObject()\n\n  const check = toLineVector(sv, tv)\n  if (line.v.angle() * check.angle() < 0) {\n    // reversed\n    const c1 = new Vector2D((p1.x + p2.x) / 2, (p1.y + p2.y) / 2)\n    const c2 = c1.clone().add(normalized.multiplyScalar(0.5))\n    p1 = c1.toObject()\n    p2 = c2.toObject()\n  }\n\n  return { p1, p2 }\n}\n\nexport function inverseLine(line: LinePosition): LinePosition {\n  return { p1: line.p2, p2: line.p1 }\n}\n\nexport function calculatePerpendicularLine(line: VectorLine) {\n  const n1 = line.v\n    .clone()\n    .normalize()\n    .rotate(Math.PI / 2)\n  return VectorLine.fromVectors(line.target, line.target.clone().add(n1))\n}\n","import V, { Vector2D } from \"@/modules/vector2d\"\nimport { VectorLine } from \"./line\"\n\n/**\n * Calculate the nearest point from a point to a line.\n * @param p point\n * @param line line\n * @returns point on the line\n */\nexport function getNearestPoint(p: Vector2D, line: VectorLine): Vector2D {\n  const n = line.v.clone().normalize()\n\n  // Let `a` be a vector from any one point on a line to a point\n  const lp = line.source\n  const a = V.subtract(p, lp)\n\n  // Inner product of `n` and `a`\n  const dot = n.dot(a)\n\n  // The nearest point is the sum of a point on the line and a\n  // vector of n multiplied by dot.\n  const near = lp.clone().add(n.multiplyScalar(dot))\n\n  return near\n}\n\n// /**\n//  * Calculate the distance of nearest point from a point to a line.\n//  * @param p point\n//  * @param line line\n//  * @returns distance\n//  */\n// export function getDistanceToNearestPoint(p: Vector2D, line: VectorLine): number {\n//   const p2 = line.source\n//   const v2 = line.v\n\n//   const v2len = v2.lengthSquared()\n//   if (v2len === 0) {\n//     return 0\n//   }\n//   const t = V.dot(v2, V.subtract(p, p2)) / v2len\n//   const tv2 = V.multiplyScalar(v2, t)\n//   const h = p2.clone().add(tv2)\n//   return h.subtract(p).length()\n// }\n\nexport function getIntersectionOfLineTargetAndCircle(\n  source: Vector2D,\n  target: Vector2D,\n  center: Vector2D,\n  radius: number\n): Vector2D | null {\n  // Does the node contain a point?\n  const length = V.lengthSquared(V.subtract(target, center))\n  const contains = length - radius * radius <= Math.pow(1, -10)\n\n  if (!contains) return null // Not contained.\n\n  // If contained, calculate the intersection point.\n\n  // Find the nearest point `h` between `c` and the line\n  const line = VectorLine.fromVectors(source, target)\n  const h = getNearestPoint(center, line)\n\n  // Let `hp` be the vector from `c` to `h`.\n  const hpLen = V.length(V.subtract(h, center))\n\n  // If `hpLen` is larger than the radius of the circle,\n  // there is no intersection.\n  if (radius < hpLen) return null\n\n  // When a straight line and a circle are tangent, `hpLen` is `r`.\n  // Then the point of contact is the nearest point between the\n  // center and the line.\n  if (radius === hpLen) return h\n\n  // Let `t` be the distance from `h` to the contact point, and\n  // derive t from the Three Square Theorem.\n  const t = Math.sqrt(radius ** 2 - hpLen ** 2)\n\n  // Let `tv` be the vector of the normalized direction vector of\n  // the line multiplied by t\n  // - intersection point 1：p + tv\n  // - intersection point 2：p - tv\n  const tv = line.v.normalize().multiplyScalar(t)\n\n  // Calculate the addition or subtraction depending on which side\n  // of the line to focus on.\n  return h.subtract(tv)\n}\n\nexport function getIntersectionOfLineTargetAndCircle2(\n  source: Vector2D,\n  target: Vector2D,\n  center: Vector2D,\n  radius: number,\n  nearBy: Vector2D\n): Vector2D | null {\n  // Does the node contain a point?\n  const length = V.lengthSquared(V.subtract(target, center))\n  const contains = length - radius * radius <= Math.pow(1, -10)\n\n  if (!contains) return null // Not contained.\n\n  // If contained, calculate the intersection point.\n\n  // Find the nearest point `h` between `c` and the line\n  const line = VectorLine.fromVectors(source, target)\n  const h = getNearestPoint(center, line)\n\n  // Let `hp` be the vector from `c` to `h`.\n  const hpLen = V.length(V.subtract(h, center))\n\n  // If `hpLen` is larger than the radius of the circle,\n  // there is no intersection.\n  if (radius < hpLen) return null\n\n  // When a straight line and a circle are tangent, `hpLen` is `r`.\n  // Then the point of contact is the nearest point between the\n  // center and the line.\n  if (radius === hpLen) return h\n\n  // Let `t` be the distance from `h` to the contact point, and\n  // derive t from the Three Square Theorem.\n  const t = Math.sqrt(radius ** 2 - hpLen ** 2)\n\n  // Let `tv` be the vector of the normalized direction vector of\n  // the line multiplied by t\n  // - intersection point 1：p + tv\n  // - intersection point 2：p - tv\n  const tv = line.v.normalize().multiplyScalar(t)\n  const ip1 = h.clone().add(tv)\n  const ip2 = h.clone().subtract(tv)\n\n  const d1 = nearBy.distance(ip1)\n  const d2 = nearBy.distance(ip2)\n\n  if (Math.abs(d1 - d2) < 2) {\n    // Calculate the addition or subtraction depending on which side\n    // of the line to focus on.\n    return ip2\n  }\n\n  return d1 < d2 ? ip1 : ip2\n}\n\n/**\n * Calculate the intersection of two lines.\n * @param line1 line 1\n * @param line2 line 2\n * @returns intersection point\n */\nexport function getIntersectionPointOfLines(line1: VectorLine, line2: VectorLine): Vector2D {\n  const v = V.subtract(line2.source, line1.source)\n\n  const v1 = line1.v\n  const v2 = line2.v\n\n  const t2 = V.cross(v, v1) / V.cross(v1, v2)\n\n  return line2.source.clone().add(v2.clone().multiplyScalar(t2))\n}\n\nexport function getIntersectionOfCircles(\n  center1: Vector2D,\n  radius1: number,\n  center2: Vector2D,\n  radius2: number,\n  near: Vector2D\n): Vector2D | null\nexport function getIntersectionOfCircles(\n  center1: Vector2D,\n  radius1: number,\n  center2: Vector2D,\n  radius2: number\n): [Vector2D, Vector2D] | null\nexport function getIntersectionOfCircles(\n  center1: Vector2D,\n  radius1: number,\n  center2: Vector2D,\n  radius2: number,\n  near?: Vector2D\n): Vector2D | [Vector2D, Vector2D] | null {\n  const c1 = center1\n  const c2 = center2\n\n  // vector of C1-->C2\n  const vC1C2 = c2.clone().subtract(c1)\n\n  // length of C1--C2\n  const a = vC1C2.length()\n\n  const sumR = radius1 + radius2\n  if (sumR < a) return null // no overlap\n\n  // When a circle is contained, there is no contact point.\n  const subR = Math.abs(radius1 - radius2)\n  if (a < subR) return null\n\n  // When the circles are circumscribed, [a] and the sum of\n  // radius of two circles are equal. And there is only one\n  // contact point.\n  if (a === sumR) {\n    const n = vC1C2.clone().normalize()\n    const p = center1.clone().add(n.multiplyScalar(radius1))\n    return near ? p : [p , p]\n  }\n\n  // When the circles are inscribed, [a] and the difference\n  // between the radius of two circles are equal. And there\n  // is only one point of contact.\n  if (a === subR) {\n    const n = vC1C2.clone().normalize()\n    const isLarge = radius1 > radius2\n    // Let [P] be the contact point:\n    // * C1 is larger : P = C1 + r1 * n\n    // * C1 is smaller: P = C1 - r1 * n\n    const p = center1.clone().add(n.multiplyScalar(isLarge ? radius1 : -radius1))\n    return near ? p : [p , p]\n  }\n\n  // All three sides of triangle C1C2P are known.\n  // [b] := length of C1--P\n  // [c] := length of C2--P\n  const b = radius1\n  const c = radius2\n\n  // The cos θ of angle C1 is given by the cosine theorem:\n  const cos = (a ** 2 + b ** 2 - c ** 2) / (2 * a * b)\n\n  // Let [H] be the point where the vertical line from [P] to\n  // C1--C2 is dropped, and let [rc] be the length of C1--H.\n  const rc = b * cos\n\n  // Let the length of the H--P be [rs]\n  const rs = Math.sqrt(b ** 2 - rc ** 2)\n\n  // normalized vector of vC1C2\n  const n1 = vC1C2.clone().normalize()\n\n  // vector with n1 rotated 90 degrees to the left\n  const n2 = new Vector2D(-n1.y, n1.x)\n\n  // The point of intersection [P]\n  // P  = C1 + tn1 + sn2\n  // P' = C1 + tn1 - sn2\n  const tn1 = n1.clone().multiplyScalar(rc)\n  const sn2 = n2.clone().multiplyScalar(rs)\n\n  const result1 = center1.clone().add(tn1).add(sn2)\n  const result2 = center1.clone().add(tn1).subtract(sn2)\n\n  if (near) {\n    const d1 = result1.distance(near)\n    const d2 = result2.distance(near)\n    return d1 < d2 ? result1 : result2\n  } else {\n    return [result1, result2]\n  }\n}\n","import { AnyShapeStyle, RectangleShapeStyle, StrokeStyle } from \"@/common/configs\"\nimport { EdgeLabelArea, LinePosition, Position } from \"@/common/types\"\nimport V, { Vector2D } from \"@/modules/vector2d\"\nimport * as PointUtils from \"./point\"\nimport * as LineUtils from \"./line\"\nimport { VectorLine } from \"./line\"\n\n// /**\n//  * Calculate whether a point is contained in a circle.\n//  * @param point point\n//  * @param center center of the circle\n//  * @param radius radius of the circle\n//  * @returns whether point is contained in a circle\n//  */\n// export function isPointContainedInCircle(\n//   point: Position,\n//   center: Position,\n//   radius: number\n// ): boolean {\n//   const p = Vector2D.fromObject(point)\n//   const c = Vector2D.fromObject(center)\n//   const v = p.subtract(c)\n//   return v.lengthSquared() < radius * radius\n// }\n\n// /**\n//  * Calculate the distance of the line.\n//  * @param line line\n//  * @returns distance\n//  */\n// export function calculateDistance(line: LinePosition): number {\n//   return V.distance(line.p1, line.p2)\n// }\n\n/**\n * Get the distance that a line should be away from the\n * edge to avoid contacting a rounded rectangle.\n * @param sourcePos source position of the line\n * @param targetPos target position of the line\n * @param rect rectangle style\n * @param scale scale factor\n * @returns distance from target position\n */\nfunction calculateDistanceToAvoidOverlapsWithRect(\n  sourcePos: Position,\n  targetPos: Position, // position of the target rounded rectangle\n  rect: RectangleShapeStyle,\n  scale: number\n) {\n  const centerLine = VectorLine.fromPositions(sourcePos, targetPos)\n  const halfWidth = ((rect.width + rect.strokeWidth) / 2) * scale\n  const halfHeight = ((rect.height + rect.strokeWidth) / 2) * scale\n\n  const borderRadius =\n    rect.borderRadius > 0 ? (rect.borderRadius + rect.strokeWidth / 2) * scale : 0\n\n  // check whether it crosses over the vertical or horizontal boundary\n  const angleVRad = (centerLine.v.angle() - Math.PI / 2) % Math.PI\n  const angleHRad = Math.PI / 2 - (angleVRad % Math.PI)\n  const w = halfHeight * Math.abs(Math.tan(angleVRad))\n  const h = halfWidth * Math.abs(Math.tan(angleHRad))\n  const isCrossedVLine = w <= halfWidth - borderRadius\n  const isCrossedHLine = h <= halfHeight - borderRadius\n  if (isCrossedVLine || isCrossedHLine || borderRadius === 0) {\n    if (isCrossedVLine) {\n      return Math.sqrt(halfHeight ** 2 + w ** 2)\n    } else {\n      return Math.sqrt(halfWidth ** 2 + h ** 2)\n    }\n  } else {\n    // on the border radius: calculate the center of circles\n    const left = targetPos.x - halfWidth + borderRadius\n    const top = targetPos.y - halfHeight + borderRadius\n    const right = targetPos.x + halfWidth - borderRadius\n    const bottom = targetPos.y + halfHeight - borderRadius\n    const vertexes = [\n      new Vector2D(left, top),\n      new Vector2D(right, top),\n      new Vector2D(right, bottom),\n      new Vector2D(left, bottom),\n    ]\n    const index = Math.floor(((centerLine.v.angleDegree() + 360) % 360) / 90)\n    const centerOfNearestCircle = vertexes[index]\n    const point = PointUtils.getIntersectionOfLineTargetAndCircle(\n      centerLine.source,\n      PointUtils.getNearestPoint(centerOfNearestCircle, centerLine),\n      centerOfNearestCircle,\n      borderRadius\n    )\n    return point\n      ? LineUtils.toLineVector(point, centerLine.target).length()\n      : LineUtils.toLineVector(centerOfNearestCircle, centerLine.target).length() + borderRadius\n  }\n}\n\n/**\n * Calculate the position to display the edge label from the\n * positions of the edge.\n * @param linePos line segment between the outermost of the nodes\n * @param edgeStyle stroke style of edges\n * @param margin margin from line\n * @param padding padding from outside\n * @param scale scale factor\n * @returns edge label display area\n */\nexport function calculateEdgeLabelArea(\n  linePos: LinePosition,\n  edgeStyle: StrokeStyle,\n  margin: number,\n  padding: number,\n  scale: number\n): EdgeLabelArea {\n  // the line segment between the outermost of the nodes\n  const line = VectorLine.fromLinePosition(linePos)\n  const normalized = line.v.clone().normalize()\n\n  // source side\n  const sv =\n    padding === 0\n      ? line.source\n      : line.source.clone().add(normalized.clone().multiplyScalar(padding * scale))\n\n  // target side\n  const tv =\n    padding === 0\n      ? line.target\n      : line.target.clone().subtract(normalized.clone().multiplyScalar(padding * scale))\n\n  // margin for edges\n  const labelMargin = (edgeStyle.width / 2 + margin) * scale\n  const vMargin = new Vector2D(-normalized.y, normalized.x).multiplyScalar(labelMargin)\n  let sourceAbove = V.subtract(sv, vMargin)\n  let sourceBelow = V.add(sv, vMargin)\n  let targetAbove = V.subtract(tv, vMargin)\n  let targetBelow = V.add(tv, vMargin)\n\n  const angle = line.v.angleDegree()\n  if (angle < -90 || angle >= 90) {\n    // upside down\n    ;[sourceAbove, sourceBelow] = [sourceBelow, sourceAbove]\n    ;[targetAbove, targetBelow] = [targetBelow, targetAbove]\n  }\n  return {\n    source: { above: sourceAbove, below: sourceBelow },\n    target: { above: targetAbove, below: targetBelow },\n  }\n}\n\n/**\n * Calculate the distances between center of node and edge of node.\n * @param sourceNodePos position of source node\n * @param targetNodePos position of target node\n * @param sourceNodeShape shape config of source node\n * @param targetNodeShape shape config of target node\n * @returns the distances\n */\nexport function calculateDistancesFromCenterOfNodeToEndOfNode(\n  sourceNodePos: Position,\n  targetNodePos: Position,\n  sourceNodeShape: AnyShapeStyle,\n  targetNodeShape: AnyShapeStyle\n): [number, number] {\n  // source side\n  let distance1: number\n  if (sourceNodeShape.type === \"circle\") {\n    distance1 = sourceNodeShape.radius + (sourceNodeShape.strokeWidth / 2)\n  } else {\n    distance1 = calculateDistanceToAvoidOverlapsWithRect(\n      targetNodePos,\n      sourceNodePos,\n      sourceNodeShape,\n      1 // scale\n    )\n  }\n\n  // target side\n  let distance2: number\n  if (targetNodeShape.type === \"circle\") {\n    distance2 = targetNodeShape.radius + (targetNodeShape.strokeWidth / 2)\n  } else {\n    distance2 = calculateDistanceToAvoidOverlapsWithRect(\n      sourceNodePos,\n      targetNodePos,\n      targetNodeShape,\n      1 // scale\n    )\n  }\n\n  return [distance1, distance2]\n}\n\n/**\n * Calculates the position of a given distance along the circumference.\n * @param pos original position\n * @param center center of the circle\n * @param radian radius of the circle\n * @returns the moved position\n */\nexport function moveOnCircumference(pos: Position, center: Position, radian: number) {\n  const { x, y } = pos\n  const dx = x - center.x\n  const dy = y - center.y\n\n  return {\n    x: dx * Math.cos(radian) - dy * Math.sin(radian) + center.x,\n    y: dx * Math.sin(radian) + dy * Math.cos(radian) + center.y,\n  }\n}\n\n/**\n * Reverse the direction of the angle.\n * @param theta angle\n * @returns reversed angle\n */\nexport function reverseAngleRadian(theta: number): number {\n  if (theta > 0) {\n    return -(Math.PI * 2 - theta)\n  } else {\n    return Math.PI * 2 + theta\n  }\n}\n\nexport function calculateBezierCurveControlPoint(\n  p1: Vector2D,\n  center: Vector2D,\n  p2: Vector2D,\n  theta0: number\n): Vector2D[] {\n  const control: Vector2D[] = []\n  const centerToSource = VectorLine.fromVectors(center, p1)\n  const centerToTarget = VectorLine.fromVectors(center, p2)\n\n  let theta = calculateRelativeAngleRadian(centerToSource, centerToTarget)\n  if (theta0 * theta < 0) {\n    theta = reverseAngleRadian(theta)\n  }\n  const middle = Vector2D.fromObject(moveOnCircumference(p1, center, -theta / 2))\n  const centerToMp = VectorLine.fromVectors(center, middle)\n  const mpTangent = LineUtils.calculatePerpendicularLine(centerToMp)\n\n  const theta1 = calculateRelativeAngleRadian(centerToSource, centerToMp)\n  let tangent = LineUtils.calculatePerpendicularLine(centerToSource)\n  if (Math.abs(theta1) < Math.PI / 2) {\n    const cp = PointUtils.getIntersectionPointOfLines(tangent, mpTangent)\n    control.push(cp)\n  } else {\n    // If greater than 90 degrees, go through the midpoint.\n    const mp = Vector2D.fromObject(moveOnCircumference(middle, center, theta1 / 2))\n    const tangent2 = LineUtils.calculatePerpendicularLine(\n      VectorLine.fromVectors(center, Vector2D.fromObject(mp))\n    )\n    const cp1 = PointUtils.getIntersectionPointOfLines(tangent, tangent2)\n    const cp2 = PointUtils.getIntersectionPointOfLines(tangent2, mpTangent)\n    control.push(cp1, mp, cp2)\n  }\n\n  control.push(middle)\n\n  const theta2 = calculateRelativeAngleRadian(centerToTarget, centerToMp)\n  tangent = LineUtils.calculatePerpendicularLine(centerToTarget)\n  if (Math.abs(theta2) < Math.PI / 2) {\n    const cp = PointUtils.getIntersectionPointOfLines(tangent, mpTangent)\n    control.push(cp)\n  } else {\n    // If greater than 90 degrees, go through the midpoint.\n    const mp = Vector2D.fromObject(moveOnCircumference(middle, center, theta2 / 2))\n    const tangent2 = LineUtils.calculatePerpendicularLine(\n      VectorLine.fromVectors(center, Vector2D.fromObject(mp))\n    )\n    const cp1 = PointUtils.getIntersectionPointOfLines(mpTangent, tangent2)\n    const cp2 = PointUtils.getIntersectionPointOfLines(tangent2, tangent)\n    control.push(cp1, mp, cp2)\n  }\n\n  return control\n}\n\nexport function calculateRelativeAngleRadian(line1: VectorLine, line2: VectorLine) {\n  return Math.atan2(\n    line1.v.y * line2.v.x - line1.v.x * line2.v.y,\n    line1.v.x * line2.v.x + line1.v.y * line2.v.y\n  )\n}\n\nexport function calculateCircleCenterAndRadiusBy3Points(\n  p1: Vector2D,\n  p2: Vector2D,\n  p3: Vector2D\n): [Vector2D, number] {\n  const x1 = p1.x\n  const y1 = p1.y\n  const x2 = p2.x\n  const y2 = p2.y\n  const x3 = p3.x\n  const y3 = p3.y\n  const x12 = x1 - x2\n  const y12 = y1 - y2\n  const x32 = x3 - x2\n  const y32 = y3 - y2\n\n  if ((x12 === 0 && y12 === 0) || (x32 === 0 && y32 === 0)) {\n    // Cannot determine the curve if two or more of the three points are in the same position.\n    return [p1, 0];\n  }\n\n  const x =\n    (y32 * (x12 * (x1 + x2) + y12 * (y1 + y2)) - y12 * (x32 * (x3 + x2) + y32 * (y3 + y2))) /\n    (2 * x12 * y32 - 2 * y12 * x32)\n  const y =\n    (-x32 * (x12 * (x1 + x2) + y12 * (y1 + y2)) + x12 * (x32 * (x3 + x2) + y32 * (y3 + y2))) /\n    (2 * x12 * y32 - 2 * y12 * x32)\n\n  const radius = Math.sqrt(Math.pow(x1 - x, 2) + Math.pow(y1 - y, 2))\n  const center = new Vector2D(x, y)\n  return [center, radius]\n}\n","import { AnyShapeStyle } from \"@/common/configs\"\nimport { Box, NodePositions } from \"@/common/types\"\n\nexport function getNodeRadius(shape: AnyShapeStyle) {\n  if (shape.type == \"circle\") {\n    return shape.radius\n  } else {\n    return Math.min(shape.width, shape.height) / 2\n  }\n}\n\nexport function getNodesBox(layouts: NodePositions): Box {\n  const positions = Object.values(layouts)\n  if (positions.length === 0) {\n    return {\n      top: 0,\n      bottom: 0,\n      left: 0,\n      right: 0,\n    }\n  }\n\n  const result = {\n    top: positions[0].y,\n    bottom: positions[0].y,\n    left: positions[0].x,\n    right: positions[0].x,\n  }\n\n  positions.forEach(pos => {\n    result.top = Math.min(pos.y, result.top)\n    result.bottom = Math.max(pos.y, result.bottom)\n    result.left = Math.min(pos.x, result.left)\n    result.right = Math.max(pos.x, result.right)\n  })\n\n  return result\n}\n","\ntype Args<T> = [...(T | null)[], T]\n\nexport function findFirstNonNull<T>(...values: Args<T>): T {\n  return values.find(v => !!v) as T\n}\n","import { NodePositions, PositionOrCurve } from \"@/common/types\"\nimport { nonNull } from \"@/common/common\"\nimport { NodeStates } from \"@/models/node\"\nimport { EdgeStates, EdgeState } from \"@/models/edge\"\nimport { EdgeLine, EdgeObject, PathState } from \"@/models/path\"\nimport { PathEndType } from \"@/common/configs\"\nimport { findFirstNonNull } from \"@/utils/collection\"\nimport * as v2d from \"@/modules/calculation/2d\"\nimport * as PointUtils from \"@/modules/calculation/point\"\nimport { VectorLine } from \"@/modules/calculation/line\"\nimport * as LineUtils from \"@/modules/calculation/line\"\nimport * as NodeUtils from \"@/modules/node/node\"\nimport V, { Vector2D } from \"@/modules/vector2d\"\n\nconst EPSILON = Number.EPSILON * 100 // 2.2204... x 10‍−‍14.\n\nexport function calculatePathPoints(\n  path: PathState,\n  nodeStates: NodeStates,\n  nodeLayouts: NodePositions,\n  edgeStates: EdgeStates,\n  scale: number,\n  curveInNode: boolean,\n  pathEndType: PathEndType,\n  margin: number\n): PositionOrCurve[] {\n  // The relationship between the source/target of a link and the connection\n  // by path can be different.\n  // Detect node at connection point and determine source/target for the path.\n  const edges = path.edges\n\n  // Edge ID list -> List of Edge locations\n  const directions = path.directions // true: forward, false: reverse\n  const edgePos = edges.map((edge, i) => _getEdgeLine(edge, directions[i], edgeStates[edge.edgeId]))\n\n  // the results\n  const points: (Vector2D[] | Vector2D)[] = []\n\n  let isMarginOverRunStart = false\n  let isMarginOverRunEnd = false\n\n  // ----------------------------------------------------\n  // Determine the starting point.\n  // ----------------------------------------------------\n  {\n    const firstEdge = edgePos[0]\n    let nodeRadius = NodeUtils.getNodeRadius(nodeStates[firstEdge.source].shape) * scale\n    const lineMargin = margin + (pathEndType === \"edgeOfNode\" ? nodeRadius : 0)\n    const nextPoint =\n      lineMargin <= 0\n        ? firstEdge.line.source\n        : _calculateEdgeOfNode(firstEdge, lineMargin, nodeLayouts, true)\n    points.push(nextPoint)\n    nodeRadius = NodeUtils.getNodeRadius(nodeStates[firstEdge.target].shape) * scale\n    if (margin > 0) {\n      const distance = V.distance(firstEdge.line.source, firstEdge.line.target)\n      if (distance <= lineMargin + nodeRadius) {\n        isMarginOverRunStart = true\n      }\n    }\n  }\n\n  // ----------------------------------------------------\n  // Determine transit points.\n  // ----------------------------------------------------\n  const length = edges.length\n  for (let i = 1; i < length; i++) {\n    const prev = edgePos[i - 1]\n    const next = edgePos[i]\n\n    const nodeId = next.source\n    const nodePos = Vector2D.fromObject(nodeLayouts[nodeId] ?? { x: 0, y: 0 })\n\n    // The intersection point of two lines: [X]\n    const crossPoint = _getIntersectionOfLines(prev, next, nodePos)\n\n    // Place another small circle inside the node's circle and\n    // calculate transit points so that the path line is smooth.\n    //   Inner circle: [α] radius: `nodeCoreRadius`\n    //   Node circle : [β] radius: `nodeRadius`\n    const nodeRadius = NodeUtils.getNodeRadius(nodeStates[nodeId].shape) * scale\n    const nodeCoreRadius = Math.max(nodeRadius * (2 / 3), nodeRadius - 4 * scale)\n    const isForwardPrev = _isForward(prev)\n    const isForwardNext = _isForward(next)\n    const prevCoreIp = _getIntersectionOfLineAndNode(prev, nodePos, nodeCoreRadius, isForwardPrev)\n    const nextCoreIp = _getIntersectionOfLineAndNode(next, nodePos, nodeCoreRadius, !isForwardNext)\n    const prevNodeIp = _getIntersectionOfLineAndNode(prev, nodePos, nodeRadius, isForwardPrev)\n    const nextNodeIp = _getIntersectionOfLineAndNode(next, nodePos, nodeRadius, !isForwardNext)\n\n    // ----------------------------------------------------\n    // Calculate transit points in the node.\n    // ----------------------------------------------------\n    let pos: Vector2D | Vector2D[]\n    if (crossPoint) {\n      const d = V.distance(crossPoint, nodePos)\n      if (d < nodeCoreRadius) {\n        // (1) [α] includes [X]:\n        //  * [X]: control point in bezier\n        //  * intersection with [α]: transit point\n        pos = [\n          findFirstNonNull(prevCoreIp, prevNodeIp, prev.line.target),\n          crossPoint,\n          findFirstNonNull(nextCoreIp, nextNodeIp, next.line.source),\n        ]\n      } else if (d <= nodeRadius) {\n        // (2) [β] includes [X]:\n        //  * [X]: control point in bezier\n        let p1: Vector2D, p2: Vector2D\n        if (prevNodeIp && prevCoreIp) {\n          // the prev line intersects [α] and [β]:\n          // Of [α]x[line], [β]x[line], use the one closer to [X] as the transit point.\n          p1 =\n            V.distance(crossPoint, prevCoreIp) < V.distance(crossPoint, prevNodeIp)\n              ? prevCoreIp\n              : prevNodeIp\n        } else {\n          // the prev line intersects only with [β]:\n          // use [β]x[line] as the transit point.\n          p1 = prevNodeIp || prev.line.target\n        }\n        if (nextNodeIp && nextCoreIp) {\n          // the next line intersects with [α] and [β]:\n          // Of [α]x[line], [β]x[line], use the one closer to [X] as the transit point.\n          p2 =\n            V.distance(crossPoint, nextCoreIp) < V.distance(crossPoint, nextNodeIp)\n              ? nextCoreIp\n              : nextNodeIp\n        } else {\n          // the next line intersects only with [β]:\n          // use [β]x[line] as the transit point.\n          p2 = nextNodeIp || next.line.source\n        }\n        pos = [p1, crossPoint, p2]\n      } else {\n        // (3) [X] is out of the node([β])\n        if (prevCoreIp && nextCoreIp) {\n          // both lines intersect with [α]:\n          // use the [α]x[line] as transit point, and\n          // center of the node as control point in bezier.\n          pos = [prevCoreIp, nodePos, nextCoreIp]\n        } else if (prevNodeIp && nextNodeIp) {\n          // both lines intersect with [β]:\n          // use the [β]x[line] as transit point, and\n          // center of the node as control point in bezier.\n          pos = [prevNodeIp, nodePos, nextNodeIp]\n        } else {\n          // either or both lines do not intersect the node:\n          // [X] as transit point in bezier, and not place control points.\n          // [α]x[line] or [β]x[line] or end of [line] as the transit points, and\n          // center of the node as control point in bezier.\n          pos = [\n            findFirstNonNull(prevCoreIp, prevNodeIp, prev.line.target),\n            nodePos,\n            findFirstNonNull(nextCoreIp, nextNodeIp, next.line.source),\n          ]\n        }\n      }\n    } else {\n      // There is no intersection of two lines:\n      // center of the node as control point in bezier.\n      if (prevCoreIp && nextCoreIp) {\n        // both lines intersect with [α]:\n        // [α]x[line] as transit point.\n        pos = [prevCoreIp, nodePos, nextCoreIp]\n      } else if (prevNodeIp && nextNodeIp) {\n        // both lines intersect with [β]:\n        // [β]x[line] as transit point.\n        pos = [prevNodeIp, nodePos, nextNodeIp]\n      } else {\n        // either or both lines do not intersect the node:\n        // the end of the line as transit point.\n        pos = [prev.line.target, nodePos, next.line.source]\n      }\n    }\n\n    if (prev.curve) {\n      // ----------------------------------------------------\n      // Specify points on the curve.\n      // ----------------------------------------------------\n      // The starting point has already been added to `points`.\n      const lastPoints = points[points.length - 1]\n      if (lastPoints) {\n        const lastPoint =\n          lastPoints instanceof Array ? lastPoints[lastPoints.length - 1] : lastPoints\n        let nextPoint\n        if (pos instanceof Array) {\n          // Curved lines always end at the center of the node.\n          // To avoid smoothness, use only a transit point.\n          nextPoint = curveInNode ? pos[0] : pos[1]\n        } else {\n          nextPoint = pos\n        }\n        const control = v2d.calculateBezierCurveControlPoint(\n          lastPoint,\n          prev.curve.circle.center,\n          nextPoint,\n          prev.curve.theta\n        )\n        if (pos instanceof Array && curveInNode) {\n          points.push([...control, ...pos])\n        } else {\n          points.push([...control, nextPoint])\n        }\n      }\n    } else if (prev.loop) {\n      const [p1, p2, arc] = _makeArcString(nodePos, prev, nodeRadius)\n      points.push(p1)\n      points.push(arc)\n      if (pos instanceof Array && curveInNode) {\n        points.push([p2, pos[1], pos[2]])\n      } else {\n        points.push(pos[2])\n      }\n    } else {\n      if (curveInNode || !(pos instanceof Array)) {\n        points.push(pos)\n      } else {\n        if (next.curve) {\n          points.push(pos[1]) // use control point as transit point\n        } else if (next.loop) {\n          points.push(pos[0])\n        } else {\n          points.push(pos[0], pos[2]) // without control point to avoid smoothness\n        }\n      }\n    }\n  }\n\n  // ----------------------------------------------------\n  // Determine the terminate point.\n  // ----------------------------------------------------\n  {\n    const lastEdge = edgePos[edgePos.length - 1]\n    let nodeRadius = NodeUtils.getNodeRadius(nodeStates[lastEdge.target].shape) * scale\n    const lineMargin = margin + (pathEndType === \"edgeOfNode\" ? nodeRadius : 0)\n    const nextPoint =\n      lineMargin <= 0\n        ? lastEdge.line.target\n        : _calculateEdgeOfNode(lastEdge, lineMargin, nodeLayouts, false)\n    nodeRadius = NodeUtils.getNodeRadius(nodeStates[lastEdge.source].shape) * scale\n    if (lastEdge.loop) {\n      const nodePos = Vector2D.fromObject(nodeLayouts[lastEdge.target] ?? { x: 0, y: 0 })\n      const [p1, _, arc] = _makeArcString(nodePos, lastEdge, nodeRadius)\n      points.push(p1)\n      points.push(arc)\n    } else if (lastEdge.curve) {\n      // curve\n      const pos = points[points.length - 1]\n      const lastPoint = pos instanceof Array ? pos[pos.length - 1] : pos\n      const control = v2d.calculateBezierCurveControlPoint(\n        lastPoint,\n        lastEdge.curve.circle.center,\n        nextPoint,\n        lastEdge.curve.theta\n      )\n      points.push([...control, nextPoint])\n    } else {\n      // straight\n      points.push(nextPoint)\n    }\n    if (margin > 0) {\n      const distance = V.distance(lastEdge.line.source, lastEdge.line.target)\n      if (distance <= lineMargin + nodeRadius) {\n        isMarginOverRunEnd = true\n      }\n    }\n  }\n\n  if (isMarginOverRunStart) {\n    points.shift()\n    if (points[0] instanceof Array) {\n      points.unshift(points[0][0])\n    }\n  }\n  if (isMarginOverRunEnd) {\n    points.pop()\n  }\n\n  return points\n}\n\nexport function calculateDirectionsOfPathEdges(edges: EdgeObject[]): boolean[] {\n  const length = edges.length\n  if (length === 0) return []\n  if (length <= 1) return [true]\n\n  const directions: boolean[] = [] // true: forward, false: reverse\n  let lastNode: string | null = null\n  let isForward = true\n  for (let i = 0; i < length; i++) {\n    const source = edges[i].edge.source\n    const target = edges[i].edge.target\n    if (i === 0) {\n      if (length > 2) {\n        // If the next edge is an edge between the same nodes,\n        // check for more next edges.\n        const joint = _getJointNode(edges, 0)\n        if (joint === null) {\n          isForward = true\n        } else {\n          isForward = joint === target\n        }\n      } else {\n        isForward = [edges[1].edge.source, edges[1].edge.target].includes(target)\n      }\n    } else if (source === target) {\n      isForward = true // loop edge direction is always true\n    } else {\n      isForward = lastNode === source\n    }\n    directions.push(isForward)\n    lastNode = isForward ? target : source\n  }\n\n  return directions\n}\n\nfunction _getJointNode(edges: EdgeObject[], index: number): string | null {\n  const edgeObject0 = edges[index]\n  const edgeObject1 = edges[index + 1]\n  const currentEdge = [edgeObject0.edge.source, edgeObject0.edge.target].sort()\n  const nextEdge = [edgeObject1.edge.source, edgeObject1.edge.target].sort()\n\n  if (currentEdge[0] === currentEdge[1]) {\n    // current edge is looped\n    return currentEdge[0]\n  }\n\n  if (nextEdge[0] === nextEdge[1]) {\n    // next edge is looped\n    return nextEdge[0]\n  }\n\n  if (edgeObject0.edgeId === edgeObject1.edgeId || (currentEdge[0] === nextEdge[0] && currentEdge[1] === nextEdge[1])) {\n    // both edges are between same nodes\n    if (index >= edges.length - 2) {\n      // cannot be determined.\n      return null;\n    } else {\n      // check with next edge\n      const joint = _getJointNode(edges, index + 1)\n      if (joint === null) {\n        return null;\n      } else {\n        return joint === currentEdge[1] ? currentEdge[0] : currentEdge[1];\n      }\n    }\n  } else {\n    return nextEdge.includes(currentEdge[1]) ? currentEdge[1] : currentEdge[0]\n  }\n}\n\nfunction _calculateEdgeOfNode(\n  edge: EdgeLine,\n  nodeRadius: number,\n  nodeLayouts: NodePositions,\n  direction: boolean\n) {\n  const nodeId = direction ? edge.source : edge.target\n  const curve = edge.curve\n  if (curve) {\n    let moveRad = nodeRadius / curve.circle.radius\n    if (curve.theta > 0) {\n      moveRad *= -1\n    }\n    if (!direction) {\n      moveRad *= -1\n    }\n    return Vector2D.fromObject(\n      v2d.moveOnCircumference(\n        direction ? edge.line.source : edge.line.target,\n        curve.circle.center,\n        moveRad\n      )\n    )\n  } else {\n    let source: Vector2D, target: Vector2D\n    if (direction) {\n      source = edge.line.target\n      target = edge.line.source\n    } else {\n      source = edge.line.source\n      target = edge.line.target\n    }\n    // straight\n    if (nodeLayouts[nodeId]) {\n      const p = PointUtils.getIntersectionOfLineTargetAndCircle(\n        source,\n        target,\n        Vector2D.fromObject(nodeLayouts[nodeId]),\n        nodeRadius\n      )\n      return p === null ? source : p\n    } else {\n      return source\n    }\n  }\n}\n\nfunction _getIntersectionOfLines(\n  prev: EdgeLine,\n  next: EdgeLine,\n  nodePos: Vector2D\n): Vector2D | null {\n  let crossPoint: Vector2D | null = null\n  if (prev.loop || next.loop) {\n    crossPoint = null // not exist intersection point\n  } else if (prev.curve) {\n    if (next.curve) {\n      if (prev.line.target.isEqualTo(next.line.source)) {\n        return prev.line.target.clone()\n      }\n      // curve -- curve\n      crossPoint = PointUtils.getIntersectionOfCircles(\n        prev.curve.circle.center,\n        prev.curve.circle.radius,\n        next.curve.circle.center,\n        next.curve.circle.radius,\n        prev.curve.center\n      )\n    } else {\n      // curve -- straight\n      crossPoint = PointUtils.getIntersectionOfLineTargetAndCircle2(\n        next.line.target,\n        next.line.source,\n        prev.curve.circle.center,\n        prev.curve.circle.radius,\n        nodePos\n      )\n    }\n  } else {\n    if (next.curve) {\n      // straight -- curve\n      crossPoint = PointUtils.getIntersectionOfLineTargetAndCircle(\n        prev.line.source,\n        prev.line.target,\n        next.curve.circle.center,\n        next.curve.circle.radius\n      )\n    } else {\n      // straight -- straight\n      const prevSlope = _getSlope(prev.line)\n      const nextSlope = _getSlope(next.line)\n      const isParallel =\n        (!isFinite(prevSlope) && !isFinite(nextSlope)) || Math.abs(prevSlope - nextSlope) < EPSILON\n      if (isParallel) {\n        crossPoint = null // not exist intersection point\n      } else {\n        crossPoint = PointUtils.getIntersectionPointOfLines(prev.line, next.line)\n      }\n    }\n  }\n  return crossPoint\n}\n\nfunction _getIntersectionOfLineAndNode(\n  edge: EdgeLine,\n  nodeCenter: Vector2D,\n  nodeRadius: number,\n  targetSide: boolean\n): Vector2D | null {\n  if (edge.loop) {\n    const points = PointUtils.getIntersectionOfCircles(\n      nodeCenter,\n      nodeRadius,\n      edge.loop.center,\n      edge.loop.radius[0]\n    )\n    return points ? (targetSide ? points[0] : points[1]) : null\n  } else if (edge.curve) {\n    return PointUtils.getIntersectionOfCircles(\n      nodeCenter,\n      nodeRadius,\n      edge.curve.circle.center,\n      edge.curve.circle.radius,\n      Vector2D.fromObject(edge.curve.center)\n    )\n  } else {\n    return PointUtils.getIntersectionOfLineTargetAndCircle(\n      targetSide ? edge.line.source : edge.line.target,\n      targetSide ? edge.line.target : edge.line.source,\n      nodeCenter,\n      nodeRadius\n    )\n  }\n}\n\nfunction _getEdgeLine(edge: EdgeObject, direction: boolean, state: EdgeState): EdgeLine {\n  let position = state.origin\n  let source = edge.edge.source\n  let target = edge.edge.target\n  let curve = state.curve\n  const loop = state.loop\n  if (loop) {\n    position = state.position\n  } else if (!direction) {\n    position = LineUtils.inverseLine(position)\n    source = edge.edge.target\n    target = edge.edge.source\n    if (curve) {\n      curve = { ...curve, theta: -curve.theta }\n    }\n  }\n  const line = VectorLine.fromLinePosition(position)\n  const result: EdgeLine = {\n    edgeId: edge.edgeId,\n    source,\n    target,\n    line,\n    direction,\n    curve,\n    loop,\n  }\n  return result\n}\n\nfunction _getSlope(pos: VectorLine) {\n  return (pos.target.y - pos.source.y) / (pos.target.x - pos.source.x)\n}\n\nfunction _makeArcString(\n  nodePos: Vector2D,\n  edge: EdgeLine,\n  nodeRadius: number\n): [Vector2D, Vector2D, any] {\n  const { radius, center } = nonNull(edge.loop, \"Loop of edge parameter\")\n  const [rx, ry] = radius\n  const ends = PointUtils.getIntersectionOfCircles(nodePos, nodeRadius, center, radius[0])\n  let [end1, end2] = ends ? ends.reverse() : [edge.line.source, edge.line.target]\n  const isClockwise = _isForward(edge)\n  if (!isClockwise) {\n    [end1, end2] = [end2, end1]\n  }\n  const p1 = end1\n  const p2 = end2\n\n  const a1 = Vector2D.fromObject(p1).subtract(center).angleDegree()\n  const a2 = Vector2D.fromObject(p2).subtract(center).angleDegree()\n  const angle = (a2 + 360 - a1) % 360\n  let largeArc = angle >= 180 ? true : false\n  largeArc = isClockwise ? largeArc : !largeArc\n  const f1 = largeArc ? 1 : 0\n  const f2 = isClockwise ? 1 : 0\n\n  return [p1, p2, `A ${rx} ${ry} 0 ${f1} ${f2} ${p2.x} ${p2.y}`]\n}\n\nfunction _isForward(edge: EdgeLine) {\n  if (edge.loop) {\n    return edge.direction ? edge.loop.isClockwise : !edge.loop.isClockwise\n  } else {\n    return true\n  }\n}\n","// Management states of objects\n\nimport { computed, ComputedRef, reactive, Ref, unref, UnwrapRef, watch } from \"vue\"\nimport { Reactive } from \"@/common/common\"\nimport { Config, ObjectConfigs, ZOrderConfig } from \"@/common/configs\"\n\ntype Objects<T> = Record<string, T>\n\ninterface ObjectStateDatumBase {\n  id: string\n  selected: boolean\n  hovered: boolean\n  selectable: ComputedRef<boolean | number>\n  zIndex: ComputedRef<number>\n}\ntype ObjectState<S extends ObjectStateDatumBase> = UnwrapRef<S>\n\ntype PartiallyPartial<T, K extends keyof T> = Pick<T, K> & Partial<Omit<T, K>>\ntype NewStateDatum<T extends ObjectStateDatumBase> = PartiallyPartial<T, keyof ObjectStateDatumBase>\n\nexport function useObjectState<\n  T,\n  S extends ObjectStateDatumBase,\n  E extends { id: string; zIndex: number } = ObjectState<S>\n>(\n  objects: Ref<Record<string, T>>,\n  config: ObjectConfigs<T>,\n  selected: Reactive<Set<string>>,\n  hovered: Reactive<Set<string>>,\n  createState: (obj: Ref<Objects<T>>, id: string, state: NewStateDatum<S>) => void,\n  terminateState?: (id: string, state: ObjectState<S>) => void,\n  entriesForZOrder?: () => E[]\n): {\n  states: Record<string, ObjectState<S>>\n  zOrderedList: ComputedRef<E[]>\n} {\n  // Object states\n  const states: Record<string, ObjectState<S>> = reactive({})\n\n  // Handle object added/removed\n  watch(\n    () => new Set(Object.keys(objects.value)),\n    (idSet, prev) => {\n      if (!prev) prev = new Set([])\n      for (const id of idSet) {\n        if (prev.has(id)) continue\n        // object added\n        createNewState(objects, states, id, false, config, createState)\n        // adding to layouts is done by layout handler\n      }\n\n      for (const id of prev) {\n        if (idSet.has(id)) continue\n        // object removed\n        selected.delete(id)\n        hovered.delete(id)\n        terminateState?.(id, states[id] as ObjectState<S>)\n        delete states[id]\n      }\n    },\n    { immediate: true }\n  )\n\n  // Object selection\n  // - update `{obj}.selected` flag\n  watch(\n    () => [...selected],\n    (objects, prev) => {\n      const append = prev ? objects.filter(n => !prev.includes(n)) : objects\n      const removed = prev ? prev.filter(n => !objects.includes(n)) : []\n      append.forEach(id => {\n        const state = states[id]\n        if (state && !state.selected) state.selected = true\n      })\n      removed.forEach(id => {\n        const state = states[id]\n        if (state && state.selected) state.selected = false\n      })\n    },\n    { immediate: true } // for specified from the beginning\n  )\n\n  // - update `node.hovered` flag\n  watch(\n    () => [...hovered],\n    (nodes, prev) => {\n      const append = nodes.filter(n => !prev.includes(n))\n      const removed = prev.filter(n => !nodes.includes(n))\n      append.forEach(id => {\n        const state = states[id]\n        if (state && !state.hovered) state.hovered = true\n      })\n      removed.forEach(id => {\n        const state = states[id]\n        if (state && state.hovered) state.hovered = false\n      })\n    }\n  )\n\n  // z-order\n  // z-index applied Object List\n  const zOrderedList = computed(() => {\n    const list: E[] = entriesForZOrder ? entriesForZOrder() : (Object.values(states) as E[])\n    if (config.zOrder.enabled) {\n      return makeZOrderedList(list, config.zOrder, hovered, selected)\n    } else {\n      return list\n    }\n  })\n\n  return { states, zOrderedList }\n}\n\nfunction createNewState<T, S extends ObjectStateDatumBase>(\n  objects: Ref<Objects<T>>,\n  states: Record<string, ObjectState<S>>,\n  id: string,\n  selected: boolean,\n  config: ObjectConfigs<T>,\n  createState: (obj: Ref<Objects<T>>, id: string, state: NewStateDatum<S>) => void\n) {\n  const stateObject = <NewStateDatum<S>>{\n    id,\n    selected,\n    hovered: false,\n    selectable: computed(() => {\n      if (!objects.value[id]) return unref(stateObject.selectable) // Return the previous value\n      return Config.value(config.selectable, objects.value[id])\n    }),\n    zIndex: computed(() => {\n      if (!objects.value[id]) return unref(stateObject.zIndex) // Return the previous value\n      return Config.value(config.zOrder.zIndex, objects.value[id])\n    }),\n  }\n  states[id] = stateObject as ObjectState<S>\n  createState(objects, id, states[id] as NewStateDatum<S> /* get reactive object */)\n}\n\nfunction makeZOrderedList<S extends { id: string; zIndex: number }, T>(\n  states: S[],\n  zOrder: ZOrderConfig<T>,\n  hovered: Reactive<Set<string>>,\n  selected: Reactive<Set<string>>\n) {\n  if (zOrder.bringToFrontOnHover && zOrder.bringToFrontOnSelected) {\n    return states.sort((a, b) => {\n      const hover1 = hovered.has(a.id)\n      const hover2 = hovered.has(b.id)\n      if (hover1 != hover2) {\n        return hover1 ? 1 : -1\n      }\n      const selected1 = selected.has(a.id)\n      const selected2 = selected.has(b.id)\n      if (selected1 != selected2) {\n        return selected1 ? 1 : -1\n      }\n      return a.zIndex - b.zIndex\n    })\n  } else if (zOrder.bringToFrontOnHover) {\n    return states.sort((a, b) => {\n      const hover1 = hovered.has(a.id)\n      const hover2 = hovered.has(b.id)\n      if (hover1 != hover2) {\n        return hover1 ? 1 : -1\n      }\n      return a.zIndex - b.zIndex\n    })\n  } else if (zOrder.bringToFrontOnSelected) {\n    return states.sort((a, b) => {\n      const selected1 = selected.has(a.id)\n      const selected2 = selected.has(b.id)\n      if (selected1 != selected2) {\n        return selected1 ? 1 : -1\n      }\n      return a.zIndex - b.zIndex\n    })\n  } else {\n    return states.sort((a, b) => {\n      return a.zIndex - b.zIndex\n    })\n  }\n}\n","\nexport function convertToAscii(source: string): string {\n  if (typeof btoa === undefined) {\n    return Buffer.from(source).toString(\"base64\").replaceAll(\"=\", \"\")\n  } else {\n    return btoa(source).replaceAll(\"=\", \"\")\n  }\n}\n","import { reactive } from \"vue\"\nimport { MarkerStyle } from \"@/common/configs\"\nimport { convertToAscii } from \"@/utils/string\"\n\nexport type MarkerBuilder = (marker: MarkerStyle | null, isSource?: boolean) => string\n\nexport interface HeadMarker extends MarkerStyle {\n  color: string\n  isSource: boolean\n}\n\nexport interface MarkerState {\n  markers: Record<string, HeadMarker>\n  referenceCount: Record<string, number>\n}\n\nexport function makeMarkerState(): MarkerState {\n  const markers: Record<string, HeadMarker> = reactive({})\n  const referenceCount: Record<string, number> = {}\n  return { markers, referenceCount }\n}\n\nexport function useMarker(markerState: MarkerState) {\n  const { markers, referenceCount } = markerState\n\n  function addMarker(key: string, marker: HeadMarker) {\n    const m = referenceCount[key] ?? 0\n    referenceCount[key] = m + 1\n    if (!m) {\n      markers[key] = marker\n    }\n  }\n\n  function removeMarker(key: string) {\n    const m = referenceCount[key] ?? 0\n    if (m) {\n      if (m - 1 === 0) {\n        delete markers[key]\n        delete referenceCount[key]\n      } else {\n        referenceCount[key] = m - 1\n      }\n    }\n  }\n\n  function clearMarker(id: string | undefined) {\n    if (id) {\n      removeMarker(id)\n    }\n  }\n\n  function makeMarker(\n    marker: MarkerStyle,\n    isSource: boolean,\n    previousId: string | undefined,\n    strokeColor: string,\n    instanceId: number\n  ) {\n    if (marker.type === \"none\") {\n      clearMarker(previousId)\n      return undefined\n    }\n\n    if (marker.type === \"custom\") {\n      clearMarker(previousId)\n      return marker.customId\n    }\n\n    const headMarker = toHeadMarker(marker, isSource, strokeColor)\n    const id = buildKey(headMarker, instanceId)\n    if (id === previousId) {\n      return id\n    }\n    clearMarker(previousId)\n    addMarker(id, headMarker)\n    return id\n  }\n\n  return {\n    makeMarker,\n    clearMarker,\n  }\n}\n\nfunction toHeadMarker(marker: MarkerStyle, isSource: boolean, strokeColor: string) {\n  return {\n    ...marker,\n    color: marker.color ?? strokeColor,\n    isSource,\n  }\n}\n\nfunction buildKey(m: HeadMarker, instanceId: number) {\n  // If the same marker ID exists in the previous instance and is hidden by\n  // `display: none`, the marker in the other instance will disappear.\n  // For safety, marker IDs will be unique in the entire page.\n  const c = convertToAscii(m.color)\n  const d = m.isSource ? \"L\" : \"R\"\n  const u = m.units === \"strokeWidth\" ? \"rel\" : \"abs\"\n  return `marker_${instanceId}_${m.type}_${m.width}_${m.height}_${m.margin}_${m.offset}_${c}_${d}_${u}`\n}\n","// the states of nodes and edges\n\nimport { computed, ComputedRef, reactive, ref, Ref, toRef, unref } from \"vue\"\nimport { watch, watchEffect } from \"vue\"\nimport { inject, InjectionKey, provide } from \"vue\"\nimport { nonNull, Reactive } from \"@/common/common\"\nimport {\n  Config,\n  Configs,\n  EdgeConfig,\n  MarkerStyle,\n  NodeConfig,\n  OppositeNode,\n} from \"@/common/configs\"\nimport { StrokeStyle, ShapeStyle, SelfLoopEdgeStyle } from \"@/common/configs\"\nimport { Edge, Edges, Layouts, Node, Nodes, Path, Paths } from \"@/common/types\"\nimport { FixablePosition, UserLayouts } from \"@/common/types\"\nimport { LinePosition, Position } from \"@/common/types\"\nimport { useId } from \"@/composables/id\"\nimport * as NodeModel from \"@/models/node\"\nimport * as EdgeModel from \"@/models/edge\"\nimport * as EdgeGroup from \"@/modules/edge/group\"\nimport * as PathModel from \"@/models/path\"\nimport * as v2d from \"@/modules/calculation/2d\"\nimport * as LineUtils from \"@/modules/calculation/line\"\nimport * as PointUtils from \"@/modules/calculation/point\"\nimport * as NodeUtils from \"@/modules/node/node\"\nimport { VectorLine } from \"@/modules/calculation/line\"\nimport { Vector2D } from \"@/modules/vector2d\"\nimport * as V2D from \"@/modules/vector2d\"\nimport { Point2D } from \"@/modules/vector2d/core\"\nimport { updateObjectDiff } from \"@/utils/object\"\nimport { calculateDirectionsOfPathEdges } from \"@/modules/calculation/path\"\nimport { useObjectState } from \"./objectState\"\nimport { MarkerState, useMarker } from \"./marker\"\n\n// -----------------------------------------------------------------------\n// Type definitions\n// -----------------------------------------------------------------------\n\nexport type { EdgeGroupStates } from \"@/models/edge\"\n\n// States of nodes\n\n// Provide states\n\ninterface States {\n  nodeStates: NodeModel.NodeStates\n  edgeStates: EdgeModel.EdgeStates\n  edgeGroupStates: EdgeModel.EdgeGroupStates\n  summarizedEdgeStates: EdgeModel.SummarizedEdgeStates\n  pathStates: PathModel.PathStates\n  nodeZOrderedList: ComputedRef<NodeModel.NodeState[]>\n  edgeZOrderedList: ComputedRef<EdgeModel.EdgeEntry[]>\n  pathZOrderedList: ComputedRef<PathModel.PathState[]>\n  layouts: Layouts\n}\n\nexport type ReadonlyStates = Readonly<States>\n\ninterface InputObjects<T> {\n  objects: Ref<T>\n  selected: Reactive<Set<string>>\n  hovered: Reactive<Set<string>>\n}\n\nexport function makeStateInput<T>(\n  objects: Ref<T>,\n  selected: Reactive<Set<string>>,\n  hovered: Reactive<Set<string>>\n) {\n  return {\n    objects,\n    selected,\n    hovered,\n  }\n}\n\n// -----------------------------------------------------------------------\n// Constants\n// -----------------------------------------------------------------------\n\nconst statesKey = Symbol(\"states\") as InjectionKey<States>\n\nconst NONE_MARKER: MarkerStyle = {\n  type: \"none\",\n  width: 0,\n  height: 0,\n  margin: 0,\n  offset: 0,\n  units: \"strokeWidth\",\n  color: null,\n}\n\n// -----------------------------------------------------------------------\n// Exported functions\n// -----------------------------------------------------------------------\n\nexport function provideStates(\n  nodes: InputObjects<Nodes>,\n  edges: InputObjects<Edges>,\n  paths: InputObjects<Paths>,\n  configs: Readonly<Configs>,\n  layouts: Reactive<Layouts>,\n  readonlyLayouts: Readonly<UserLayouts>,\n  makerState: MarkerState,\n  scale: ComputedRef<number>\n) {\n  const summarizedEdgeStates: EdgeModel.SummarizedEdgeStates = reactive({})\n\n  // -----------------------------------------------------------------------\n  // States for nodes\n  // -----------------------------------------------------------------------\n\n  // { nodeId: { edgeId: opposingNodeId } }\n  const opposingNodes = Reactive<Record<string, Record<string, string>>>({})\n  watchEffect(() => {\n    const _nodes = Object.fromEntries(\n      Object.keys(nodes.objects.value).map(k => [k, {} as Record<string, string>])\n    )\n    Object.entries(edges.objects.value).forEach(([id, e]) => {\n      if (!_nodes?.[e.source]) _nodes[e.source] = {}\n      if (!_nodes?.[e.target]) _nodes[e.target] = {}\n      _nodes[e.source][id] = e.target\n      _nodes[e.target][id] = e.source\n    })\n    updateObjectDiff(opposingNodes, _nodes)\n  })\n\n  const {\n    states: nodeStates,\n    zOrderedList: nodeZOrderedList, //\n  } = useObjectState<Node, NodeModel.NodeStateDatum, NodeModel.NodeState>(\n    nodes.objects,\n    configs.node,\n    nodes.selected,\n    nodes.hovered,\n    (nodes, id, newState) => {\n      createNewNodeState(\n        nodes,\n        id,\n        newState as NodeModel.NodeStateDatum,\n        configs.node,\n        opposingNodes,\n        layouts,\n        readonlyLayouts\n      )\n    },\n    (nodeId, _state) => {\n      const positions = layouts.nodes\n      delete positions[nodeId]\n    }\n  )\n\n  // -----------------------------------------------------------------------\n  // States for edges\n  // -----------------------------------------------------------------------\n  // Instance ID number for using to make marker ID generation unique for the\n  // entire page.\n  // If the same marker ID exists in the previous instance and is hidden by\n  // `display: none`, the marker in the other instance will disappear.\n  // To be safe, markers should be unique in the entire page.\n  const instanceId = useId()\n\n  // grouping\n  const edgeGroupStates = EdgeGroup.makeEdgeGroupStates(nodes.objects, edges.objects, configs)\n\n  // edge entries for applying z-order\n  const edgeEntries = ref<EdgeModel.EdgeEntry[]>([])\n\n  const {\n    states: edgeStates,\n    zOrderedList: edgeZOrderedList, //\n  } = useObjectState<Edge, EdgeModel.EdgeStateDatum, EdgeModel.EdgeEntry>(\n    edges.objects,\n    configs.edge,\n    edges.selected,\n    edges.hovered,\n    (edges, id, newState) => {\n      createNewEdgeState(\n        edges,\n        id,\n        newState as EdgeModel.EdgeStateDatum,\n        configs.edge,\n        makerState,\n        nodeStates,\n        edgeGroupStates,\n        layouts,\n        scale,\n        instanceId\n      )\n    },\n    (_edgeId, state) => {\n      state.stopWatchHandle?.()\n    },\n    () => edgeEntries.value\n  )\n\n  // Edge item for display (an edge or summarized edges)\n  watchEffect(() => {\n    edgeEntries.value = createEdgeEntries(edgeGroupStates.edgeGroups, edgeStates)\n  })\n\n  watch(\n    edgeGroupStates.edgeGroups,\n    _ => createSummarizedEdgeStates(summarizedEdgeStates, edgeGroupStates, configs),\n    { immediate: true }\n  )\n\n  // -----------------------------------------------------------------------\n  // States for paths\n  // -----------------------------------------------------------------------\n\n  const {\n    states: pathStates,\n    zOrderedList: pathZOrderedList, //\n  } = useObjectState<Path, PathModel.PathStateDatum, PathModel.PathState>(\n    paths.objects,\n    configs.path,\n    paths.selected,\n    paths.hovered,\n    (paths, id, newState) => {\n      const state = newState as PathModel.PathStateDatum\n\n      state.clickable = computed(() => {\n        if (!paths.value[id]) return false\n        return Config.value(configs.path.clickable, paths.value[id])\n      })\n      state.hoverable = computed(() => {\n        if (!paths.value[id]) return false\n        return Config.value(configs.path.hoverable, paths.value[id])\n      })\n\n      state.path = paths.value[id]\n      state.edges = toEdgeObjects(state.path, edges)\n      state.directions = calculateDirectionsOfPathEdges(state.edges)\n\n      state.stopWatchHandle = watch(\n        () => paths.value[id].edges,\n        () => {\n          state.path = paths.value[id]\n          state.edges = toEdgeObjects(state.path, edges)\n          state.directions = calculateDirectionsOfPathEdges(state.edges)\n        }\n      )\n    },\n    (_, state) => {\n      state.stopWatchHandle?.()\n    }\n  )\n\n  const states = <States>{\n    nodeStates,\n    edgeStates,\n    edgeGroupStates,\n    summarizedEdgeStates,\n    pathStates,\n    layouts,\n    nodeZOrderedList,\n    edgeZOrderedList,\n    pathZOrderedList,\n  }\n  provide(statesKey, states)\n  return states\n}\n\nexport function isSummarizedEdges(item: EdgeModel.EdgeItem): item is EdgeModel.SummarizedEdgeItem {\n  return item.summarized\n}\n\nexport function useStates() {\n  return nonNull(inject(statesKey), \"states\") as ReadonlyStates\n}\n\n// -----------------------------------------------------------------------\n// Local functions\n// -----------------------------------------------------------------------\n\nfunction getNodeShape(node: Node, selected: boolean, hovered: boolean, config: NodeConfig) {\n  if (hovered && config.hover) {\n    return Config.values(config.hover, node)\n  } else {\n    return getNodeStaticShape(node, selected, config)\n  }\n}\n\nfunction getNodeStaticShape(node: Node, selected: boolean, config: NodeConfig) {\n  // get shape without hovered state\n  if (selected && config.selected) {\n    return Config.values(config.selected, node)\n  } else {\n    return Config.values(config.normal, node)\n  }\n}\n\nfunction createNewNodeState(\n  nodes: Ref<Nodes>,\n  id: string,\n  state: NodeModel.NodeStateDatum,\n  config: NodeConfig,\n  oppositeNodeIds: Reactive<Record<string, Record<string, string>>>,\n  layouts: Reactive<Layouts>,\n  readonlyLayouts: Readonly<UserLayouts>\n) {\n  // Deleted nodes will lose their position. If it is not a two-way binding,\n  // the position remains in the layout specified by the user and is reacquired.\n  if (!layouts.nodes[id] && readonlyLayouts.nodes?.[id]) {\n    layouts.nodes[id] = <FixablePosition>{ ...readonlyLayouts.nodes?.[id] }\n  }\n\n  state.shape = computed(() => {\n    if (!nodes.value[id]) return unref(state.shape) // Return the previous value\n    return getNodeShape(nodes.value[id], state.selected, state.hovered, config)\n  })\n\n  state.staticShape = computed(() => {\n    if (!nodes.value[id]) return unref(state.staticShape) // Return the previous value\n    return getNodeStaticShape(nodes.value[id], state.selected, config)\n  })\n\n  state.label = computed(() => {\n    if (!nodes.value[id]) return unref(state.label) // Return the previous value\n    return Config.values(config.label, nodes.value[id])\n  })\n\n  state.labelText = computed(() => {\n    if (config.label.text instanceof Function) {\n      return unref(state.label).text\n    } else {\n      if (!nodes.value[id]) return unref(state.labelText) // Return the previous value\n      return nodes.value[id]?.[unref(state.label).text] ?? \"\"\n    }\n  })\n\n  state.draggable = computed(() => {\n    if (!nodes.value[id]) return unref(state.draggable) // Return the previous value\n    return Config.value(config.draggable, nodes.value[id])\n  })\n\n  state.oppositeNodeIds = toRef(oppositeNodeIds, id)\n\n  state.oppositeNodes = computed<Record<string, OppositeNode>>(() => {\n    return Object.entries(state.oppositeNodeIds).reduce(\n      (nodes, entry) => {\n        const [edgeId, nodeId] = entry as [string, string]\n        const pos = layouts.nodes[nodeId]\n        if (pos) nodes[edgeId] = { nodeId, pos: { ...pos } }\n        return nodes\n      },\n      {} as Record<string, OppositeNode>\n    )\n  })\n}\n\nfunction getEdgeStroke(edge: Edge, selected: boolean, hovered: boolean, config: EdgeConfig) {\n  if (selected) {\n    return Config.values(config.selected, edge)\n  } else if (hovered && config.hover) {\n    return Config.values(config.hover, edge)\n  } else {\n    return Config.values(config.normal, edge)\n  }\n}\n\nfunction toEdgeMarker(marker: MarkerStyle): MarkerStyle {\n  if (marker.type === \"none\") {\n    return NONE_MARKER\n  } else {\n    return marker\n  }\n}\n\nfunction createNewEdgeState(\n  edges: Ref<Edges>,\n  id: string,\n  state: EdgeModel.EdgeStateDatum,\n  config: EdgeConfig,\n  makerState: MarkerState,\n  nodeStates: NodeModel.NodeStates,\n  edgeGroupStates: Reactive<EdgeModel.EdgeGroupStates>,\n  layouts: Layouts,\n  scale: Ref<number>,\n  instanceId: number\n) {\n  const { makeMarker, clearMarker } = useMarker(makerState)\n\n  Object.assign(state, {\n    origin: { p1: { x: 0, y: 0 }, p2: { x: 0, y: 0 } },\n    labelPosition: { p1: { x: 0, y: 0 }, p2: { x: 0, y: 0 } },\n    position: { p1: { x: 0, y: 0 }, p2: { x: 0, y: 0 } },\n  })\n\n  state.label = computed(() => {\n    if (!edges.value[id]) return unref(state.label) // Return the previous value\n    return Config.values(config.label, edges.value[id])\n  })\n\n  const line = computed<EdgeModel.Line>(() => {\n    const edge = edges.value[id]\n    const stroke = getEdgeStroke(edge, state.selected, state.hovered, config)\n    // Minimum error checking required for drawing\n    if (isNaN(+stroke.width)) {\n      console.warn(\n        \"[v-network-graph] Edge width is invalid value. id=[%s] value=[%s]\",\n        id,\n        stroke.width\n      )\n      stroke.width = 1\n    }\n    if (stroke.color === undefined || stroke.color === null) {\n      console.warn(\n        \"[v-network-graph] Edge color is invalid value. id=[%s] value=[%s]\",\n        id,\n        stroke.color\n      )\n      stroke.color = \"#000000\"\n    }\n    let normalWidth = Config.value(config.normal.width, edge)\n    if (isNaN(+normalWidth)) {\n      normalWidth = 1\n    }\n    const source = toEdgeMarker(Config.values(config.marker.source, [edge, stroke]))\n    const target = toEdgeMarker(Config.values(config.marker.target, [edge, stroke]))\n    return { stroke, normalWidth, source, target }\n  })\n  state.line = line\n  const edgeLayoutPoint: Ref<EdgeModel.EdgeLayoutPoint | undefined> = toRef(\n    edgeGroupStates.edgeLayoutPoints,\n    id\n  )\n  const isEdgeSummarized: Ref<true | undefined> = toRef(edgeGroupStates.summarizedEdges, id)\n\n  const stopCalcHandle = watchEffect(() => {\n    const edge = edges.value[id]\n    if (!edge) return\n\n    const sourceShape = nodeStates[edge.source]?.staticShape\n    const targetShape = nodeStates[edge.target]?.staticShape\n    if (!sourceShape || !targetShape) {\n      return\n    }\n\n    const source = layouts.nodes[edge?.source] ?? { x: 0, y: 0 }\n    const target = layouts.nodes[edge?.target] ?? { x: 0, y: 0 }\n\n    // calculate the line segment between center of nodes\n    const shiftedPosition = EdgeGroup.calculateEdgeShiftedPosition(\n      edgeLayoutPoint.value,\n      isEdgeSummarized.value ?? false,\n      source,\n      target,\n      scale.value,\n      config.keepOrder\n    )\n\n    const [sourceShapeMargin, targetShapeMargin] =\n      v2d.calculateDistancesFromCenterOfNodeToEndOfNode(source, target, sourceShape, targetShape)\n\n    const s = scale.value\n\n    // calculate the line segment between the outermost of the nodes\n    state.labelPosition = LineUtils.applyMargin(\n      shiftedPosition,\n      sourceShapeMargin * s,\n      targetShapeMargin * s\n    )\n\n    // calculate margins\n    let sourceMargin = 0\n    let targetMargin = 0\n    const l = line.value\n    if (l.source.type !== \"none\") {\n      const marker = l.source\n      sourceMargin = marker.margin + marker.width\n      if (marker.units === \"strokeWidth\") {\n        sourceMargin *= l.normalWidth\n      }\n    }\n    if (l.target.type !== \"none\") {\n      const marker = l.target\n      targetMargin = marker.margin + marker.width\n      if (marker.units === \"strokeWidth\") {\n        targetMargin *= l.normalWidth\n      }\n    }\n\n    if (config.margin) {\n      sourceMargin += config.margin\n      targetMargin += config.margin\n    }\n\n    const isStartEdgeOfNode =\n      !!config.margin || l.source.type !== \"none\" || l.target.type !== \"none\"\n\n    // calculate self-loop edge\n    if (edge.source === edge.target) {\n      state.origin = LineUtils.toLinePosition(source, target)\n\n      const selfLoopStyle = Config.values(config.selfLoop, edge)\n      const [position, arc] = calculateArcPositionAndState(\n        source,\n        sourceShape,\n        selfLoopStyle,\n        isStartEdgeOfNode,\n        sourceMargin,\n        targetMargin,\n        edgeLayoutPoint.value?.pointInGroup ?? 0,\n        s\n      )\n      state.position = position\n      state.loop = arc\n      state.curve = undefined\n      return\n    } else {\n      state.loop = undefined\n    }\n\n    if (isStartEdgeOfNode) {\n      sourceMargin += sourceShapeMargin\n      targetMargin += targetShapeMargin\n    }\n\n    // calculate the line segments to be displayed with margins applied\n    const type = config.type\n    if (type === \"straight\" || isEdgeSummarized.value) {\n      state.origin = shiftedPosition\n      state.curve = undefined\n      if (sourceMargin === 0 && targetMargin === 0) {\n        state.position = state.origin\n      } else {\n        state.position = LineUtils.applyMargin(state.origin, sourceMargin * s, targetMargin * s)\n      }\n    } else {\n      // curve\n      state.origin = LineUtils.toLinePosition(source, target)\n\n      const shift = edgeLayoutPoint.value // undefined after node deletion\n        ? edgeLayoutPoint.value.groupWidth / 2 - edgeLayoutPoint.value.pointInGroup\n        : 0\n\n      const [position, curve] = calculateCurvePositionAndState(\n        state.origin,\n        shiftedPosition,\n        shift,\n        sourceMargin * s,\n        targetMargin * s\n      )\n      state.position = position\n      state.curve = curve\n    }\n  })\n\n  const stopUpdateMarkerHandle = watchEffect(() => {\n    if (!edges.value[id]) return\n    state.sourceMarkerId = makeMarker(\n      line.value.source,\n      true /* isSource */,\n      state.sourceMarkerId,\n      line.value.stroke.color,\n      instanceId\n    )\n    state.targetMarkerId = makeMarker(\n      line.value.target,\n      false /* isSource */,\n      state.targetMarkerId,\n      line.value.stroke.color,\n      instanceId\n    )\n  })\n\n  state.stopWatchHandle = () => {\n    stopCalcHandle()\n    stopUpdateMarkerHandle()\n    clearMarker(state.sourceMarkerId)\n    clearMarker(state.targetMarkerId)\n  }\n}\n\nfunction createEdgeEntries(\n  edgeGroups: Record<string, EdgeModel.EdgeGroup>,\n  edgeStates: EdgeModel.EdgeStates\n) {\n  return Object.entries(edgeGroups)\n    .map(([key, group]) => {\n      if (group.summarize) {\n        return <EdgeModel.SummarizedEdgeItem>{\n          id: Object.keys(group.edges)[0] ?? key,\n          summarized: true,\n          key,\n          group,\n          zIndex: Object.keys(group.edges)\n            .map(id => edgeStates[id]?.zIndex ?? 0)\n            .reduce((s, z) => Math.max(s, z)),\n        }\n      } else {\n        return Object.entries(group.edges).map(\n          ([id, edge]) =>\n            <EdgeModel.SingleEdgeItem>{\n              id,\n              summarized: false,\n              key: id,\n              edge,\n              zIndex: edgeStates[id]?.zIndex ?? 0,\n            }\n        )\n      }\n    })\n    .flat()\n}\n\nfunction calculateCurvePositionAndState(\n  originPosition: LinePosition,\n  shiftedPosition: LinePosition,\n  shift: number,\n  sourceMargin: number,\n  targetMargin: number\n): [LinePosition, EdgeModel.Curve | undefined] {\n  // The curve is assumed to be part of a perfect circle and is drawn\n  // as a Bezier curve.\n\n  const origin = VectorLine.fromLinePosition(originPosition)\n  const shifted = VectorLine.fromLinePosition(shiftedPosition)\n  const shiftedCenter = LineUtils.getCenterOfLinePosition(shiftedPosition)\n\n  // Calculate the center and radius of the circle of the curve.\n  const [center, radius] = v2d.calculateCircleCenterAndRadiusBy3Points(\n    origin.source,\n    origin.target,\n    shiftedCenter\n  )\n\n  let position: LinePosition\n  let curve: EdgeModel.Curve | undefined = undefined\n\n  if (radius === 0) {\n    return [originPosition, curve]\n  } else if (shift === 0) {\n    // The line connecting the centers of the nodes is regarded as a straight line.\n    if (sourceMargin === 0 && targetMargin === 0) {\n      position = originPosition\n    } else {\n      position = LineUtils.applyMargin(originPosition, sourceMargin, targetMargin)\n    }\n    return [position, curve]\n  }\n\n  // Apply margin to the line.\n  const centerToTop = VectorLine.fromVectors(center, shiftedCenter)\n\n  // Direction of rotation from source to center:\n  const theta0 = v2d.calculateRelativeAngleRadian(\n    VectorLine.fromVectors(center, origin.source),\n    centerToTop\n  )\n\n  if (sourceMargin === 0 && targetMargin === 0) {\n    position = originPosition\n  } else {\n    // The endpoints of the display line are the point on the circumference\n    // moved by the margin from the origin end points.\n    let sourceMoveRad = sourceMargin / radius\n    let targetMoveRad = targetMargin / radius\n\n    // Determine which direction to move.\n    if (theta0 > 0) {\n      sourceMoveRad *= -1\n      targetMoveRad *= -1\n    }\n    position = LineUtils.toLinePosition(\n      v2d.moveOnCircumference(origin.source, center, sourceMoveRad),\n      v2d.moveOnCircumference(origin.target, center, -targetMoveRad)\n    )\n\n    // If the endpoints are swapped by applying the margin,\n    // a short line is shown at the center.\n    let theta1 = v2d.calculateRelativeAngleRadian(\n      VectorLine.fromVectors(center, origin.source),\n      VectorLine.fromVectors(center, origin.target)\n    )\n    let theta2 = v2d.calculateRelativeAngleRadian(\n      VectorLine.fromPositions(center, position.p1),\n      VectorLine.fromPositions(center, position.p2)\n    )\n    if (theta0 * theta1 < 0) {\n      theta1 = v2d.reverseAngleRadian(theta1)\n      if (theta0 * theta2 < 0) {\n        theta2 = v2d.reverseAngleRadian(theta2)\n      }\n    }\n    if (theta1 * theta2 < 0) {\n      // reversed\n      const c = shiftedCenter.clone().add(shifted.v.normalize().multiplyScalar(0.5))\n      position = LineUtils.toLinePosition(shiftedCenter, c)\n      return [position, curve]\n    }\n  }\n\n  // Calculate the control/via points of a Bezier curve.\n  const [p1, p2] = LineUtils.toVectorsFromLinePosition(position)\n  const control = v2d\n    .calculateBezierCurveControlPoint(p1, center, p2, theta0)\n    .map(p => p.toObject())\n\n  curve = {\n    center: shiftedCenter,\n    theta: theta0,\n    circle: { center, radius },\n    control,\n  }\n  return [position, curve]\n}\n\nfunction calculateArcPositionAndState(\n  nodePos: Position,\n  nodeShape: ShapeStyle,\n  selfLoopStyle: SelfLoopEdgeStyle,\n  isStartEdgeOfNode: boolean,\n  sourceMargin: number,\n  targetMargin: number,\n  pointInGroup: number,\n  scale: number\n): [LinePosition, EdgeModel.Arc] {\n  const s = scale\n\n  // calculate the center position of the Arc\n  const radius = (selfLoopStyle.radius + pointInGroup / 2) * s\n  const d = selfLoopStyle.offset * s + radius\n  const rad = (selfLoopStyle.angle - 90) * (Math.PI / 180)\n  const center = Vector2D.fromObject({\n    x: nodePos.x + d * Math.cos(rad),\n    y: nodePos.y + d * Math.sin(rad),\n  })\n\n  const isClockwise = selfLoopStyle.isClockwise\n\n  let p1: Point2D | undefined, p2: Point2D | undefined\n  if (isStartEdgeOfNode) {\n    const intersects = PointUtils.getIntersectionOfCircles(\n      center,\n      radius,\n      Vector2D.fromObject(nodePos),\n      NodeUtils.getNodeRadius(nodeShape) * s\n    )\n    if (intersects) {\n      [p1, p2] = intersects\n      let direction = 1\n      if (!isClockwise) {\n        [p1, p2] = [p2, p1]\n        direction = -1\n      }\n      if (sourceMargin !== 0 || targetMargin !== 0) {\n        const sourceMoveRad = ((sourceMargin * s) / radius) * direction\n        const targetMoveRad = ((targetMargin * s) / radius) * direction\n        p1 = v2d.moveOnCircumference(p1, center, sourceMoveRad)\n        p2 = v2d.moveOnCircumference(p2, center, -targetMoveRad)\n      }\n    }\n  }\n  if (p1 === undefined || p2 === undefined) {\n    const radiusLine = Vector2D.fromObject(nodePos)\n      .subtract(center)\n      .normalize()\n      .multiplyScalar(radius)\n    let rad = 1 * (Math.PI / 180)\n    if (!isClockwise) rad *= -1\n    p1 = center.clone().add(V2D.rotate(radiusLine, rad))\n    p2 = center.clone().add(V2D.rotate(radiusLine, -rad))\n  }\n  const a1 = Vector2D.fromObject(p1).subtract(center).angleDegree()\n  const a2 = Vector2D.fromObject(p2).subtract(center).angleDegree()\n  const angle = (a2 + 360 - a1) % 360\n\n  const isLargeArc = angle >= 180 ? true : false\n  return [\n    { p1, p2 },\n    {\n      center,\n      radius: [radius, radius],\n      isLargeArc: isClockwise ? isLargeArc : !isLargeArc,\n      isClockwise,\n    },\n  ]\n}\n\nfunction createSummarizedEdgeStates(\n  summarizedEdgeStates: EdgeModel.SummarizedEdgeStates,\n  edgeGroupStates: Reactive<EdgeModel.EdgeGroupStates>,\n  configs: Configs\n) {\n  const groups = edgeGroupStates.edgeGroups\n  Object.entries(groups)\n    .filter(([id, group]) => group.summarize && !(id in summarizedEdgeStates))\n    .forEach(([id, group]) => {\n      const state = { stroke: undefined as any }\n      state.stroke = computed<StrokeStyle>(() =>\n        Config.values(configs.edge.summarized.stroke, group.edges)\n      )\n      summarizedEdgeStates[id] = state\n    })\n  Object.keys(summarizedEdgeStates).forEach(id => {\n    if (!edgeGroupStates.edgeGroups[id]?.summarize) {\n      delete summarizedEdgeStates[id]\n    }\n  })\n}\n\nfunction toEdgeObjects(path: Path, edges: InputObjects<Edges>) {\n  return path.edges\n    .map(edgeId => ({ edgeId, edge: edges.objects.value[edgeId] }))\n    .filter(e => e.edge)\n}\n","\nexport class MapUtil {\n  static valueOf<K, V>(map: Map<K, V>) {\n    return Array.from(map.values())\n  }\n}\n","import { Ref } from \"vue\"\nimport { Position, ViewMode } from \"@/common/types\"\n\nconst MOUSE_MOVE_DETECTION_THRESHOLD = 3 // Sensitivity to start dragging\nconst TOUCH_MOVE_DETECTION_THRESHOLD = 6 // Sensitivity to start dragging in touches\nexport const DOUBLE_CLICK_THRESHOLD = 500\n\nexport type SelectionMode = \"container\" | \"node\" | \"edge\" | \"path\"\n\n// state for each pointer of multi touch\nexport interface NodePointerState {\n  pointerId: number // pointer ID provided by the event\n  nodeId: string // pointer down node ID\n  moveCounter: number // count for pointermove event occurred\n  dragBasePosition: Position // drag started position\n  nodeBasePosition: Position // node position at drag started\n  latestPosition: Position // latest position\n  eventTarget: EventTarget | null // event target\n}\n\nexport interface EdgePointerState {\n  pointerId: number // pointer ID provided by the event\n  id: string | string[] // pointer down edge ID\n  eventTarget: EventTarget | null // event target\n}\n\nexport interface PathPointerState {\n  pointerId: number // pointer ID provided by the event\n  id: string // pointer down path ID\n  eventTarget: EventTarget | null // event target\n}\n\nexport interface ClickState {\n  lastTime: number\n  count: number\n  id: string // clicked object ID\n}\n\nexport interface InteractionModes {\n  selectionMode: Ref<SelectionMode>\n  viewMode: Ref<ViewMode>\n}\n\nexport function getPointerMoveDetectionThreshold(type: string): number {\n  return type === \"touch\" ? TOUCH_MOVE_DETECTION_THRESHOLD : MOUSE_MOVE_DETECTION_THRESHOLD\n}\n\nexport function detectClicks(\n  clickStates: Map<number, ClickState>,\n  pointerId: number,\n  id: string,\n  event: MouseEvent,\n): [MouseEvent, MouseEvent | undefined] {\n  // search click states\n  let clickState = clickStates.get(pointerId)\n  if (clickState) {\n    if (clickState.id !== id) {\n      // click an other object\n      clickState = undefined\n    }\n  } else {\n    const idAndState = Array.from(clickStates.entries()).find(([_, state]) => state.id === id)\n    if (idAndState) {\n      const [oldPointerId, state] = idAndState\n      clickStates.delete(oldPointerId)\n      clickState = state\n    }\n  }\n\n  let clickEvent: MouseEvent, doubleClickEvent: MouseEvent | undefined\n  [clickState, clickEvent, doubleClickEvent] = createClickEvents(clickState, event, id)\n\n  // update\n  clickStates.set(pointerId, clickState)\n\n  return [ clickEvent, doubleClickEvent ]\n}\n\nexport function createClickEvents(\n  clickState: ClickState | undefined,\n  event: MouseEvent,\n  id: string\n): [ClickState, MouseEvent, MouseEvent | undefined] {\n  const now = Date.now()\n  if (clickState && now - clickState.lastTime <= DOUBLE_CLICK_THRESHOLD) {\n    // continuous clicked\n    clickState.count++\n    clickState.lastTime = now\n  } else {\n    // single clicked\n    clickState = { count: 1, lastTime: now, id }\n  }\n\n  const initDict = {\n    view: window,\n    screenX: event.screenX,\n    screenY: event.screenY,\n    clientX: event.clientX,\n    clientY: event.clientY,\n    ctrlKey: event.ctrlKey,\n    shiftKey: event.shiftKey,\n    altKey: event.altKey,\n    metaKey: event.metaKey,\n    button: event.button,\n    buttons: event.buttons,\n    detail: clickState.count,\n  }\n\n  let clickEvent: MouseEvent\n  let doubleClickEvent: MouseEvent | undefined = undefined\n  if (event instanceof PointerEvent) {\n    Object.assign(initDict, {\n      pointerId: event.pointerId,\n      width: event.width,\n      height: event.height,\n      pressure: event.pressure,\n      tangentialPressure: event.tangentialPressure,\n      tiltX: event.tiltX,\n      tiltY: event.tiltY,\n      twist: event.twist,\n      pointerType: event.pointerType,\n      isPrimary: event.isPrimary,\n    })\n    clickEvent = new PointerEvent(\"click\", initDict)\n    if (clickState.count === 2) {\n      doubleClickEvent = new PointerEvent(\"dblclick\", initDict)\n    }\n  } else {\n    clickEvent = new MouseEvent(\"click\", initDict)\n    if (clickState.count === 2) {\n      doubleClickEvent = new MouseEvent(\"dblclick\", initDict)\n    }\n  }\n\n  return [clickState, clickEvent, doubleClickEvent]\n}\n\nexport function cleanClickState(states: Map<number, ClickState>) {\n  const now = Date.now()\n  Array.from(states.entries())\n    .filter(([_, state]) => now - state.lastTime > DOUBLE_CLICK_THRESHOLD)\n    .map(([pointerId, _]) => states.delete(pointerId))\n}\n","import { watch } from \"vue\"\nimport { Emitter } from \"mitt\"\nimport { Reactive, ReadonlyRef } from \"@/common/common\"\nimport { Events, Layouts, NodePositions, Position } from \"@/common/types\"\nimport { NodeStates } from \"@/models/node\"\nimport { entriesOf } from \"@/utils/object\"\nimport { MapUtil } from \"@/utils/map\"\nimport {\n  cleanClickState,\n  ClickState,\n  detectClicks,\n  getPointerMoveDetectionThreshold,\n  InteractionModes,\n  NodePointerState,\n} from \"./core\"\n\ntype PointerPosition = Pick<PointerEvent, \"pageX\" | \"pageY\" | \"pointerId\">\n\ninterface NodeInteractionState {\n  pointers: Map<number, NodePointerState> // <PointerId, ...>\n  follow: {\n    followedPointerId: number\n    nodeBasePositions: { [name: string]: Position }\n  }\n  hoveredNodesPre: Set<string> // to keep the hover state while dragging\n  clicks: Map<number, ClickState> // <PointerId, ...>\n}\n\nexport function makeNodeInteractionHandlers(\n  nodeStates: NodeStates,\n  layouts: Readonly<Layouts>,\n  modes: InteractionModes,\n  hoveredNodes: Reactive<Set<string>>,\n  selectedNodes: Reactive<Set<string>>,\n  zoomLevel: ReadonlyRef<number>,\n  emitter: Emitter<Events>\n) {\n  const state: NodeInteractionState = {\n    pointers: new Map(),\n    follow: {\n      followedPointerId: -1,\n      nodeBasePositions: {},\n    },\n    hoveredNodesPre: new Set(),\n    clicks: new Map(),\n  }\n\n  const nodePointerHandlers = {\n    pointermove: handleNodePointerMoveEvent,\n    pointerup: handleNodePointerUpEvent,\n    pointercancel: handleNodePointerCancelEvent,\n  }\n\n  function _updateFollowNodes(pointerState: NodePointerState) {\n    const isFollowed = state.follow.followedPointerId === pointerState.pointerId\n    const isSelectedNode = selectedNodes.has(pointerState.nodeId)\n\n    const removed = !(pointerState.pointerId in state.pointers)\n    if ((isFollowed && removed) || (isFollowed && !isSelectedNode)) {\n      // selected => unselected\n      const candidate = MapUtil.valueOf(state.pointers).find(p => selectedNodes.has(p.nodeId))\n      if (!candidate) {\n        state.follow = { followedPointerId: -1, nodeBasePositions: {} }\n        return\n      }\n      pointerState = candidate\n      state.follow.followedPointerId = pointerState.pointerId\n    } else {\n      const followed = state.pointers.get(state.follow.followedPointerId)\n      if (!followed) {\n        state.follow = { followedPointerId: -1, nodeBasePositions: {} }\n        return\n      }\n      pointerState = followed\n    }\n\n    if (isFollowed || isSelectedNode) {\n      // reset state for following:\n      // followed by selected nodes without user grabs\n      const userGrabs = MapUtil.valueOf(state.pointers).map(n => n.nodeId)\n      state.follow.nodeBasePositions = Object.fromEntries(\n        Array.from(selectedNodes)\n          .filter(n => !userGrabs.includes(n))\n          .filter(n => nodeStates[n]?.draggable)\n          .map(n => [n, _unwrapNodePosition(layouts.nodes, n)])\n      )\n      pointerState.dragBasePosition = { ...pointerState.latestPosition }\n      pointerState.nodeBasePosition = _unwrapNodePosition(layouts.nodes, pointerState.nodeId)\n    }\n  }\n\n  watch(selectedNodes, selected => {\n    const pointerState = state.pointers.get(state.follow.followedPointerId)\n    if (pointerState) {\n      _updateFollowNodes(pointerState)\n    }\n    if (selected.size > 0 && modes.selectionMode.value !== \"node\") {\n      modes.selectionMode.value = \"node\"\n    } else if (selected.size === 0 && modes.selectionMode.value === \"node\") {\n      modes.selectionMode.value = \"container\"\n    }\n  })\n\n  watch(modes.selectionMode, mode => {\n    if (mode !== \"node\") {\n      selectedNodes.clear()\n    }\n  })\n\n  function _calculateNodeNewPosition(pointerState: NodePointerState, event: PointerPosition) {\n    const dx = pointerState.dragBasePosition.x - event.pageX\n    const dy = pointerState.dragBasePosition.y - event.pageY\n    const positions =\n      state.follow.followedPointerId == pointerState.pointerId\n        ? {\n            [pointerState.nodeId]: pointerState.nodeBasePosition,\n            ...state.follow.nodeBasePositions,\n          }\n        : { [pointerState.nodeId]: pointerState.nodeBasePosition }\n    const z = zoomLevel.value\n\n    return Object.fromEntries(\n      Object.entries(positions).map(([node, pos]) => [\n        node,\n        {\n          x: pos.x - dx / z,\n          y: pos.y - dy / z,\n        },\n      ])\n    )\n  }\n\n  function handleNodeClickEvent(node: string, event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    // When a finger is placed on any object and another object is tapped,\n    // no click event is fired. Thus, click events are emulated by using\n    // pointerdown/up. The following is processing for emulated events only.\n\n    if (event.shiftKey && ![\"container\", \"node\"].includes(modes.selectionMode.value)) {\n      return\n    }\n    modes.selectionMode.value = \"node\"\n\n    const selectable = nodeStates[node]?.selectable ?? false\n    if (selectable) {\n      const isTouchAnySelectedNode =\n        MapUtil.valueOf(state.pointers).filter(p => selectedNodes.has(p.nodeId)).length > 0\n      if (event.shiftKey || isTouchAnySelectedNode) {\n        // select multiple nodes\n        if (selectedNodes.has(node)) {\n          selectedNodes.delete(node)\n        } else if (!(typeof selectable === \"number\" && selectedNodes.size >= selectable)) {\n          selectedNodes.add(node)\n        }\n      } else if (!selectedNodes.has(node)) {\n        // make the selectedNodes the clicked one\n        selectedNodes.clear()\n        selectedNodes.add(node)\n      }\n    }\n    emitter.emit(\"node:click\", { node, event })\n  }\n\n  function handleNodeDoubleClickEvent(node: string, event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    emitter.emit(\"node:dblclick\", { node, event })\n  }\n\n  function handleNodePointerMoveEvent(event: PointerEvent) {\n    event.stopPropagation()\n\n    const pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n    pointerState.latestPosition = { x: event.pageX, y: event.pageY }\n    pointerState.moveCounter++\n\n    const threshold = getPointerMoveDetectionThreshold(event.pointerType)\n    if (pointerState.moveCounter <= threshold) {\n      return // pending for click and drag distinguish\n    }\n\n    if (!nodeStates[pointerState.nodeId]?.draggable) {\n      return\n    }\n\n    if (pointerState.moveCounter === threshold + 1) {\n      const draggingNodes = _calculateNodeNewPosition(pointerState, {\n        pointerId: pointerState.pointerId,\n        pageX: pointerState.dragBasePosition.x,\n        pageY: pointerState.dragBasePosition.y,\n      })\n      emitter.emit(\"node:dragstart\", draggingNodes)\n    }\n    const draggingNodes = _calculateNodeNewPosition(pointerState, event)\n    emitter.emit(\"node:pointermove\", draggingNodes)\n  }\n\n  function handleNodePointerCancelEvent(event: PointerEvent) {\n    event.stopPropagation()\n\n    let pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n\n    for (pointerState of state.pointers.values()) {\n      const node = pointerState.nodeId\n\n      const threshold = getPointerMoveDetectionThreshold(event.pointerType)\n      const isMoved = pointerState.moveCounter > threshold\n      if (isMoved) {\n        // pageX/Y in cancel event are zero => use latest position\n        const draggingNodes = _calculateNodeNewPosition(pointerState, {\n          pointerId: pointerState.pointerId,\n          pageX: pointerState.latestPosition.x,\n          pageY: pointerState.latestPosition.y,\n        })\n        emitter.emit(\"node:dragend\", draggingNodes)\n      }\n      emitter.emit(\"node:pointerup\", { node, event })\n    }\n\n    // reset state\n    state.pointers.clear()\n    state.follow = { followedPointerId: -1, nodeBasePositions: {} }\n    entriesOf(nodePointerHandlers).forEach(([ev, handler]) => {\n      document.removeEventListener(ev, handler)\n    })\n    modes.viewMode.value = \"default\"\n  }\n\n  function handleNodePointerUpEvent(event: PointerEvent) {\n    event.stopPropagation()\n\n    const pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n\n    state.pointers.delete(event.pointerId)\n\n    const node = pointerState.nodeId\n\n    const threshold = getPointerMoveDetectionThreshold(event.pointerType)\n    const isMoved = pointerState.moveCounter > threshold\n    if (isMoved) {\n      if (nodeStates[pointerState.nodeId]?.draggable) {\n        const draggingNodes = _calculateNodeNewPosition(pointerState, event)\n        emitter.emit(\"node:dragend\", draggingNodes)\n        emitter.emit(\"node:pointerup\", { node, event })\n      }\n    } else {\n      emitter.emit(\"node:pointerup\", { node, event })\n    }\n\n    if (!isMoved /* Don't fire the click event if the node is being dragged */) {\n      // click handling\n      const [clickEvent, doubleClickEvent] = detectClicks(\n        state.clicks,\n        pointerState.pointerId,\n        node,\n        event\n      )\n      pointerState.eventTarget?.dispatchEvent(clickEvent)\n      if (doubleClickEvent) {\n        pointerState.eventTarget?.dispatchEvent(doubleClickEvent)\n      }\n    }\n\n    if (state.pointers.size === 0) {\n      // re-initialize state\n      state.follow = { followedPointerId: -1, nodeBasePositions: {} }\n      entriesOf(nodePointerHandlers).forEach(([ev, handler]) => {\n        document.removeEventListener(ev, handler)\n      })\n      cleanClickState(state.clicks)\n      modes.viewMode.value = \"default\"\n    } else {\n      _updateFollowNodes(pointerState)\n    }\n\n    // reflect changes while dragging.\n    hoveredNodes.clear()\n    state.hoveredNodesPre.forEach(hoveredNodes.add, hoveredNodes)\n  }\n\n  function handleNodePointerDownEvent(node: string, event: PointerEvent) {\n    if (event.button == 2 /* right button */) {\n      return\n    }\n    event.stopPropagation()\n\n    if (![\"default\", \"node\"].includes(modes.viewMode.value)) {\n      return\n    }\n\n    if (state.pointers.size == 0) {\n      // Add event listeners\n      modes.viewMode.value = \"node\"\n      entriesOf(nodePointerHandlers).forEach(([ev, handler]) => {\n        document.addEventListener(ev, handler)\n      })\n    }\n\n    // Create new pointer state\n    const pointerState: NodePointerState = {\n      pointerId: event.pointerId,\n      nodeId: node,\n      moveCounter: 0,\n      nodeBasePosition: _unwrapNodePosition(layouts.nodes, node),\n      dragBasePosition: { x: event.pageX, y: event.pageY },\n      latestPosition: { x: event.pageX, y: event.pageY },\n      eventTarget: event.currentTarget,\n    }\n    state.pointers.set(event.pointerId, pointerState)\n\n    if (selectedNodes.has(node)) {\n      if (state.follow.followedPointerId < 0) {\n        // pointer followed by selected nodes\n        state.follow.followedPointerId = event.pointerId\n        _updateFollowNodes(pointerState)\n      } else {\n        // current pointer is in charge of this node.\n        // do not follow another node anymore.\n        delete state.follow.nodeBasePositions[pointerState.nodeId]\n      }\n    }\n\n    emitter.emit(\"node:pointerdown\", { node, event })\n  }\n\n  function handleNodePointerOverEvent(node: string, event: PointerEvent) {\n    state.hoveredNodesPre.add(node)\n    if (state.pointers.size > 0) {\n      return // dragging\n    }\n    hoveredNodes.add(node)\n    emitter.emit(\"node:pointerover\", { node, event })\n  }\n\n  function handleNodePointerOutEvent(node: string, event: PointerEvent) {\n    state.hoveredNodesPre.delete(node)\n    if (state.pointers.size > 0) {\n      return // dragging\n    }\n    hoveredNodes.delete(node)\n    emitter.emit(\"node:pointerout\", { node, event })\n  }\n\n  function handleNodeContextMenu(node: string, event: MouseEvent) {\n    event.stopPropagation()\n    emitter.emit(\"node:contextmenu\", { node, event })\n  }\n\n  return {\n    handleNodePointerDownEvent,\n    handleNodePointerOverEvent,\n    handleNodePointerOutEvent,\n    handleNodeClickEvent,\n    handleNodeDoubleClickEvent,\n    handleNodeContextMenu,\n  }\n}\n\nfunction _unwrapNodePosition(nodes: Readonly<NodePositions>, node: string) {\n  const pos = nodes[node] ?? { x: 0, y: 0 }\n  return { ...pos } // unwrap reactivity\n}\n","import { watch } from \"vue\"\nimport { Emitter } from \"mitt\"\nimport { Reactive } from \"@/common/common\"\nimport { Events, EdgeEvent } from \"@/common/types\"\nimport { EdgeStates } from \"@/models/edge\"\nimport { entriesOf } from \"@/utils/object\"\nimport { MapUtil } from \"@/utils/map\"\nimport {\n  cleanClickState,\n  ClickState,\n  detectClicks,\n  EdgePointerState,\n  InteractionModes,\n} from \"./core\"\n\nexport function makeEdgeInteractionHandlers(\n  edgeStates: EdgeStates,\n  modes: InteractionModes,\n  hoveredEdges: Reactive<Set<string>>,\n  selectedEdges: Reactive<Set<string>>,\n  emitter: Emitter<Events>\n) {\n  const state = {\n    pointers: new Map<number, EdgePointerState>(), // <PointerId, ...>\n    pointerPeekCount: 0,\n    clicks: new Map<number, ClickState>(),\n  }\n\n  const edgePointerHandlers = {\n    pointerup: handleEdgePointerUpEvent,\n    pointercancel: handleEdgePointerCancelEvent,\n  }\n\n  watch(selectedEdges, selected => {\n    if (selected.size > 0 && modes.selectionMode.value !== \"edge\") {\n      modes.selectionMode.value = \"edge\"\n    } else if (selected.size === 0 && modes.selectionMode.value === \"edge\") {\n      modes.selectionMode.value = \"container\"\n    }\n  })\n\n  watch(modes.selectionMode, mode => {\n    if (mode !== \"edge\") {\n      selectedEdges.clear()\n    }\n  })\n\n  function handleEdgePointerDownEvent(edge: string, event: PointerEvent) {\n    if (event.button == 2 /* right button */) {\n      return\n    }\n    event.stopPropagation()\n\n    if (![\"default\", \"edge\"].includes(modes.viewMode.value)) {\n      return\n    }\n\n    if (state.pointers.size == 0) {\n      // Add event listeners\n      modes.viewMode.value = \"edge\"\n      entriesOf(edgePointerHandlers).forEach(([ev, handler]) => {\n        document.addEventListener(ev, handler)\n      })\n      state.pointerPeekCount = 0\n    }\n\n    state.pointerPeekCount++\n\n    // Create new pointer state\n    const pointerState: EdgePointerState = {\n      pointerId: event.pointerId,\n      id: edge,\n      eventTarget: event.currentTarget,\n    }\n    state.pointers.set(event.pointerId, pointerState)\n\n    emitter.emit(\"edge:pointerdown\", _makeEdgeEventObject(edge, event))\n  }\n\n  function handleEdgePointerUpEvent(event: PointerEvent) {\n    event.stopPropagation()\n\n    const pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n\n    state.pointers.delete(event.pointerId)\n\n    const edge = pointerState.id\n    emitter.emit(\"edge:pointerup\", _makeEdgeEventObject(edge, event))\n\n    // click handling\n    const [clickEvent, doubleClickEvent] = detectClicks(\n      state.clicks,\n      pointerState.pointerId,\n      edge instanceof Array ? edge.join(\",\") : edge,\n      event,\n    )\n    pointerState.eventTarget?.dispatchEvent(clickEvent)\n    if (doubleClickEvent) {\n      pointerState.eventTarget?.dispatchEvent(doubleClickEvent)\n    }\n\n    if (state.pointers.size === 0) {\n      // reset state\n      state.pointerPeekCount = 0\n      entriesOf(edgePointerHandlers).forEach(([ev, handler]) => {\n        document.removeEventListener(ev, handler)\n      })\n      cleanClickState(state.clicks)\n      modes.viewMode.value = \"default\"\n    }\n  }\n\n  function handleEdgePointerCancelEvent(event: PointerEvent) {\n    event.stopPropagation()\n\n    const pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n\n    for (const pointerState of state.pointers.values()) {\n      const edge = pointerState.id\n      emitter.emit(\"edge:pointerup\", _makeEdgeEventObject(edge, event))\n    }\n\n    // reset state\n    state.pointers.clear()\n    state.pointerPeekCount = 0\n    entriesOf(edgePointerHandlers).forEach(([ev, handler]) => {\n      document.removeEventListener(ev, handler)\n    })\n    emitter.emit(\"view:mode\", \"default\")\n  }\n\n  function handleEdgeClickEvent(edge: string | string[], event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    // When a finger is placed on any object and another object is tapped,\n    // no click event is fired. Thus, click events are emulated by using\n    // pointerdown/up. The following is processing for emulated events only.\n\n    if (event.shiftKey && ![\"container\", \"edge\"].includes(modes.selectionMode.value)) {\n      return\n    }\n    modes.selectionMode.value = \"edge\"\n\n    const edges = edge instanceof Array ? edge : [edge]\n\n    const isTouchAnySelectedEdge =\n      MapUtil.valueOf(state.pointers).filter(p => {\n        const edges = p.id instanceof Array ? p.id : [p.id]\n        return edges.every(edge => selectedEdges.has(edge))\n      }).length > 0\n\n    if (edge instanceof Array) {\n      // select only selectable edge\n      const selectableEdges = edges.find(edge => edgeStates[edge]?.selectable)\n      if (selectableEdges) {\n        if (event.shiftKey || isTouchAnySelectedEdge) {\n          if (edges.some(edge => selectedEdges.has(edge))) {\n            edges.forEach(edge => selectedEdges.delete(edge))\n          } else {\n            edges.forEach(edge => {\n              const selectable = edgeStates[edge]?.selectable\n              if (!(typeof selectable === \"number\" && selectedEdges.size >= selectable)) {\n                selectedEdges.add(edge)\n              }\n            })\n          }\n        } else {\n          // make the selectedEdges the clicked summarized one\n          selectedEdges.clear()\n          edges.forEach(edge => selectedEdges.add(edge))\n        }\n      }\n    } else {\n      const selectable = edgeStates[edge]?.selectable\n      if (selectable) {\n        if (event.shiftKey || isTouchAnySelectedEdge) {\n          if (selectedEdges.has(edge)) {\n            selectedEdges.delete(edge)\n          } else if (!(typeof selectable === \"number\" && selectedEdges.size >= selectable)) {\n            selectedEdges.add(edge)\n          }\n        } else if (!selectedEdges.has(edge)) {\n          // make the selectedEdges the clicked one\n          selectedEdges.clear()\n          selectedEdges.add(edge)\n        }\n      }\n    }\n    emitter.emit(\"edge:click\", _makeEdgeEventObject(edge, event))\n  }\n\n  function handleEdgeDoubleClickEvent(edge: string | string[], event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    emitter.emit(\"edge:dblclick\", _makeEdgeEventObject(edge, event))\n  }\n\n  function handleEdgePointerOverEvent(edge: string, event: PointerEvent) {\n    hoveredEdges.add(edge)\n    emitter.emit(\"edge:pointerover\", _makeEdgeEventObject(edge, event))\n  }\n\n  function handleEdgePointerOutEvent(edge: string, event: PointerEvent) {\n    hoveredEdges.delete(edge)\n    emitter.emit(\"edge:pointerout\", _makeEdgeEventObject(edge, event))\n  }\n\n  function handleEdgeContextMenu(edge: string, event: MouseEvent) {\n    event.stopPropagation()\n    emitter.emit(\"edge:contextmenu\", _makeEdgeEventObject(edge, event))\n  }\n\n  function handleEdgesPointerDownEvent(edges: string[], event: PointerEvent) {\n    if (event.button == 2 /* right button */) {\n      return\n    }\n    event.stopPropagation()\n\n    if (![\"default\", \"edge\"].includes(modes.viewMode.value)) {\n      return\n    }\n\n    if (state.pointers.size == 0) {\n      // Add event listeners\n      modes.viewMode.value = \"edge\"\n      entriesOf(edgePointerHandlers).forEach(([ev, handler]) => {\n        document.addEventListener(ev, handler)\n      })\n      state.pointerPeekCount = 0\n    }\n\n    state.pointerPeekCount++\n\n    // Create new pointer state\n    const pointerState: EdgePointerState = {\n      pointerId: event.pointerId,\n      id: edges,\n      eventTarget: event.currentTarget,\n    }\n    state.pointers.set(event.pointerId, pointerState)\n    emitter.emit(\"edge:pointerdown\", _makeEdgeEventObject(edges, event))\n  }\n\n  function handleEdgesPointerOverEvent(edges: string[], event: PointerEvent) {\n    edges.forEach(edge => hoveredEdges.add(edge))\n    emitter.emit(\"edge:pointerover\", _makeEdgeEventObject(edges, event))\n  }\n\n  function handleEdgesPointerOutEvent(edges: string[], event: PointerEvent) {\n    edges.forEach(edge => hoveredEdges.delete(edge))\n    emitter.emit(\"edge:pointerout\", _makeEdgeEventObject(edges, event))\n  }\n\n  function handleEdgesClickEvent(edges: string[], event: MouseEvent) {\n    handleEdgeClickEvent(edges, event)\n  }\n\n  function handleEdgesDoubleClickEvent(edges: string[], event: MouseEvent) {\n    handleEdgeDoubleClickEvent(edges, event)\n  }\n\n  function handleEdgesContextMenu(edges: string[], event: MouseEvent) {\n    event.stopPropagation()\n    emitter.emit(\"edge:contextmenu\", _makeEdgeEventObject(edges, event))\n  }\n\n  return {\n    handleEdgePointerDownEvent,\n    handleEdgePointerOverEvent,\n    handleEdgePointerOutEvent,\n    handleEdgeClickEvent,\n    handleEdgeDoubleClickEvent,\n    handleEdgeContextMenu,\n    handleEdgesPointerDownEvent,\n    handleEdgesPointerOverEvent,\n    handleEdgesPointerOutEvent,\n    handleEdgesClickEvent,\n    handleEdgesDoubleClickEvent,\n    handleEdgesContextMenu,\n  }\n}\n\nfunction _makeEdgeEventObject<T extends Event>(edge: string | string[], event: T): EdgeEvent<T> {\n  if (edge instanceof Array) {\n    return {\n      edges: edge,\n      event,\n      summarized: true,\n    }\n  } else {\n    return {\n      edge,\n      edges: [edge],\n      event,\n      summarized: false,\n    }\n  }\n}\n","import { onMounted, onUnmounted, Ref, watch } from \"vue\"\nimport { Emitter } from \"mitt\"\nimport { Events } from \"@/common/types\"\nimport { entriesOf } from \"@/utils/object\"\nimport {\n  ClickState,\n  createClickEvents,\n  getPointerMoveDetectionThreshold,\n  InteractionModes,\n} from \"./core\"\n\nexport function setupContainerInteractionHandlers(\n  container: Ref<SVGElement | undefined>,\n  modes: InteractionModes,\n  isSvgWheelZoomEnabled: Ref<boolean>,\n  emitter: Emitter<Events>\n) {\n  const state = {\n    moveCounter: 0,\n    pointerCounter: 0,\n    clickState: undefined as ClickState | undefined,\n  }\n\n  // measure the number of move events in the pointerdown state\n  // and use it to determine the click when pointerup.\n  const containerPointerHandlers = {\n    pointermove: handleContainerPointerMoveEvent,\n    pointerup: handleContainerPointerUpEvent,\n    pointercancel: handleContainerPointerUpEvent,\n  }\n\n  function handleContainerPointerDownEvent(_: PointerEvent) {\n    state.moveCounter = 0\n    if (state.pointerCounter === 0) {\n      // Add to event listener\n      entriesOf(containerPointerHandlers).forEach(([ev, handler]) => {\n        document.addEventListener(ev, handler, { passive: true })\n      })\n    }\n    state.pointerCounter++\n  }\n\n  function handleContainerPointerMoveEvent(_: PointerEvent) {\n    state.moveCounter++\n  }\n\n  function handleContainerPointerUpEvent(event: PointerEvent) {\n    state.pointerCounter--\n    if (state.pointerCounter <= 0) {\n      state.pointerCounter = 0\n      // Remove from event listener\n      entriesOf(containerPointerHandlers).forEach(([ev, handler]) => {\n        document.removeEventListener(ev, handler)\n      })\n      const threshold = getPointerMoveDetectionThreshold(event.pointerType)\n      if (state.moveCounter <= threshold) {\n        // Click container (without mouse move)\n        if (event.shiftKey && modes.selectionMode.value !== \"container\") {\n          return\n        }\n        modes.selectionMode.value = \"container\"\n\n        // click handling\n        const [clickState, clickEvent, doubleClickEvent] = createClickEvents(\n          state.clickState,\n          event,\n          \"view\"\n        )\n        state.clickState = clickState\n        container.value!.dispatchEvent(clickEvent)\n        if (doubleClickEvent) {\n          container.value!.dispatchEvent(doubleClickEvent)\n        }\n      }\n    }\n  }\n\n  function handleContainerClickEvent(event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    // When a finger is placed on any object and another object is tapped,\n    // no click event is fired. Thus, click events are emulated by using\n    // pointerdown/up. The following is processing for emulated events only.\n    event.stopPropagation()\n    emitter.emit(\"view:click\", { event })\n  }\n\n  function handleContainerDoubleClickEvent(event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    event.stopPropagation()\n    emitter.emit(\"view:dblclick\", { event })\n  }\n\n  function handleContainerContextMenuEvent(event: MouseEvent) {\n    emitter.emit(\"view:contextmenu\", { event })\n\n    if (state.pointerCounter > 0) {\n      // reset pointer down state\n      state.pointerCounter = 0\n      // Remove from event listener\n      entriesOf(containerPointerHandlers).forEach(([ev, handler]) => {\n        container.value?.removeEventListener(ev, handler)\n      })\n    }\n  }\n\n  const preventDefault = (e: MouseEvent) => {\n    e.preventDefault()\n  }\n\n  onMounted(() => {\n    const c = container.value\n    if (!c) return\n    c.addEventListener(\"pointerdown\", handleContainerPointerDownEvent, { passive: true })\n    c.addEventListener(\"click\", handleContainerClickEvent, { passive: false })\n    c.addEventListener(\"dblclick\", handleContainerDoubleClickEvent, { passive: false })\n    c.addEventListener(\"contextmenu\", handleContainerContextMenuEvent, { passive: false })\n    if (isSvgWheelZoomEnabled.value) {\n      c.addEventListener(\"wheel\", preventDefault, { passive: false })\n    }\n  })\n\n  onUnmounted(() => {\n    const c = container.value\n    if (!c) return\n    c.removeEventListener(\"pointerdown\", handleContainerPointerDownEvent)\n    c.removeEventListener(\"click\", handleContainerClickEvent)\n    c.removeEventListener(\"dblclick\", handleContainerDoubleClickEvent)\n    c.removeEventListener(\"contextmenu\", handleContainerContextMenuEvent)\n    if (isSvgWheelZoomEnabled.value) {\n      c.removeEventListener(\"wheel\", preventDefault)\n    }\n  })\n\n  watch(isSvgWheelZoomEnabled, (enabled, old) => {\n    const c = container.value\n    if (!c || enabled === old) return\n\n    if (enabled) {\n      c.addEventListener(\"wheel\", preventDefault, { passive: false })\n    } else {\n      c.removeEventListener(\"wheel\", preventDefault)\n    }\n  })\n}\n","import { Ref, watch } from \"vue\"\nimport { Reactive } from \"@/common/common\"\nimport { Events, PathEvent } from \"@/common/types\"\nimport { PathStates } from \"@/models/path\"\nimport {\n  cleanClickState,\n  ClickState,\n  detectClicks,\n  InteractionModes,\n  PathPointerState,\n} from \"./core\"\nimport { entriesOf } from \"@/utils/object\"\nimport { MapUtil } from \"@/utils/map\"\nimport { Emitter } from \"mitt\"\n\nexport function makePathInteractionHandlers(\n  pathStates: PathStates,\n  modes: InteractionModes,\n  hoveredPaths: Reactive<Set<string>>,\n  selectedPaths: Reactive<Set<string>>,\n  isInCompatibilityModeForPath: Ref<boolean>,\n  emitter: Emitter<Events>\n) {\n  const state = {\n    pointers: new Map<number, PathPointerState>(), // <PointerId, ...>\n    pointerPeekCount: 0,\n    clicks: new Map<number, ClickState>(),\n  }\n\n  function _makePathEventObject<T extends Event>(path: string, event: T): PathEvent<T> {\n    if (isInCompatibilityModeForPath.value) {\n      return { path: (pathStates[path]?.path ?? path) as any, event }\n    } else {\n      return { path, event }\n    }\n  }\n\n  const pathPointerHandlers = {\n    pointerup: handlePathPointerUpEvent,\n    pointercancel: handlePathPointerCancelEvent,\n  }\n\n  watch(selectedPaths, selected => {\n    if (selected.size > 0 && modes.selectionMode.value !== \"path\") {\n      modes.selectionMode.value = \"path\"\n    } else if (selected.size === 0 && modes.selectionMode.value === \"path\") {\n      modes.selectionMode.value = \"container\"\n    }\n  })\n\n  watch(modes.selectionMode, mode => {\n    if (mode !== \"path\") {\n      selectedPaths.clear()\n    }\n  })\n\n  function handlePathPointerDownEvent(path: string, event: PointerEvent) {\n    if (!pathStates[path]?.clickable) {\n      return\n    }\n\n    if (event.button == 2 /* right button */) {\n      return\n    }\n    event.stopPropagation()\n\n    if (![\"default\", \"path\"].includes(modes.viewMode.value)) {\n      return\n    }\n\n    if (state.pointers.size == 0) {\n      // Add event listeners\n      modes.viewMode.value = \"path\"\n      entriesOf(pathPointerHandlers).forEach(([ev, handler]) => {\n        document.addEventListener(ev, handler)\n      })\n      state.pointerPeekCount = 0\n    }\n\n    state.pointerPeekCount++\n\n    // Create new pointer state\n    const pointerState: PathPointerState = {\n      pointerId: event.pointerId,\n      id: path,\n      eventTarget: event.currentTarget,\n    }\n    state.pointers.set(event.pointerId, pointerState)\n\n    emitter.emit(\"path:pointerdown\", _makePathEventObject(path, event))\n  }\n\n  function handlePathPointerUpEvent(event: PointerEvent) {\n    const pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n\n    event.stopPropagation()\n\n    state.pointers.delete(event.pointerId)\n\n    const path = pointerState.id\n    emitter.emit(\"path:pointerup\", _makePathEventObject(path, event))\n\n    // click handling\n    const [clickEvent, doubleClickEvent] = detectClicks(\n      state.clicks,\n      pointerState.pointerId,\n      path,\n      event\n    )\n    pointerState.eventTarget?.dispatchEvent(clickEvent)\n    if (doubleClickEvent) {\n      pointerState.eventTarget?.dispatchEvent(doubleClickEvent)\n    }\n\n    if (state.pointers.size === 0) {\n      // reset state\n      state.pointerPeekCount = 0\n      entriesOf(pathPointerHandlers).forEach(([ev, handler]) => {\n        document.removeEventListener(ev, handler)\n      })\n      cleanClickState(state.clicks)\n      modes.viewMode.value = \"default\"\n    }\n  }\n\n  function handlePathPointerCancelEvent(event: PointerEvent) {\n    const pointerState = state.pointers.get(event.pointerId)\n    if (!pointerState) {\n      return\n    }\n\n    event.stopPropagation()\n\n    for (const pointerState of state.pointers.values()) {\n      const path = pointerState.id\n      emitter.emit(\"path:pointerup\", _makePathEventObject(path, event))\n    }\n\n    // reset state\n    state.pointers.clear()\n    state.pointerPeekCount = 0\n    entriesOf(pathPointerHandlers).forEach(([ev, handler]) => {\n      document.removeEventListener(ev, handler)\n    })\n    emitter.emit(\"view:mode\", \"default\")\n  }\n\n  function handlePathPointerOverEvent(path: string, event: PointerEvent) {\n    if (!pathStates[path]?.hoverable) {\n      return\n    }\n    hoveredPaths.add(path)\n    emitter.emit(\"path:pointerover\", _makePathEventObject(path, event))\n  }\n\n  function handlePathPointerOutEvent(path: string, event: PointerEvent) {\n    if (!pathStates[path]?.hoverable) {\n      return\n    }\n    hoveredPaths.delete(path)\n    emitter.emit(\"path:pointerout\", _makePathEventObject(path, event))\n  }\n\n  function handlePathClickEvent(path: string, event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    // When a finger is placed on any object and another object is tapped,\n    // no click event is fired. Thus, click events are emulated by using\n    // pointerdown/up. The following is processing for emulated events only.\n\n    if (!pathStates[path]?.clickable) {\n      return\n    }\n\n    if (event.shiftKey && ![\"container\", \"path\"].includes(modes.selectionMode.value)) {\n      return\n    }\n    modes.selectionMode.value = \"path\"\n\n    const selectable = pathStates[path]?.selectable ?? false\n    if (selectable) {\n      const isTouchAnySelectedPath =\n        MapUtil.valueOf(state.pointers).filter(p => selectedPaths.has(p.id)).length > 0\n      if (event.shiftKey || isTouchAnySelectedPath) {\n        // select multiple nodes\n        if (selectedPaths.has(path)) {\n          selectedPaths.delete(path)\n        } else if (!(typeof selectable === \"number\" && selectedPaths.size >= selectable)) {\n          selectedPaths.add(path)\n        }\n      } else if (!selectedPaths.has(path)) {\n        // make the selectedPaths the clicked one\n        selectedPaths.clear()\n        selectedPaths.add(path)\n      }\n    }\n    emitter.emit(\"path:click\", _makePathEventObject(path, event))\n  }\n\n  function handlePathDoubleClickEvent(path: string, event: MouseEvent) {\n    if (event.isTrusted) return // native event\n    if (!pathStates[path]?.clickable) {\n      return\n    }\n    emitter.emit(\"path:dblclick\", _makePathEventObject(path, event))\n  }\n\n  function handlePathContextMenu(path: string, event: MouseEvent) {\n    if (!pathStates[path]?.clickable) {\n      return\n    }\n    event.stopPropagation()\n    emitter.emit(\"path:contextmenu\", _makePathEventObject(path, event))\n  }\n\n  return {\n    handlePathPointerDownEvent,\n    handlePathPointerOverEvent,\n    handlePathPointerOutEvent,\n    handlePathClickEvent,\n    handlePathDoubleClickEvent,\n    handlePathContextMenu,\n  }\n}\n","\nexport async function urlContentToDataUrl(url: string) {\n  const response = await fetch(url)\n  const blob = await response.blob()\n  return new Promise<string>((onSuccess, onError) => {\n    try {\n      const reader = new FileReader()\n      reader.onload = function() { onSuccess(this.result as string) } ;\n      reader.readAsDataURL(blob) ;\n    } catch (e) {\n      onError(e)\n    }\n  });\n}\n","import { Point } from \"@/common/types\"\nimport { urlContentToDataUrl } from \"./download\"\n\nexport interface ExportOptions {\n  embedImages: boolean\n}\n\nexport function translateFromDomToSvgCoordinates(\n  svg: SVGSVGElement,\n  viewport: SVGGElement,\n  coordinates: Point\n): Point {\n  const point = svg.createSVGPoint()\n  point.x = coordinates.x\n  point.y = coordinates.y\n  const svgPoint = point.matrixTransform(viewport.getCTM()?.inverse())\n  return { x: svgPoint.x, y: svgPoint.y }\n}\n\nexport function translateFromSvgToDomCoordinates(\n  svg: SVGSVGElement,\n  viewport: SVGGElement,\n  coordinates: Point\n): Point {\n  const point = svg.createSVGPoint()\n  point.x = coordinates.x\n  point.y = coordinates.y\n  const domPoint = point.matrixTransform(viewport.getCTM() as DOMMatrixInit)\n  return { x: domPoint.x, y: domPoint.y }\n}\n\nexport function exportSvgElement(\n  element: SVGElement,\n  svgViewport: SVGGElement,\n  scale: number\n): SVGElement {\n  const target = element.cloneNode(true) as SVGElement\n\n  const box = svgViewport.getBBox()\n  const z = 1 / scale\n  const svgRect = {\n    x: Math.floor((box.x - 10) * z),\n    y: Math.floor((box.y - 10) * z),\n    width: Math.ceil((box.width + 20) * z),\n    height: Math.ceil((box.height + 20) * z),\n  }\n  target.setAttribute(\"width\", svgRect.width.toString())\n  target.setAttribute(\"height\", svgRect.height.toString())\n\n  const v = target.querySelector(\".v-ng-viewport\") as SVGGElement\n  v.setAttribute(\"transform\", `translate(${-svgRect.x} ${-svgRect.y}), scale(${z})`)\n  v.removeAttribute(\"style\")\n\n  target.setAttribute(\"viewBox\", `0 0 ${svgRect.width} ${svgRect.height}`)\n  target.removeAttribute(\"style\")\n\n  // remove comments\n  const iter = document.createNodeIterator(target, NodeFilter.SHOW_COMMENT)\n  while (iter.nextNode()) {\n    const commentNode = iter.referenceNode\n    commentNode.parentNode?.removeChild(commentNode)\n  }\n  return target\n}\n\nasync function replaceImageSourceToDataUrl(image: SVGImageElement) {\n  let useNS = false\n  let href = image.getAttribute(\"href\")\n  if (!href) {\n    useNS = true\n    href = image.getAttribute(\"xlink:href\")\n  }\n  if (!href || href.startsWith(\"data:\")) return\n\n  try {\n    const dataUrl = await urlContentToDataUrl(href)\n    image.setAttribute(useNS ? \"xlink:href\" : \"href\", dataUrl)\n  } catch (e) {\n    // output log and ignore\n    console.warn(\"Image download failed.\", href)\n    return\n  }\n}\n\nexport async function exportSvgElementWithOptions(\n  element: SVGElement,\n  svgViewport: SVGGElement,\n  scale: number,\n  options: Partial<ExportOptions> = {}\n): Promise<SVGElement> {\n  const target = exportSvgElement(element, svgViewport, scale)\n\n  if (options.embedImages) {\n    // replace image to data-uri\n    const images = Array.from(target.querySelectorAll(\"image\"))\n    const promises = images.map(img => replaceImageSourceToDataUrl(img))\n    await Promise.all(promises)\n  }\n\n  return target\n}\n","import { computed, onMounted, onUnmounted, ref, Ref, watch } from \"vue\"\nimport { debounce } from \"lodash-es\"\nimport { nonNull, Reactive } from \"@/common/common\"\nimport { Configs } from \"@/common/configs\"\nimport { Layouts, NodePositions, Point, Rectangle } from \"@/common/types\"\nimport { Vector2D } from \"@/modules/vector2d\"\nimport { NodeStates } from \"@/models/node\"\nimport { translateFromDomToSvgCoordinates } from \"@/utils/svg\"\nimport { InteractionModes } from \"./core\"\n\n// ------------------------------------------------------------------\n// Types\n// ------------------------------------------------------------------\n\nexport type StopTrigger = \"pointerup\" | \"click\" | \"manual\"\nexport type SelectionType = \"append\" | \"invert\"\n\nexport interface BoxSelectionOption {\n  stop: StopTrigger\n  type: SelectionType\n  withShiftKey: SelectionType | \"same\"\n}\n\n// ------------------------------------------------------------------\n// Export functions\n// ------------------------------------------------------------------\n\nexport function makeBoxSelectionMethods(\n  container: Ref<SVGElement | undefined>,\n  modes: InteractionModes,\n  layouts: Readonly<Layouts>,\n  nodeStates: NodeStates,\n  selectedNodes: Reactive<Set<string>>,\n  configs: Configs\n) {\n  const isBoxSelectionEnabled = computed(\n    () => !!configs.node.selectable && configs.view.boxSelectionEnabled\n  )\n  const isBoxSelectionMode = computed(() => modes.viewMode.value === \"box-selection\")\n\n  // ------------------------------------------------------------------\n  // States\n  // ------------------------------------------------------------------\n  const viewport = ref<SVGGElement>()\n  const selectionBox = ref<Rectangle>()\n  const states = {\n    pointers: new Set<number>(), // Set of pointers being pressed\n    points: new Map<number, Point>(), // Point indicated by each pointer\n    startPoint: null as Point | null, // Point where the drag started\n    selectedNodesAtSelectStarted: new Set<string>(), // Nodes selected at the start of the selection\n    selectionType: \"append\" as SelectionType, // Selection method for nodes included in the dragged range\n    options: {\n      // options specified by user at start of selection mode\n      stopTrigger: \"pointerup\" as StopTrigger,\n      selectionType: \"append\" as SelectionType,\n      selectionTypeWithShiftKey: \"same\" as SelectionType | \"same\",\n    },\n  }\n\n  // ------------------------------------------------------------------\n  // Private functions\n  // ------------------------------------------------------------------\n\n  const updateNodesSelection = debounce(\n    () => {\n      _updateNodesSelection(\n        nonNull(container.value, \"container\") as SVGSVGElement,\n        nonNull(viewport.value, \"viewport\"),\n        selectionBox,\n        layouts.nodes,\n        nodeStates,\n        selectedNodes,\n        states.selectedNodesAtSelectStarted,\n        states.selectionType\n      )\n    },\n    50,\n    { maxWait: 100 }\n  )\n\n  // ------------------------------------------------------------------\n  // Pointer event handlers\n  // ------------------------------------------------------------------\n  const pointerEventHandler = new PointerEventRegistrar(\n    container,\n    handlePointerDownEvent,\n    handlePointerUpEvent,\n    handlePointerMoveEvent,\n    handleClickEvent,\n    handleKeyDownEvent\n  )\n\n  function handleClickEvent(event: MouseEvent) {\n    if (states.options.stopTrigger !== \"click\") return\n    if (states.pointers.size > 0) return\n\n    const point = { x: event.offsetX, y: event.offsetY }\n    if (states.startPoint && Vector2D.fromObject(states.startPoint).distance(point) > 10) {\n      return // ignore in dragging\n    }\n    stopBoxSelection()\n  }\n\n  function handlePointerDownEvent(event: PointerEvent) {\n    event.stopPropagation()\n\n    const point = { x: event.offsetX, y: event.offsetY }\n    if (states.pointers.size === 0) {\n      states.startPoint = point\n\n      pointerEventHandler.activate()\n\n      states.selectedNodesAtSelectStarted.clear()\n      selectedNodes.forEach(nodeId => states.selectedNodesAtSelectStarted.add(nodeId))\n      if (states.options.selectionTypeWithShiftKey === \"same\") {\n        states.selectionType = states.options.selectionType\n      } else {\n        states.selectionType = event.shiftKey\n          ? states.options.selectionTypeWithShiftKey\n          : states.options.selectionType\n      }\n    }\n    if (!states.pointers.has(event.pointerId)) {\n      states.pointers.add(event.pointerId)\n    }\n    states.points.set(event.pointerId, point)\n    updateRectangle()\n  }\n\n  function handlePointerUpEvent(event: PointerEvent) {\n    states.pointers.delete(event.pointerId)\n    if (states.pointers.size === 1) {\n      const rect = nonNull(container.value).getBoundingClientRect()\n      const point = { x: event.x - rect.x, y: event.y - rect.y }\n      states.startPoint = point\n    } else if (states.pointers.size === 0) {\n      pointerEventHandler.deactivate()\n      if (states.options.stopTrigger === \"pointerup\") {\n        stopBoxSelection()\n      }\n      states.selectedNodesAtSelectStarted.clear()\n    }\n    updateRectangle()\n  }\n\n  function handlePointerMoveEvent(event: PointerEvent) {\n    const rect = nonNull(container.value).getBoundingClientRect()\n    const point = { x: event.x - rect.x, y: event.y - rect.y }\n    states.points.set(event.pointerId, point)\n    updateRectangle()\n    updateNodesSelection()\n  }\n\n  function handleKeyDownEvent(event: KeyboardEvent) {\n    if (event.key === \"Escape\" && states.options.stopTrigger !== \"manual\") {\n      event.stopPropagation()\n      stopBoxSelection()\n    }\n  }\n\n  function updateRectangle() {\n    let pos1: Point | undefined\n    let pos2: Point | undefined\n    const pointerArray = Array.from(states.pointers)\n    if (pointerArray.length >= 2) {\n      const first = pointerArray[0]\n      const last = pointerArray[pointerArray.length - 1]\n      pos1 = states.points.get(first)\n      pos2 = states.points.get(last)\n    } else if (states.startPoint && pointerArray.length === 1) {\n      const first = pointerArray[0]\n      pos1 = states.startPoint\n      pos2 = states.points.get(first)\n    } else {\n      pos1 = undefined\n      pos2 = undefined\n    }\n    if (pos1 && pos2) {\n      // calculate left top position and size\n      selectionBox.value = {\n        pos: {\n          x: Math.min(pos1.x, pos2.x),\n          y: Math.min(pos1.y, pos2.y),\n        },\n        size: {\n          width: Math.abs(pos2.x - pos1.x),\n          height: Math.abs(pos2.y - pos1.y),\n        },\n      }\n      if (selectionBox.value.size.width === 0) {\n        selectionBox.value.size.width = 1\n      }\n      if (selectionBox.value.size.height === 0) {\n        selectionBox.value.size.height = 1\n      }\n    } else if (selectionBox.value) {\n      selectionBox.value = undefined\n    }\n  }\n\n  // ------------------------------------------------------------------\n  // Ctrl/Cmd key box selection\n  // ------------------------------------------------------------------\n  const keyEventRegistrar = new KeyEventRegistrar(\n    container,\n    // key down\n    (event: KeyboardEvent) => {\n      if (!isBoxSelectionEnabled.value) return\n      if (configs.view.selection.detector(event)) {\n        startBoxSelection({\n          stop: \"manual\",\n          type: \"append\",\n          withShiftKey: \"invert\",\n        })\n        keyEventRegistrar.activate()\n      }\n    },\n    // key up\n    (event: KeyboardEvent) => {\n      if (!isBoxSelectionEnabled.value) return\n      if (configs.view.selection.detector(event)) {\n        if (states.pointers.size === 0) {\n          stopBoxSelection()\n        } else {\n          states.options.stopTrigger = \"pointerup\"\n        }\n        keyEventRegistrar.deactivate()\n      }\n    }\n  )\n\n  watch(isBoxSelectionEnabled, value => {\n    if (value) {\n      keyEventRegistrar.register()\n    } else {\n      keyEventRegistrar.unregister()\n    }\n  })\n\n  // ------------------------------------------------------------------\n  // Lifecycle process\n  // ------------------------------------------------------------------\n\n  onMounted(() => {\n    viewport.value = container.value?.querySelector(\".v-ng-viewport\") as SVGGElement\n    if (isBoxSelectionEnabled.value) {\n      keyEventRegistrar.register()\n    }\n  })\n\n  onUnmounted(() => {\n    stopBoxSelection()\n    if (isBoxSelectionEnabled.value) {\n      keyEventRegistrar.unregister()\n    }\n  })\n\n  // ------------------------------------------------------------------\n  // Expose functions\n  // ------------------------------------------------------------------\n\n  function startBoxSelection(options: Partial<BoxSelectionOption> = {}) {\n    // Even if it's already in selection mode, behavior changes are acceptable.\n    states.options = {\n      stopTrigger: options.stop ?? \"pointerup\",\n      selectionType: options.type ?? \"append\",\n      selectionTypeWithShiftKey: options.withShiftKey ?? \"same\",\n    }\n\n    if (modes.viewMode.value === \"box-selection\") return\n    modes.viewMode.value = \"box-selection\"\n\n    states.pointers.clear()\n    pointerEventHandler.register()\n  }\n\n  function stopBoxSelection() {\n    if (modes.viewMode.value !== \"box-selection\") return\n    modes.viewMode.value = \"default\"\n    pointerEventHandler.unregister()\n  }\n\n  return { isBoxSelectionMode, selectionBox, startBoxSelection, stopBoxSelection }\n}\n\n// ------------------------------------------------------------------\n// Package local functions\n// ------------------------------------------------------------------\n\nfunction _updateNodesSelection(\n  svg: SVGSVGElement,\n  viewport: SVGGElement,\n  selectionBox: Ref<Rectangle | undefined>,\n  nodePositions: Readonly<NodePositions>,\n  nodeStates: Readonly<NodeStates>,\n  selectedNodes: Reactive<Set<string>>,\n  selectedNodesAtSelectStarted: Set<string>,\n  selectionType: SelectionType\n) {\n  if (!selectionBox.value) return\n  const box = selectionBox.value\n  const pos1 = translateFromDomToSvgCoordinates(svg, viewport, box.pos)\n  const pos2 = translateFromDomToSvgCoordinates(svg, viewport, {\n    x: box.pos.x + box.size.width,\n    y: box.pos.y + box.size.height,\n  })\n\n  // find enclosed nodes\n  const enclosedNodes = new Set(\n    Object.entries(nodePositions)\n      .filter(([_, pos]) => {\n        return pos1.x <= pos.x && pos.x <= pos2.x && pos1.y <= pos.y && pos.y <= pos2.y\n      })\n      .map(([nodeId, _]) => nodeId)\n  )\n\n  if (selectionType === \"append\") {\n    selectedNodes.forEach(nodeId => {\n      if (!enclosedNodes.has(nodeId)) {\n        selectedNodes.delete(nodeId)\n      }\n    })\n    enclosedNodes.forEach(nodeId => {\n      const selectable = nodeStates[nodeId]?.selectable ?? false\n      if (\n        selectable === true ||\n        (typeof selectable === \"number\" && selectedNodes.size < selectable)\n      ) {\n        selectedNodes.add(nodeId)\n      }\n    })\n  } else {\n    // selectionType === \"invert\"\n    const temporary = new Set<string>(selectedNodesAtSelectStarted)\n    temporary.forEach(nodeId => {\n      if (enclosedNodes.has(nodeId)) {\n        temporary.delete(nodeId)\n      }\n    })\n    enclosedNodes.forEach(nodeId => {\n      if (!selectedNodesAtSelectStarted.has(nodeId)) {\n        const selectable = nodeStates[nodeId]?.selectable ?? false\n        if (\n          selectable === true ||\n          (typeof selectable === \"number\" && temporary.size < selectable)\n        ) {\n          temporary.add(nodeId)\n        }\n      }\n    })\n    // replace\n    selectedNodes.clear()\n    temporary.forEach(nodeId => selectedNodes.add(nodeId))\n  }\n}\n\n// ------------------------------------------------------------------\n// Event register/unregister\n// ------------------------------------------------------------------\n\ntype KeyboardEventHandler = (event: KeyboardEvent) => void\ntype PointerEventHandler = (event: PointerEvent) => void\ntype MouseEventHandler = (event: MouseEvent) => void\n\nclass PointerEventRegistrar {\n  _container: Ref<SVGElement | undefined>\n  _handlePointerDownEvent: PointerEventHandler\n  _handlePointerUpEvent: PointerEventHandler\n  _handlePointerMoveEvent: PointerEventHandler\n  _handleClickEvent: MouseEventHandler\n  _handleKeyDownEvent: KeyboardEventHandler\n  _ignoreEvent: PointerEventHandler\n\n  constructor(\n    container: Ref<SVGElement | undefined>,\n    handlePointerDownEvent: PointerEventHandler,\n    handlePointerUpEvent: PointerEventHandler,\n    handlePointerMoveEvent: PointerEventHandler,\n    handleClickEvent: MouseEventHandler,\n    handleKeyDownEvent: KeyboardEventHandler\n  ) {\n    this._container = container\n    this._handlePointerDownEvent = handlePointerDownEvent\n    this._handlePointerUpEvent = handlePointerUpEvent\n    this._handlePointerMoveEvent = handlePointerMoveEvent\n    this._handleClickEvent = handleClickEvent\n    this._handleKeyDownEvent = handleKeyDownEvent\n    this._ignoreEvent = (event: PointerEvent) => event.stopPropagation()\n  }\n\n  register() {\n    const options = { capture: true, passive: false }\n    const container = nonNull(this._container.value, \"container\")\n    container.addEventListener(\"pointerdown\", this._handlePointerDownEvent, options)\n    container.addEventListener(\"click\", this._handleClickEvent, options)\n    container.addEventListener(\"pointerenter\", this._ignoreEvent, options)\n    container.addEventListener(\"pointerleave\", this._ignoreEvent, options)\n    document.addEventListener(\"keydown\", this._handleKeyDownEvent, options)\n  }\n\n  activate() {\n    const options = { capture: true, passive: false }\n    document.addEventListener(\"pointermove\", this._handlePointerMoveEvent, options)\n    document.addEventListener(\"pointerup\", this._handlePointerUpEvent, options)\n  }\n\n  deactivate() {\n    const options = { capture: true }\n    document.removeEventListener(\"pointermove\", this._handlePointerMoveEvent, options)\n    document.removeEventListener(\"pointerup\", this._handlePointerUpEvent, options)\n  }\n\n  unregister() {\n    this.deactivate()\n    const options = { capture: true }\n    if (this._container.value) {\n      const container = this._container.value\n      container.removeEventListener(\"pointerdown\", this._handlePointerDownEvent, options)\n      container.removeEventListener(\"click\", this._handleClickEvent, options)\n      container.removeEventListener(\"pointerenter\", this._ignoreEvent, options)\n      container.removeEventListener(\"pointerleave\", this._ignoreEvent, options)\n      document.removeEventListener(\"keydown\", this._handleKeyDownEvent, options)\n    }\n  }\n}\n\nclass KeyEventRegistrar {\n  _container: Ref<SVGElement | undefined>\n  _handleKeyDownEvent: KeyboardEventHandler\n  _handleKeyUpEvent: KeyboardEventHandler\n  _preventDefault: MouseEventHandler\n\n  constructor(\n    container: Ref<SVGElement | undefined>,\n    handleKeyDownEvent: KeyboardEventHandler,\n    handleKeyUpEvent: KeyboardEventHandler\n  ) {\n    this._container = container\n    this._handleKeyDownEvent = handleKeyDownEvent\n    this._handleKeyUpEvent = handleKeyUpEvent\n    this._preventDefault = (event: MouseEvent) => {\n      event.stopPropagation()\n      event.preventDefault()\n    }\n  }\n\n  register() {\n    document.addEventListener(\"keydown\", this._handleKeyDownEvent, { capture: true, passive: true })\n  }\n\n  activate() {\n    document.addEventListener(\"keyup\", this._handleKeyUpEvent, { capture: true, passive: true })\n    const container = nonNull(this._container.value, \"container\")\n    container.addEventListener(\"contextmenu\", this._preventDefault, { passive: false })\n  }\n\n  deactivate() {\n    document.removeEventListener(\"keyup\", this._handleKeyUpEvent, { capture: true })\n    if (this._container.value) {\n      const container = this._container.value\n      container.removeEventListener(\"contextmenu\", this._preventDefault)\n    }\n  }\n\n  unregister() {\n    this.deactivate()\n    document.removeEventListener(\"keydown\", this._handleKeyDownEvent, { capture: true })\n  }\n}\n","// Module responsible for selection state and mouse/touch operations\n\nimport { inject, InjectionKey, provide, ref, Ref, watch } from \"vue\"\nimport { Emitter } from \"mitt\"\nimport { nonNull, Reactive, ReadonlyRef } from \"@/common/common\"\nimport { Events, Layouts, Rectangle } from \"@/common/types\"\nimport { NodeStates } from \"@/models/node\"\nimport { EdgeStates } from \"@/models/edge\"\nimport { PathStates } from \"@/models/path\"\nimport { Configs } from \"@/common/configs\"\nimport { InteractionModes } from \"./core\"\nimport { makeNodeInteractionHandlers } from \"./node\"\nimport { makeEdgeInteractionHandlers } from \"./edge\"\nimport { setupContainerInteractionHandlers } from \"./container\"\nimport { makePathInteractionHandlers } from \"./path\"\nimport { BoxSelectionOption, makeBoxSelectionMethods } from \"./boxSelection\"\n\ntype NodeEventHandler<T extends Event = PointerEvent> = (node: string, event: T) => void\ntype EdgeEventHandler<T extends Event = PointerEvent> = (edge: string, event: T) => void\ntype EdgesEventHandler<T extends Event = PointerEvent> = (edges: string[], event: T) => void\ntype PathEventHandler<T extends Event = PointerEvent> = (path: string, event: T) => void\n\ninterface MouseEventHandlers {\n  selectedNodes: Reactive<Set<string>>\n  hoveredNodes: Reactive<Set<string>>\n  selectedEdges: Reactive<Set<string>>\n  hoveredEdges: Reactive<Set<string>>\n  selectedPaths: Reactive<Set<string>>\n  hoveredPaths: Reactive<Set<string>>\n\n  // for Nodes\n  handleNodePointerDownEvent: NodeEventHandler\n  handleNodePointerOverEvent: NodeEventHandler\n  handleNodePointerOutEvent: NodeEventHandler\n  handleNodeClickEvent: NodeEventHandler<MouseEvent>\n  handleNodeDoubleClickEvent: NodeEventHandler<MouseEvent>\n  handleNodeContextMenu: NodeEventHandler<MouseEvent>\n\n  // for Edges\n  handleEdgePointerDownEvent: EdgeEventHandler\n  handleEdgePointerOverEvent: EdgeEventHandler\n  handleEdgePointerOutEvent: EdgeEventHandler\n  handleEdgeClickEvent: EdgeEventHandler<MouseEvent>\n  handleEdgeDoubleClickEvent: EdgeEventHandler<MouseEvent>\n  handleEdgeContextMenu: EdgeEventHandler<MouseEvent>\n  handleEdgesPointerDownEvent: EdgesEventHandler\n  handleEdgesPointerOverEvent: EdgesEventHandler\n  handleEdgesPointerOutEvent: EdgesEventHandler\n  handleEdgesClickEvent: EdgesEventHandler<MouseEvent>\n  handleEdgesDoubleClickEvent: EdgesEventHandler<MouseEvent>\n  handleEdgesContextMenu: EdgesEventHandler<MouseEvent>\n\n  // for Paths\n  handlePathPointerDownEvent: PathEventHandler\n  handlePathPointerOverEvent: PathEventHandler\n  handlePathPointerOutEvent: PathEventHandler\n  handlePathClickEvent: PathEventHandler<MouseEvent>\n  handlePathDoubleClickEvent: PathEventHandler<MouseEvent>\n  handlePathContextMenu: PathEventHandler<MouseEvent>\n\n  // for Box Selection\n  isBoxSelectionMode: Ref<boolean>\n  selectionBox: Ref<Rectangle>\n  startBoxSelection: (options?: Partial<BoxSelectionOption>) => void\n  stopBoxSelection: () => void\n}\nconst mouseEventHandlersKey = Symbol(\"mouseEventHandlers\") as InjectionKey<MouseEventHandlers>\n\nexport function provideMouseOperation(\n  container: Ref<SVGElement | undefined>,\n  layouts: Readonly<Layouts>,\n  zoomLevel: ReadonlyRef<number>,\n  nodeStates: NodeStates,\n  edgeStates: EdgeStates,\n  pathStates: PathStates,\n  selectedNodes: Reactive<Set<string>>,\n  selectedEdges: Reactive<Set<string>>,\n  selectedPaths: Reactive<Set<string>>,\n  hoveredNodes: Reactive<Set<string>>,\n  hoveredEdges: Reactive<Set<string>>,\n  hoveredPaths: Reactive<Set<string>>,\n  isInCompatibilityModeForPath: Ref<boolean>,\n  isSvgWheelZoomEnabled: Ref<boolean>,\n  configs: Configs,\n  emitter: Emitter<Events>\n): MouseEventHandlers {\n  const modes: InteractionModes = {\n    selectionMode: ref(\"container\"),\n    viewMode: ref(\"default\"),\n  }\n\n  if (selectedNodes.size > 0) {\n    modes.selectionMode.value = \"node\"\n  } else if (selectedEdges.size > 0) {\n    modes.selectionMode.value = \"edge\"\n  } else if (selectedPaths.size > 0) {\n    modes.selectionMode.value = \"path\"\n  }\n\n  watch(modes.viewMode, mode => {\n    emitter.emit(\"view:mode\", mode)\n  })\n\n  setupContainerInteractionHandlers(container, modes, isSvgWheelZoomEnabled, emitter)\n\n  const provides = <MouseEventHandlers>{\n    selectedNodes,\n    hoveredNodes,\n    selectedEdges,\n    hoveredEdges,\n    selectedPaths,\n    hoveredPaths,\n    ...makeNodeInteractionHandlers(\n      nodeStates,\n      layouts,\n      modes,\n      hoveredNodes,\n      selectedNodes,\n      zoomLevel,\n      emitter\n    ),\n    ...makeEdgeInteractionHandlers(edgeStates, modes, hoveredEdges, selectedEdges, emitter),\n    ...makePathInteractionHandlers(\n      pathStates,\n      modes,\n      hoveredPaths,\n      selectedPaths,\n      isInCompatibilityModeForPath,\n      emitter\n    ),\n    ...makeBoxSelectionMethods(\n      container,\n      modes,\n      layouts,\n      nodeStates,\n      selectedNodes,\n      configs\n    ),\n  }\n  provide(mouseEventHandlersKey, provides)\n  return provides\n}\n\nexport function useMouseOperation(): MouseEventHandlers {\n  return nonNull(inject(mouseEventHandlersKey), \"mouseEventHandlers\")\n}\n","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i?i.push(e):n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&(e?i.splice(i.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var i=n.get(t);i&&i.slice().map(function(n){n(e)}),(i=n.get(\"*\"))&&i.slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.mjs.map\n","import { provide, inject, InjectionKey } from \"vue\"\nimport mitt, { Emitter } from \"mitt\"\nimport { nonNull } from \"@/common/common\"\nimport { Events } from \"@/common/types\"\n\nconst eventEmitterKey = Symbol(\"emitter\") as InjectionKey<Emitter<Events>>\n\nexport function provideEventEmitter(): Emitter<Events> {\n  // event bus\n  const emitter = mitt<Events>()\n  provide(eventEmitterKey, emitter)\n  return emitter\n}\n\nexport function useEventEmitter(): Emitter<Events> {\n  return nonNull(inject(eventEmitterKey), \"event emitter\")\n}\n","module.exports = {\n  /**\n   * Get global this object\n   *\n   * @return {Object}        global this object\n   */\n  getGlobalThis: function () {\n    if (typeof globalThis !== \"undefined\") return globalThis;\n    if (typeof self !== \"undefined\") return self;\n    if (typeof window !== \"undefined\") return window;\n    if (typeof global !== \"undefined\") return global;\n    // Note: this might still return the wrong result!\n    if (typeof this !== \"undefined\") return this;\n    throw new Error(\"Unable to locate global `this`\");\n  },\n\n  /**\n   * Extends an object\n   *\n   * @param  {Object} target object to extend\n   * @param  {Object} source object to take properties from\n   * @return {Object}        extended object\n   */\n  extend: function (target, source) {\n    target = target || {};\n    for (var prop in source) {\n      // Go recursively\n      if (this.isObject(source[prop])) {\n        target[prop] = this.extend(target[prop], source[prop]);\n      } else {\n        target[prop] = source[prop];\n      }\n    }\n    return target;\n  },\n\n  /**\n   * Checks if an object is a DOM element\n   *\n   * @param  {Object}  o HTML element or String\n   * @return {Boolean}   returns true if object is a DOM element\n   */\n  isElement: function (o) {\n    return (\n      o instanceof HTMLElement ||\n      o instanceof SVGElement ||\n      o instanceof SVGSVGElement || //DOM2\n      (o &&\n        typeof o === \"object\" &&\n        o !== null &&\n        o.nodeType === 1 &&\n        typeof o.nodeName === \"string\")\n    );\n  },\n\n  /**\n   * Checks if an object is an Object\n   *\n   * @param  {Object}  o Object\n   * @return {Boolean}   returns true if object is an Object\n   */\n  isObject: function (o) {\n    return Object.prototype.toString.call(o) === \"[object Object]\";\n  },\n\n  /**\n   * Checks if variable is Number\n   *\n   * @param  {Integer|Float}  n\n   * @return {Boolean}   returns true if variable is Number\n   */\n  isNumber: function (n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  },\n\n  /**\n   * Search for an SVG element\n   *\n   * @param  {Object|String} elementOrSelector DOM Element or selector String\n   * @return {Object|Null}                   SVG or null\n   */\n  getSvg: function (elementOrSelector) {\n    var element, svg;\n\n    if (!this.isElement(elementOrSelector)) {\n      // If selector provided\n      if (\n        typeof elementOrSelector === \"string\" ||\n        elementOrSelector instanceof String\n      ) {\n        // Try to find the element\n        element = document.querySelector(elementOrSelector);\n\n        if (!element) {\n          throw new Error(\n            \"Provided selector did not find any elements. Selector: \" +\n              elementOrSelector\n          );\n          return null;\n        }\n      } else {\n        throw new Error(\"Provided selector is not an HTML object nor String\");\n        return null;\n      }\n    } else {\n      element = elementOrSelector;\n    }\n\n    if (element.tagName.toLowerCase() === \"svg\") {\n      svg = element;\n    } else {\n      if (element.tagName.toLowerCase() === \"object\") {\n        svg = element.contentDocument.documentElement;\n      } else {\n        if (element.tagName.toLowerCase() === \"embed\") {\n          svg = element.getSVGDocument().documentElement;\n        } else {\n          if (element.tagName.toLowerCase() === \"img\") {\n            throw new Error(\n              'Cannot script an SVG in an \"img\" element. Please use an \"object\" element or an in-line SVG.'\n            );\n          } else {\n            throw new Error(\"Cannot get SVG.\");\n          }\n          return null;\n        }\n      }\n    }\n\n    return svg;\n  },\n\n  /**\n   * Attach a given context to a function\n   * @param  {Function} fn      Function\n   * @param  {Object}   context Context\n   * @return {Function}           Function with certain context\n   */\n  proxy: function (fn, context) {\n    return function () {\n      return fn.apply(context, arguments);\n    };\n  },\n\n  /**\n   * Returns object type\n   * Uses toString that returns [object SVGPoint]\n   * And than parses object type from string\n   *\n   * @param  {Object} o Any object\n   * @return {String}   Object type\n   */\n  getType: function (o) {\n    return Object.prototype.toString\n      .apply(o)\n      .replace(/^\\[object\\s/, \"\")\n      .replace(/\\]$/, \"\");\n  },\n\n  /**\n   * If it is a touch event than add clientX and clientY to event object\n   *\n   * @param  {Event} evt\n   * @param  {SVGSVGElement} svg\n   */\n  mouseAndTouchNormalize: function (evt, svg) {\n    // If no clientX then fallback\n    if (evt.clientX === void 0 || evt.clientX === null) {\n      // Fallback\n      evt.clientX = 0;\n      evt.clientY = 0;\n\n      // If it is a touch event\n      if (evt.touches !== void 0 && evt.touches.length) {\n        if (evt.touches[0].clientX !== void 0) {\n          evt.clientX = evt.touches[0].clientX;\n          evt.clientY = evt.touches[0].clientY;\n        } else if (evt.touches[0].pageX !== void 0) {\n          var rect = svg.getBoundingClientRect();\n\n          evt.clientX = evt.touches[0].pageX - rect.left;\n          evt.clientY = evt.touches[0].pageY - rect.top;\n        }\n        // If it is a custom event\n      } else if (evt.originalEvent !== void 0) {\n        if (evt.originalEvent.clientX !== void 0) {\n          evt.clientX = evt.originalEvent.clientX;\n          evt.clientY = evt.originalEvent.clientY;\n        }\n      }\n    }\n  },\n\n  /**\n   * If it is a touch event than add clientX and clientY to event object\n   *\n   * @param  {Event} evt\n   * @param  {SVGSVGElement} svg\n   * @param  {Number} touch\n   */\n  touchNormalize: function (evt, svg, touch) {\n    // If it is a touch event\n    if (evt.touches !== void 0 && evt.touches.length) {\n      if (evt.touches[touch].clientX !== void 0) {\n        evt.clientX = evt.touches[touch].clientX;\n        evt.clientY = evt.touches[touch].clientY;\n      } else if (evt.touches[touch].pageX !== void 0) {\n        var rect = svg.getBoundingClientRect();\n\n        evt.clientX = evt.touches[touch].pageX - rect.left;\n        evt.clientY = evt.touches[touch].pageY - rect.top;\n      }\n      // If it is a custom event\n    } else {\n      // If no clientX then fallback\n      if (evt.clientX === void 0 || evt.clientX === null) {\n        // Fallback\n        evt.clientX = 0;\n        evt.clientY = 0;\n        if (evt.originalEvent !== void 0) {\n          if (evt.originalEvent.clientX !== void 0) {\n            evt.clientX = evt.originalEvent.clientX;\n            evt.clientY = evt.originalEvent.clientY;\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Check if an event is a double click/tap\n   * TODO: For touch gestures use a library (hammer.js) that takes in account other events\n   * (touchmove and touchend). It should take in account tap duration and traveled distance\n   *\n   * @param  {Event}  evt\n   * @param  {Event}  prevEvt Previous Event\n   * @return {Boolean}\n   */\n  isDblClick: function (evt, prevEvt) {\n    // Double click detected by browser\n    if (evt.detail === 2) {\n      return true;\n    }\n    // Try to compare events\n    else if (prevEvt !== void 0 && prevEvt !== null) {\n      var timeStampDiff = evt.timeStamp - prevEvt.timeStamp, // should be lower than 250 ms\n        touchesDistance = Math.sqrt(\n          Math.pow(evt.clientX - prevEvt.clientX, 2) +\n            Math.pow(evt.clientY - prevEvt.clientY, 2)\n        );\n\n      return timeStampDiff < 250 && touchesDistance < 10;\n    }\n\n    // Nothing found\n    return false;\n  },\n\n  /**\n   * Returns current timestamp as an integer\n   *\n   * @return {Number}\n   */\n  now:\n    Date.now ||\n    function () {\n      return new Date().getTime();\n    },\n\n  // From underscore.\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n  throttle: function (func, wait, options) {\n    var that = this;\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) {\n      options = {};\n    }\n    var later = function () {\n      previous = options.leading === false ? 0 : that.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) {\n        context = args = null;\n      }\n    };\n    return function () {\n      var now = that.now();\n      if (!previous && options.leading === false) {\n        previous = now;\n      }\n      var remaining = wait - (now - previous);\n      context = this; // eslint-disable-line consistent-this\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n        if (!timeout) {\n          context = args = null;\n        }\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  },\n\n  /**\n   * Create a requestAnimationFrame simulation\n   *\n   * @param  {Number|String} refreshRate\n   * @return {Function}\n   */\n  createRequestAnimationFrame: function (refreshRate) {\n    var timeout = null;\n\n    // Convert refreshRate to timeout\n    if (refreshRate !== \"auto\" && refreshRate < 60 && refreshRate > 1) {\n      timeout = Math.floor(1000 / refreshRate);\n    }\n\n    if (timeout === null) {\n      return window.requestAnimationFrame || requestTimeout(33);\n    } else {\n      return requestTimeout(timeout);\n    }\n  },\n\n  /**\n   * Calculate distance of points\n   *\n   * @param  {SVGPoint} point1\n   * @param  {SVGPoint} point2\n   * @return {Number}\n   */\n  calculateDistance: function (point1, point2) {\n    var dx = point1.x - point2.x;\n    var dy = point1.y - point2.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  },\n};\n\n/**\n * Create a callback that will execute after a given timeout\n *\n * @param  {Function} timeout\n * @return {Function}\n */\nfunction requestTimeout(timeout) {\n  return function (callback) {\n    window.setTimeout(callback, timeout);\n  };\n}\n","// uniwheel 0.1.2 (customized)\n// A unified cross browser mouse wheel event handler\n// https://github.com/teemualap/uniwheel\n\nvar Utils = require(\"./utilities\");\n\nmodule.exports = (function() {\n  //Full details: https://developer.mozilla.org/en-US/docs/Web/Reference/Events/wheel\n\n  var prefix = \"\",\n    _addEventListener,\n    _removeEventListener,\n    support,\n    fns = [];\n  var passiveTrueOption = { passive: true };\n  var passiveFalseOption = { passive: false };\n\n  // detect event model\n  if (Utils.getGlobalThis().addEventListener) {\n    _addEventListener = \"addEventListener\";\n    _removeEventListener = \"removeEventListener\";\n  } else {\n    _addEventListener = \"attachEvent\";\n    _removeEventListener = \"detachEvent\";\n    prefix = \"on\";\n  }\n\n  function getSupport() {\n    if (!support) {\n      support =\n        \"onwheel\" in document.createElement(\"div\")\n          ? \"wheel\" // Modern browsers support \"wheel\"\n          : document.onmousewheel !== undefined\n          ? \"mousewheel\" // Webkit and IE support at least \"mousewheel\"\n          : \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\n    }\n    return support;\n  }\n\n  function createCallback(element, callback) {\n    // detect available wheel event\n\n    var fn = function(originalEvent) {\n      !originalEvent && (originalEvent = window.event);\n\n      // create a normalized event object\n      var event = {\n        // keep a ref to the original event object\n        originalEvent: originalEvent,\n        target: originalEvent.target || originalEvent.srcElement,\n        type: \"wheel\",\n        deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\n        deltaX: 0,\n        delatZ: 0,\n        preventDefault: function() {\n          originalEvent.preventDefault\n            ? originalEvent.preventDefault()\n            : (originalEvent.returnValue = false);\n        }\n      };\n\n      // calculate deltaY (and deltaX) according to the event\n      if (getSupport() == \"mousewheel\") {\n        event.deltaY = (-1 / 40) * originalEvent.wheelDelta;\n        // Webkit also support wheelDeltaX\n        originalEvent.wheelDeltaX &&\n          (event.deltaX = (-1 / 40) * originalEvent.wheelDeltaX);\n      } else {\n        event.deltaY = originalEvent.detail;\n      }\n\n      // it's time to fire the callback\n      return callback(event);\n    };\n\n    fns.push({\n      element: element,\n      fn: fn\n    });\n\n    return fn;\n  }\n\n  function getCallback(element) {\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i].element === element) {\n        return fns[i].fn;\n      }\n    }\n    return function() {};\n  }\n\n  function removeCallback(element) {\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i].element === element) {\n        return fns.splice(i, 1);\n      }\n    }\n  }\n\n  function _addWheelListener(elem, eventName, callback, isPassiveListener) {\n    var cb;\n\n    if (getSupport() === \"wheel\") {\n      cb = callback;\n    } else {\n      cb = createCallback(elem, callback);\n    }\n\n    elem[_addEventListener](\n      prefix + eventName,\n      cb,\n      isPassiveListener ? passiveTrueOption : passiveFalseOption\n    );\n  }\n\n  function _removeWheelListener(elem, eventName, callback, isPassiveListener) {\n    var cb;\n\n    if (getSupport() === \"wheel\") {\n      cb = callback;\n    } else {\n      cb = getCallback(elem);\n    }\n\n    elem[_removeEventListener](\n      prefix + eventName,\n      cb,\n      isPassiveListener ? passiveTrueOption : passiveFalseOption\n    );\n\n    removeCallback(elem);\n  }\n\n  function addWheelListener(elem, callback, isPassiveListener) {\n    _addWheelListener(elem, getSupport(), callback, isPassiveListener);\n\n    // handle MozMousePixelScroll in older Firefox\n    if (getSupport() == \"DOMMouseScroll\") {\n      _addWheelListener(\n        elem,\n        \"MozMousePixelScroll\",\n        callback,\n        isPassiveListener\n      );\n    }\n  }\n\n  function removeWheelListener(elem, callback, isPassiveListener) {\n    _removeWheelListener(elem, getSupport(), callback, isPassiveListener);\n\n    // handle MozMousePixelScroll in older Firefox\n    if (getSupport() == \"DOMMouseScroll\") {\n      _removeWheelListener(\n        elem,\n        \"MozMousePixelScroll\",\n        callback,\n        isPassiveListener\n      );\n    }\n  }\n\n  return {\n    on: addWheelListener,\n    off: removeWheelListener\n  };\n})();\n","var Utils = require(\"./utilities\"),\n  _browser = \"unknown\";\n\n// http://stackoverflow.com/questions/9847580/how-to-detect-safari-chrome-ie-firefox-and-opera-browser\nif (\n  /*@cc_on!@*/ false ||\n  (typeof document != \"undefined\" && !!document.documentMode)\n) {\n  // internet explorer\n  _browser = \"ie\";\n}\n\nmodule.exports = {\n  svgNS: \"http://www.w3.org/2000/svg\",\n  xmlNS: \"http://www.w3.org/XML/1998/namespace\",\n  xmlnsNS: \"http://www.w3.org/2000/xmlns/\",\n  xlinkNS: \"http://www.w3.org/1999/xlink\",\n  evNS: \"http://www.w3.org/2001/xml-events\",\n\n  /**\n   * Get svg dimensions: width and height\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {Object}     {width: 0, height: 0}\n   */\n  getBoundingClientRectNormalized: function (svg) {\n    if (svg.clientWidth && svg.clientHeight) {\n      return { width: svg.clientWidth, height: svg.clientHeight };\n    } else if (!!svg.getBoundingClientRect()) {\n      return svg.getBoundingClientRect();\n    } else {\n      throw new Error(\"Cannot get BoundingClientRect for SVG.\");\n    }\n  },\n\n  /**\n   * Gets g element with class of \"viewport\" or creates it if it doesn't exist\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {SVGElement}     g (group) element\n   */\n  getOrCreateViewport: function (svg, selector) {\n    var viewport = null;\n\n    if (Utils.isElement(selector)) {\n      viewport = selector;\n    } else {\n      viewport = svg.querySelector(selector);\n    }\n\n    // Check if there is just one main group in SVG\n    if (!viewport) {\n      var childNodes = Array.prototype.slice\n        .call(svg.childNodes || svg.children)\n        .filter(function (el) {\n          return el.nodeName !== \"defs\" && el.nodeName !== \"#text\";\n        });\n\n      // Node name should be SVGGElement and should have no transform attribute\n      // Groups with transform are not used as viewport because it involves parsing of all transform possibilities\n      if (\n        childNodes.length === 1 &&\n        childNodes[0].nodeName === \"g\" &&\n        childNodes[0].getAttribute(\"transform\") === null\n      ) {\n        viewport = childNodes[0];\n      }\n    }\n\n    // If no favorable group element exists then create one\n    if (!viewport) {\n      var viewportId =\n        \"viewport-\" + new Date().toISOString().replace(/\\D/g, \"\");\n      viewport = document.createElementNS(this.svgNS, \"g\");\n      viewport.setAttribute(\"id\", viewportId);\n\n      // Internet Explorer (all versions?) can't use childNodes, but other browsers prefer (require?) using childNodes\n      var svgChildren = svg.childNodes || svg.children;\n      if (!!svgChildren && svgChildren.length > 0) {\n        for (var i = svgChildren.length; i > 0; i--) {\n          // Move everything into viewport except defs\n          if (svgChildren[svgChildren.length - i].nodeName !== \"defs\") {\n            viewport.appendChild(svgChildren[svgChildren.length - i]);\n          }\n        }\n      }\n      svg.appendChild(viewport);\n    }\n\n    // Parse class names\n    var classNames = [];\n    if (viewport.getAttribute(\"class\")) {\n      classNames = viewport.getAttribute(\"class\").split(\" \");\n    }\n\n    // Set class (if not set already)\n    if (!~classNames.indexOf(\"svg-pan-zoom_viewport\")) {\n      classNames.push(\"svg-pan-zoom_viewport\");\n      viewport.setAttribute(\"class\", classNames.join(\" \"));\n    }\n\n    return viewport;\n  },\n\n  /**\n   * Set SVG attributes\n   *\n   * @param  {SVGSVGElement} svg\n   */\n  setupSvgAttributes: function (svg) {\n    // Setting default attributes\n    svg.setAttribute(\"xmlns\", this.svgNS);\n    svg.setAttributeNS(this.xmlnsNS, \"xmlns:xlink\", this.xlinkNS);\n    svg.setAttributeNS(this.xmlnsNS, \"xmlns:ev\", this.evNS);\n\n    // Needed for Internet Explorer, otherwise the viewport overflows\n    if (svg.parentNode !== null) {\n      var style = svg.getAttribute(\"style\") || \"\";\n      if (style.toLowerCase().indexOf(\"overflow\") === -1) {\n        svg.setAttribute(\"style\", \"overflow: hidden; \" + style);\n      }\n    }\n  },\n\n  /**\n   * How long Internet Explorer takes to finish updating its display (ms).\n   */\n  internetExplorerRedisplayInterval: 300,\n\n  /**\n   * Forces the browser to redisplay all SVG elements that rely on an\n   * element defined in a 'defs' section. It works globally, for every\n   * available defs element on the page.\n   * The throttling is intentionally global.\n   *\n   * This is only needed for IE. It is as a hack to make markers (and 'use' elements?)\n   * visible after pan/zoom when there are multiple SVGs on the page.\n   * See bug report: https://connect.microsoft.com/IE/feedback/details/781964/\n   * also see svg-pan-zoom issue: https://github.com/ariutta/svg-pan-zoom/issues/62\n   */\n  refreshDefsGlobal: Utils.throttle(\n    function () {\n      var allDefs = document.querySelectorAll(\"defs\");\n      var allDefsCount = allDefs.length;\n      for (var i = 0; i < allDefsCount; i++) {\n        var thisDefs = allDefs[i];\n        thisDefs.parentNode.insertBefore(thisDefs, thisDefs);\n      }\n    },\n    this ? this.internetExplorerRedisplayInterval : null\n  ),\n\n  /**\n   * Sets the current transform matrix of an element\n   *\n   * @param {SVGElement} element\n   * @param {SVGMatrix} matrix  CTM\n   * @param {SVGElement} defs\n   */\n  setCTM: function (element, matrix, defs) {\n    var that = this,\n      s =\n        \"matrix(\" +\n        matrix.a +\n        \",\" +\n        matrix.b +\n        \",\" +\n        matrix.c +\n        \",\" +\n        matrix.d +\n        \",\" +\n        matrix.e +\n        \",\" +\n        matrix.f +\n        \")\";\n\n    element.setAttributeNS(null, \"transform\", s);\n    if (\"transform\" in element.style) {\n      element.style.transform = s;\n    } else if (\"-ms-transform\" in element.style) {\n      element.style[\"-ms-transform\"] = s;\n    } else if (\"-webkit-transform\" in element.style) {\n      element.style[\"-webkit-transform\"] = s;\n    }\n\n    // IE has a bug that makes markers disappear on zoom (when the matrix \"a\" and/or \"d\" elements change)\n    // see http://stackoverflow.com/questions/17654578/svg-marker-does-not-work-in-ie9-10\n    // and http://srndolha.wordpress.com/2013/11/25/svg-line-markers-may-disappear-in-internet-explorer-11/\n    if (_browser === \"ie\" && !!defs) {\n      // this refresh is intended for redisplaying the SVG during zooming\n      defs.parentNode.insertBefore(defs, defs);\n      // this refresh is intended for redisplaying the other SVGs on a page when panning a given SVG\n      // it is also needed for the given SVG itself, on zoomEnd, if the SVG contains any markers that\n      // are located under any other element(s).\n      window.setTimeout(function () {\n        that.refreshDefsGlobal();\n      }, that.internetExplorerRedisplayInterval);\n    }\n  },\n\n  /**\n   * Instantiate an SVGPoint object with given event coordinates\n   *\n   * @param {Event} evt\n   * @param  {SVGSVGElement} svg\n   * @return {SVGPoint}     point\n   */\n  getEventPoint: function (evt, svg) {\n    var point = svg.createSVGPoint();\n\n    Utils.mouseAndTouchNormalize(evt, svg);\n\n    point.x = evt.clientX;\n    point.y = evt.clientY;\n\n    return point;\n  },\n\n  /**\n   * Instantiate an SVGPoint object with given touch event coordinates\n   *\n   * @param {Event} evt\n   * @param  {SVGSVGElement} svg\n   * @param  {Number} touch\n   * @return {SVGPoint}     point\n   */\n  getTouchPoint: function (evt, svg, touch) {\n    var point = svg.createSVGPoint();\n\n    Utils.touchNormalize(evt, svg, touch);\n\n    point.x = evt.clientX;\n    point.y = evt.clientY;\n\n    return point;\n  },\n\n  /**\n   * Get SVG center point\n   *\n   * @param  {SVGSVGElement} svg\n   * @return {SVGPoint}\n   */\n  getSvgCenterPoint: function (svg, width, height) {\n    return this.createSVGPoint(svg, width / 2, height / 2);\n  },\n\n  /**\n   * Create a SVGPoint with given x and y\n   *\n   * @param  {SVGSVGElement} svg\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {SVGPoint}\n   */\n  createSVGPoint: function (svg, x, y) {\n    var point = svg.createSVGPoint();\n    point.x = x;\n    point.y = y;\n\n    return point;\n  },\n};\n","var SvgUtils = require(\"./svg-utilities\");\n\nmodule.exports = {\n  enable: function (instance) {\n    // Select (and create if necessary) defs\n    var defs = instance.svg.querySelector(\"defs\");\n    if (!defs) {\n      defs = document.createElementNS(SvgUtils.svgNS, \"defs\");\n      instance.svg.appendChild(defs);\n    }\n\n    // Check for style element, and create it if it doesn't exist\n    var styleEl = defs.querySelector(\"style#svg-pan-zoom-controls-styles\");\n    if (!styleEl) {\n      var style = document.createElementNS(SvgUtils.svgNS, \"style\");\n      style.setAttribute(\"id\", \"svg-pan-zoom-controls-styles\");\n      style.setAttribute(\"type\", \"text/css\");\n      style.textContent =\n        \".svg-pan-zoom-control { cursor: pointer; fill: black; fill-opacity: 0.333; } .svg-pan-zoom-control:hover { fill-opacity: 0.8; } .svg-pan-zoom-control-background { fill: white; fill-opacity: 0.5; } .svg-pan-zoom-control-background { fill-opacity: 0.8; }\";\n      defs.appendChild(style);\n    }\n\n    // Zoom Group\n    var zoomGroup = document.createElementNS(SvgUtils.svgNS, \"g\");\n    zoomGroup.setAttribute(\"id\", \"svg-pan-zoom-controls\");\n    zoomGroup.setAttribute(\n      \"transform\",\n      \"translate(\" +\n        (instance.width - 70) +\n        \" \" +\n        (instance.height - 76) +\n        \") scale(0.75)\"\n    );\n    zoomGroup.setAttribute(\"class\", \"svg-pan-zoom-control\");\n\n    // Control elements\n    zoomGroup.appendChild(this._createZoomIn(instance));\n    zoomGroup.appendChild(this._createZoomReset(instance));\n    zoomGroup.appendChild(this._createZoomOut(instance));\n\n    // Finally append created element\n    instance.svg.appendChild(zoomGroup);\n\n    // Cache control instance\n    instance.controlIcons = zoomGroup;\n  },\n\n  _createZoomIn: function (instance) {\n    var zoomIn = document.createElementNS(SvgUtils.svgNS, \"g\");\n    zoomIn.setAttribute(\"id\", \"svg-pan-zoom-zoom-in\");\n    zoomIn.setAttribute(\"transform\", \"translate(30.5 5) scale(0.015)\");\n    zoomIn.setAttribute(\"class\", \"svg-pan-zoom-control\");\n    zoomIn.addEventListener(\n      \"click\",\n      function () {\n        instance.getPublicInstance().zoomIn();\n      },\n      false\n    );\n    zoomIn.addEventListener(\n      \"touchstart\",\n      function () {\n        instance.getPublicInstance().zoomIn();\n      },\n      false\n    );\n\n    var zoomInBackground = document.createElementNS(SvgUtils.svgNS, \"rect\"); // TODO change these background space fillers to rounded rectangles so they look prettier\n    zoomInBackground.setAttribute(\"x\", \"0\");\n    zoomInBackground.setAttribute(\"y\", \"0\");\n    zoomInBackground.setAttribute(\"width\", \"1500\"); // larger than expected because the whole group is transformed to scale down\n    zoomInBackground.setAttribute(\"height\", \"1400\");\n    zoomInBackground.setAttribute(\"class\", \"svg-pan-zoom-control-background\");\n    zoomIn.appendChild(zoomInBackground);\n\n    var zoomInShape = document.createElementNS(SvgUtils.svgNS, \"path\");\n    zoomInShape.setAttribute(\n      \"d\",\n      \"M1280 576v128q0 26 -19 45t-45 19h-320v320q0 26 -19 45t-45 19h-128q-26 0 -45 -19t-19 -45v-320h-320q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h320v-320q0 -26 19 -45t45 -19h128q26 0 45 19t19 45v320h320q26 0 45 19t19 45zM1536 1120v-960 q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5t84.5 -203.5z\"\n    );\n    zoomInShape.setAttribute(\"class\", \"svg-pan-zoom-control-element\");\n    zoomIn.appendChild(zoomInShape);\n\n    return zoomIn;\n  },\n\n  _createZoomReset: function (instance) {\n    // reset\n    var resetPanZoomControl = document.createElementNS(SvgUtils.svgNS, \"g\");\n    resetPanZoomControl.setAttribute(\"id\", \"svg-pan-zoom-reset-pan-zoom\");\n    resetPanZoomControl.setAttribute(\"transform\", \"translate(5 35) scale(0.4)\");\n    resetPanZoomControl.setAttribute(\"class\", \"svg-pan-zoom-control\");\n    resetPanZoomControl.addEventListener(\n      \"click\",\n      function () {\n        instance.getPublicInstance().reset();\n      },\n      false\n    );\n    resetPanZoomControl.addEventListener(\n      \"touchstart\",\n      function () {\n        instance.getPublicInstance().reset();\n      },\n      false\n    );\n\n    var resetPanZoomControlBackground = document.createElementNS(\n      SvgUtils.svgNS,\n      \"rect\"\n    ); // TODO change these background space fillers to rounded rectangles so they look prettier\n    resetPanZoomControlBackground.setAttribute(\"x\", \"2\");\n    resetPanZoomControlBackground.setAttribute(\"y\", \"2\");\n    resetPanZoomControlBackground.setAttribute(\"width\", \"182\"); // larger than expected because the whole group is transformed to scale down\n    resetPanZoomControlBackground.setAttribute(\"height\", \"58\");\n    resetPanZoomControlBackground.setAttribute(\n      \"class\",\n      \"svg-pan-zoom-control-background\"\n    );\n    resetPanZoomControl.appendChild(resetPanZoomControlBackground);\n\n    var resetPanZoomControlShape1 = document.createElementNS(\n      SvgUtils.svgNS,\n      \"path\"\n    );\n    resetPanZoomControlShape1.setAttribute(\n      \"d\",\n      \"M33.051,20.632c-0.742-0.406-1.854-0.609-3.338-0.609h-7.969v9.281h7.769c1.543,0,2.701-0.188,3.473-0.562c1.365-0.656,2.048-1.953,2.048-3.891C35.032,22.757,34.372,21.351,33.051,20.632z\"\n    );\n    resetPanZoomControlShape1.setAttribute(\n      \"class\",\n      \"svg-pan-zoom-control-element\"\n    );\n    resetPanZoomControl.appendChild(resetPanZoomControlShape1);\n\n    var resetPanZoomControlShape2 = document.createElementNS(\n      SvgUtils.svgNS,\n      \"path\"\n    );\n    resetPanZoomControlShape2.setAttribute(\n      \"d\",\n      \"M170.231,0.5H15.847C7.102,0.5,0.5,5.708,0.5,11.84v38.861C0.5,56.833,7.102,61.5,15.847,61.5h154.384c8.745,0,15.269-4.667,15.269-10.798V11.84C185.5,5.708,178.976,0.5,170.231,0.5z M42.837,48.569h-7.969c-0.219-0.766-0.375-1.383-0.469-1.852c-0.188-0.969-0.289-1.961-0.305-2.977l-0.047-3.211c-0.03-2.203-0.41-3.672-1.142-4.406c-0.732-0.734-2.103-1.102-4.113-1.102h-7.05v13.547h-7.055V14.022h16.524c2.361,0.047,4.178,0.344,5.45,0.891c1.272,0.547,2.351,1.352,3.234,2.414c0.731,0.875,1.31,1.844,1.737,2.906s0.64,2.273,0.64,3.633c0,1.641-0.414,3.254-1.242,4.84s-2.195,2.707-4.102,3.363c1.594,0.641,2.723,1.551,3.387,2.73s0.996,2.98,0.996,5.402v2.32c0,1.578,0.063,2.648,0.19,3.211c0.19,0.891,0.635,1.547,1.333,1.969V48.569z M75.579,48.569h-26.18V14.022h25.336v6.117H56.454v7.336h16.781v6H56.454v8.883h19.125V48.569z M104.497,46.331c-2.44,2.086-5.887,3.129-10.34,3.129c-4.548,0-8.125-1.027-10.731-3.082s-3.909-4.879-3.909-8.473h6.891c0.224,1.578,0.662,2.758,1.316,3.539c1.196,1.422,3.246,2.133,6.15,2.133c1.739,0,3.151-0.188,4.236-0.562c2.058-0.719,3.087-2.055,3.087-4.008c0-1.141-0.504-2.023-1.512-2.648c-1.008-0.609-2.607-1.148-4.796-1.617l-3.74-0.82c-3.676-0.812-6.201-1.695-7.576-2.648c-2.328-1.594-3.492-4.086-3.492-7.477c0-3.094,1.139-5.664,3.417-7.711s5.623-3.07,10.036-3.07c3.685,0,6.829,0.965,9.431,2.895c2.602,1.93,3.966,4.73,4.093,8.402h-6.938c-0.128-2.078-1.057-3.555-2.787-4.43c-1.154-0.578-2.587-0.867-4.301-0.867c-1.907,0-3.428,0.375-4.565,1.125c-1.138,0.75-1.706,1.797-1.706,3.141c0,1.234,0.561,2.156,1.682,2.766c0.721,0.406,2.25,0.883,4.589,1.43l6.063,1.43c2.657,0.625,4.648,1.461,5.975,2.508c2.059,1.625,3.089,3.977,3.089,7.055C108.157,41.624,106.937,44.245,104.497,46.331z M139.61,48.569h-26.18V14.022h25.336v6.117h-18.281v7.336h16.781v6h-16.781v8.883h19.125V48.569z M170.337,20.14h-10.336v28.43h-7.266V20.14h-10.383v-6.117h27.984V20.14z\"\n    );\n    resetPanZoomControlShape2.setAttribute(\n      \"class\",\n      \"svg-pan-zoom-control-element\"\n    );\n    resetPanZoomControl.appendChild(resetPanZoomControlShape2);\n\n    return resetPanZoomControl;\n  },\n\n  _createZoomOut: function (instance) {\n    // zoom out\n    var zoomOut = document.createElementNS(SvgUtils.svgNS, \"g\");\n    zoomOut.setAttribute(\"id\", \"svg-pan-zoom-zoom-out\");\n    zoomOut.setAttribute(\"transform\", \"translate(30.5 70) scale(0.015)\");\n    zoomOut.setAttribute(\"class\", \"svg-pan-zoom-control\");\n    zoomOut.addEventListener(\n      \"click\",\n      function () {\n        instance.getPublicInstance().zoomOut();\n      },\n      false\n    );\n    zoomOut.addEventListener(\n      \"touchstart\",\n      function () {\n        instance.getPublicInstance().zoomOut();\n      },\n      false\n    );\n\n    var zoomOutBackground = document.createElementNS(SvgUtils.svgNS, \"rect\"); // TODO change these background space fillers to rounded rectangles so they look prettier\n    zoomOutBackground.setAttribute(\"x\", \"0\");\n    zoomOutBackground.setAttribute(\"y\", \"0\");\n    zoomOutBackground.setAttribute(\"width\", \"1500\"); // larger than expected because the whole group is transformed to scale down\n    zoomOutBackground.setAttribute(\"height\", \"1400\");\n    zoomOutBackground.setAttribute(\"class\", \"svg-pan-zoom-control-background\");\n    zoomOut.appendChild(zoomOutBackground);\n\n    var zoomOutShape = document.createElementNS(SvgUtils.svgNS, \"path\");\n    zoomOutShape.setAttribute(\n      \"d\",\n      \"M1280 576v128q0 26 -19 45t-45 19h-896q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h896q26 0 45 19t19 45zM1536 1120v-960q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5 t84.5 -203.5z\"\n    );\n    zoomOutShape.setAttribute(\"class\", \"svg-pan-zoom-control-element\");\n    zoomOut.appendChild(zoomOutShape);\n\n    return zoomOut;\n  },\n\n  disable: function (instance) {\n    if (instance.controlIcons) {\n      instance.controlIcons.parentNode.removeChild(instance.controlIcons);\n      instance.controlIcons = null;\n    }\n  },\n};\n","var SvgUtils = require(\"./svg-utilities\"),\n  Utils = require(\"./utilities\");\n\nvar ShadowViewport = function (viewport, options) {\n  this.init(viewport, options);\n};\n\n/**\n * Initialization\n *\n * @param  {SVGElement} viewport\n * @param  {Object} options\n */\nShadowViewport.prototype.init = function (viewport, options) {\n  // DOM Elements\n  this.viewport = viewport;\n  this.options = options;\n\n  // State cache\n  this.originalState = { zoom: 1, x: 0, y: 0 };\n  this.activeState = { zoom: 1, x: 0, y: 0 };\n\n  this.updateCTMCached = Utils.proxy(this.updateCTM, this);\n\n  // Create a custom requestAnimationFrame taking in account refreshRate\n  this.requestAnimationFrame = Utils.createRequestAnimationFrame(\n    this.options.refreshRate\n  );\n\n  // ViewBox\n  this.viewBox = { x: 0, y: 0, width: 0, height: 0 };\n  this.cacheViewBox();\n\n  // Process CTM\n  var newCTM = this.processCTM();\n\n  // Update viewport CTM and cache zoom and pan\n  this.setCTM(newCTM);\n\n  // Update CTM in this frame\n  this.updateCTM();\n};\n\n/**\n * Cache initial viewBox value\n * If no viewBox is defined, then use viewport size/position instead for viewBox values\n */\nShadowViewport.prototype.cacheViewBox = function () {\n  var svgViewBox = this.options.svg.getAttribute(\"viewBox\");\n\n  if (svgViewBox) {\n    var viewBoxValues = svgViewBox\n      .split(/[\\s\\,]/)\n      .filter(function (v) {\n        return v;\n      })\n      .map(parseFloat);\n\n    // Cache viewbox x and y offset\n    this.viewBox.x = viewBoxValues[0];\n    this.viewBox.y = viewBoxValues[1];\n    this.viewBox.width = viewBoxValues[2];\n    this.viewBox.height = viewBoxValues[3];\n\n    var zoom = Math.min(\n      this.options.width / this.viewBox.width,\n      this.options.height / this.viewBox.height\n    );\n\n    // Update active state\n    this.activeState.zoom = isFinite(zoom) ? zoom : 1;\n    this.activeState.x = (this.options.width - this.viewBox.width * zoom) / 2;\n    this.activeState.y = (this.options.height - this.viewBox.height * zoom) / 2;\n\n    // Force updating CTM\n    this.updateCTMOnNextFrame();\n\n    this.options.svg.removeAttribute(\"viewBox\");\n  } else {\n    this.simpleViewBoxCache();\n  }\n};\n\n/**\n * Recalculate viewport sizes and update viewBox cache\n */\nShadowViewport.prototype.simpleViewBoxCache = function () {\n  var bBox = this.viewport.getBBox();\n\n  this.viewBox.x = bBox.x;\n  this.viewBox.y = bBox.y;\n  this.viewBox.width = bBox.width;\n  this.viewBox.height = bBox.height;\n};\n\n/**\n * Returns a viewbox object. Safe to alter\n *\n * @return {Object} viewbox object\n */\nShadowViewport.prototype.getViewBox = function () {\n  return Utils.extend({}, this.viewBox);\n};\n\n/**\n * Get initial zoom and pan values. Save them into originalState\n * Parses viewBox attribute to alter initial sizes\n *\n * @return {CTM} CTM object based on options\n */\nShadowViewport.prototype.processCTM = function () {\n  var newCTM = this.getCTM();\n\n  if (this.options.fit || this.options.contain) {\n    var newScale;\n    if (this.options.fit) {\n      newScale = Math.min(\n        this.options.width / this.viewBox.width,\n        this.options.height / this.viewBox.height\n      );\n    } else {\n      newScale = Math.max(\n        this.options.width / this.viewBox.width,\n        this.options.height / this.viewBox.height\n      );\n    }\n\n    newScale = isFinite(newScale) ? newScale : 1;\n\n    newCTM.a = newScale; //x-scale\n    newCTM.d = newScale; //y-scale\n    newCTM.e = -this.viewBox.x * newScale; //x-transform\n    newCTM.f = -this.viewBox.y * newScale; //y-transform\n  }\n\n  if (this.options.center) {\n    var offsetX =\n        (this.options.width -\n          (this.viewBox.width + this.viewBox.x * 2) * newCTM.a) *\n        0.5,\n      offsetY =\n        (this.options.height -\n          (this.viewBox.height + this.viewBox.y * 2) * newCTM.a) *\n        0.5;\n\n    newCTM.e = offsetX;\n    newCTM.f = offsetY;\n  }\n\n  // Cache initial values. Based on activeState and fix+center opitons\n  this.originalState.zoom = newCTM.a;\n  this.originalState.x = newCTM.e;\n  this.originalState.y = newCTM.f;\n\n  return newCTM;\n};\n\n/**\n * Return originalState object. Safe to alter\n *\n * @return {Object}\n */\nShadowViewport.prototype.getOriginalState = function () {\n  return Utils.extend({}, this.originalState);\n};\n\n/**\n * Return actualState object. Safe to alter\n *\n * @return {Object}\n */\nShadowViewport.prototype.getState = function () {\n  return Utils.extend({}, this.activeState);\n};\n\n/**\n * Get zoom scale\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.getZoom = function () {\n  return this.activeState.zoom;\n};\n\n/**\n * Get zoom scale for pubilc usage\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.getRelativeZoom = function () {\n  return this.activeState.zoom / this.originalState.zoom;\n};\n\n/**\n * Compute zoom scale for pubilc usage\n *\n * @return {Float} zoom scale\n */\nShadowViewport.prototype.computeRelativeZoom = function (scale) {\n  return scale / this.originalState.zoom;\n};\n\n/**\n * Get pan\n *\n * @return {Object}\n */\nShadowViewport.prototype.getPan = function () {\n  return { x: this.activeState.x, y: this.activeState.y };\n};\n\n/**\n * Return cached viewport CTM value that can be safely modified\n *\n * @return {SVGMatrix}\n */\nShadowViewport.prototype.getCTM = function () {\n  var safeCTM = this.options.svg.createSVGMatrix();\n\n  // Copy values manually as in FF they are not itterable\n  safeCTM.a = this.activeState.zoom;\n  safeCTM.b = 0;\n  safeCTM.c = 0;\n  safeCTM.d = this.activeState.zoom;\n  safeCTM.e = this.activeState.x;\n  safeCTM.f = this.activeState.y;\n\n  return safeCTM;\n};\n\n/**\n * Set a new CTM\n *\n * @param {SVGMatrix} newCTM\n */\nShadowViewport.prototype.setCTM = function (newCTM) {\n  var willZoom = this.isZoomDifferent(newCTM),\n    willPan = this.isPanDifferent(newCTM);\n\n  if (willZoom || willPan) {\n    // Before zoom\n    if (willZoom) {\n      // If returns false then cancel zooming\n      if (\n        this.options.beforeZoom(\n          this.getRelativeZoom(),\n          this.computeRelativeZoom(newCTM.a)\n        ) === false\n      ) {\n        newCTM.a = newCTM.d = this.activeState.zoom;\n        willZoom = false;\n      } else {\n        this.updateCache(newCTM);\n        this.options.onZoom(this.getRelativeZoom());\n      }\n    }\n\n    // Before pan\n    if (willPan) {\n      var preventPan = this.options.beforePan(this.getPan(), {\n          x: newCTM.e,\n          y: newCTM.f,\n        }),\n        // If prevent pan is an object\n        preventPanX = false,\n        preventPanY = false;\n\n      // If prevent pan is Boolean false\n      if (preventPan === false) {\n        // Set x and y same as before\n        newCTM.e = this.getPan().x;\n        newCTM.f = this.getPan().y;\n\n        preventPanX = preventPanY = true;\n      } else if (Utils.isObject(preventPan)) {\n        // Check for X axes attribute\n        if (preventPan.x === false) {\n          // Prevent panning on x axes\n          newCTM.e = this.getPan().x;\n          preventPanX = true;\n        } else if (Utils.isNumber(preventPan.x)) {\n          // Set a custom pan value\n          newCTM.e = preventPan.x;\n        }\n\n        // Check for Y axes attribute\n        if (preventPan.y === false) {\n          // Prevent panning on x axes\n          newCTM.f = this.getPan().y;\n          preventPanY = true;\n        } else if (Utils.isNumber(preventPan.y)) {\n          // Set a custom pan value\n          newCTM.f = preventPan.y;\n        }\n      }\n\n      // Update willPan flag\n      // Check if newCTM is still different\n      if ((preventPanX && preventPanY) || !this.isPanDifferent(newCTM)) {\n        willPan = false;\n      } else {\n        this.updateCache(newCTM);\n        this.options.onPan(this.getPan());\n      }\n    }\n\n    // Check again if should zoom or pan\n    if (willZoom || willPan) {\n      this.updateCTMOnNextFrame();\n    }\n  }\n};\n\nShadowViewport.prototype.isZoomDifferent = function (newCTM) {\n  return this.activeState.zoom !== newCTM.a;\n};\n\nShadowViewport.prototype.isPanDifferent = function (newCTM) {\n  return this.activeState.x !== newCTM.e || this.activeState.y !== newCTM.f;\n};\n\n/**\n * Update cached CTM and active state\n *\n * @param {SVGMatrix} newCTM\n */\nShadowViewport.prototype.updateCache = function (newCTM) {\n  this.activeState.zoom = newCTM.a;\n  this.activeState.x = newCTM.e;\n  this.activeState.y = newCTM.f;\n};\n\nShadowViewport.prototype.pendingUpdate = false;\n\n/**\n * Place a request to update CTM on next Frame\n */\nShadowViewport.prototype.updateCTMOnNextFrame = function () {\n  if (!this.pendingUpdate) {\n    // Lock\n    this.pendingUpdate = true;\n\n    // Throttle next update\n    this.requestAnimationFrame.call(window, this.updateCTMCached);\n  }\n};\n\n/**\n * Update viewport CTM with cached CTM\n */\nShadowViewport.prototype.updateCTM = function () {\n  var ctm = this.getCTM();\n\n  // Updates SVG element\n  SvgUtils.setCTM(this.viewport, ctm, this.defs);\n\n  // Free the lock\n  this.pendingUpdate = false;\n\n  // Notify about the update\n  if (this.options.onUpdatedCTM) {\n    this.options.onUpdatedCTM(ctm);\n  }\n};\n\nmodule.exports = function (viewport, options) {\n  return new ShadowViewport(viewport, options);\n};\n","var Wheel = require(\"./uniwheel\"),\n  ControlIcons = require(\"./control-icons\"),\n  Utils = require(\"./utilities\"),\n  SvgUtils = require(\"./svg-utilities\"),\n  ShadowViewport = require(\"./shadow-viewport\");\n\nvar SvgPanZoom = function (svg, options) {\n  this.init(svg, options);\n};\n\nvar optionsDefaults = {\n  viewportSelector: \".svg-pan-zoom_viewport\", // Viewport selector. Can be querySelector string or SVGElement\n  panEnabled: true, // enable or disable panning (default enabled)\n  controlIconsEnabled: false, // insert icons to give user an option in addition to mouse events to control pan/zoom (default disabled)\n  zoomEnabled: true, // enable or disable zooming (default enabled)\n  dblClickZoomEnabled: true, // enable or disable zooming by double clicking (default enabled)\n  mouseWheelZoomEnabled: true, // enable or disable zooming by mouse wheel (default enabled)\n  preventMouseEventsDefault: true, // enable or disable preventDefault for mouse events\n  zoomScaleSensitivity: 0.1, // Zoom sensitivity\n  minZoom: 0.5, // Minimum Zoom level\n  maxZoom: 10, // Maximum Zoom level\n  fit: true, // enable or disable viewport fit in SVG (default true)\n  contain: false, // enable or disable viewport contain the svg (default false)\n  center: true, // enable or disable viewport centering in SVG (default true)\n  refreshRate: \"auto\", // Maximum number of frames per second (altering SVG's viewport)\n  beforeZoom: null,\n  onZoom: null,\n  beforePan: null,\n  onPan: null,\n  customEventsHandler: null,\n  eventsListenerElement: null,\n  onUpdatedCTM: null,\n};\n\nvar passiveListenerTrueOption = { passive: true };\nvar passiveListenerFalseOption = { passive: false };\n\nSvgPanZoom.prototype.init = function (svg, options) {\n  var that = this;\n\n  this.svg = svg;\n  this.defs = svg.querySelector(\"defs\");\n\n  // Add default attributes to SVG\n  SvgUtils.setupSvgAttributes(this.svg);\n\n  // Set options\n  this.options = Utils.extend(Utils.extend({}, optionsDefaults), options);\n\n  // Set default state\n  this.state = \"none\";\n\n  // Get dimensions\n  var boundingClientRectNormalized =\n    SvgUtils.getBoundingClientRectNormalized(svg);\n  this.width = boundingClientRectNormalized.width;\n  this.height = boundingClientRectNormalized.height;\n\n  // Init shadow viewport\n  this.viewport = ShadowViewport(\n    SvgUtils.getOrCreateViewport(this.svg, this.options.viewportSelector),\n    {\n      svg: this.svg,\n      width: this.width,\n      height: this.height,\n      fit: this.options.fit,\n      contain: this.options.contain,\n      center: this.options.center,\n      refreshRate: this.options.refreshRate,\n      // Put callbacks into functions as they can change through time\n      beforeZoom: function (oldScale, newScale) {\n        if (that.viewport && that.options.beforeZoom) {\n          return that.options.beforeZoom(oldScale, newScale);\n        }\n      },\n      onZoom: function (scale) {\n        if (that.viewport && that.options.onZoom) {\n          return that.options.onZoom(scale);\n        }\n      },\n      beforePan: function (oldPoint, newPoint) {\n        if (that.viewport && that.options.beforePan) {\n          return that.options.beforePan(oldPoint, newPoint);\n        }\n      },\n      onPan: function (point) {\n        if (that.viewport && that.options.onPan) {\n          return that.options.onPan(point);\n        }\n      },\n      onUpdatedCTM: function (ctm) {\n        if (that.viewport && that.options.onUpdatedCTM) {\n          return that.options.onUpdatedCTM(ctm);\n        }\n      },\n    }\n  );\n\n  // Wrap callbacks into public API context\n  var publicInstance = this.getPublicInstance();\n  publicInstance.setBeforeZoom(this.options.beforeZoom);\n  publicInstance.setOnZoom(this.options.onZoom);\n  publicInstance.setBeforePan(this.options.beforePan);\n  publicInstance.setOnPan(this.options.onPan);\n  publicInstance.setOnUpdatedCTM(this.options.onUpdatedCTM);\n\n  if (this.options.controlIconsEnabled) {\n    ControlIcons.enable(this);\n  }\n\n  // Init events handlers\n  this.lastMouseWheelEventTime = Date.now();\n  this.setupHandlers();\n};\n\n/**\n * Register event handlers\n */\nSvgPanZoom.prototype.setupHandlers = function () {\n  var that = this,\n    prevEvt = null; // use for touchstart event to detect double tap\n\n  this.eventListeners = {\n    // Mouse down group\n    pointerdown: function (evt) {\n      if (evt.pointerType === \"touch\") return;\n      var result = that.handleMouseDown(evt, prevEvt);\n      prevEvt = evt;\n      return result;\n    },\n    touchstart: function (evt) {\n      var result = that.handleTouchStart(evt, prevEvt);\n      prevEvt = evt;\n      return result;\n    },\n\n    // Mouse up group\n    pointerup: function (evt) {\n      if (evt.pointerType === \"touch\") return;\n      return that.handleMouseUp(evt);\n    },\n    touchend: function (evt) {\n      return that.handleTouchEnd(evt);\n    },\n\n    // Mouse move group\n    pointermove: function (evt) {\n      if (evt.pointerType === \"touch\") return;\n      return that.handleMouseMove(evt);\n    },\n    touchmove: function (evt) {\n      return that.handleTouchMove(evt);\n    },\n\n    // Mouse leave group\n    pointerleave: function (evt) {\n      if (evt.pointerType === \"touch\") return;\n      return that.handleMouseUp(evt);\n    },\n    pointercancel: function (evt) {\n      if (evt.pointerType === \"touch\") return;\n      return that.handleMouseUp(evt);\n    },\n    touchleave: function (evt) {\n      return that.handleTouchEnd(evt);\n    },\n    touchcancel: function (evt) {\n      return that.handleTouchEnd(evt);\n    },\n  };\n\n  // Init custom events handler if available\n  // eslint-disable-next-line eqeqeq\n  if (this.options.customEventsHandler != null) {\n    this.options.customEventsHandler.init({\n      svgElement: this.svg,\n      eventsListenerElement: this.options.eventsListenerElement,\n      instance: this.getPublicInstance(),\n    });\n\n    // Custom event handler may halt builtin listeners\n    var haltEventListeners =\n      this.options.customEventsHandler.haltEventListeners;\n    if (haltEventListeners && haltEventListeners.length) {\n      for (var i = haltEventListeners.length - 1; i >= 0; i--) {\n        if (this.eventListeners.hasOwnProperty(haltEventListeners[i])) {\n          delete this.eventListeners[haltEventListeners[i]];\n        }\n      }\n    }\n  }\n\n  // Bind eventListeners\n  for (var event in this.eventListeners) {\n    // Attach event to eventsListenerElement or SVG if not available\n    (this.options.eventsListenerElement || this.svg).addEventListener(\n      event,\n      this.eventListeners[event],\n      !this.options.preventMouseEventsDefault\n        ? passiveListenerTrueOption\n        : passiveListenerFalseOption\n    );\n  }\n\n  // Zoom using mouse wheel\n  if (this.options.mouseWheelZoomEnabled) {\n    this.options.mouseWheelZoomEnabled = false; // set to false as enable will set it back to true\n    this.enableMouseWheelZoom();\n  }\n};\n\n/**\n * Enable ability to zoom using mouse wheel\n */\nSvgPanZoom.prototype.enableMouseWheelZoom = function () {\n  if (!this.options.mouseWheelZoomEnabled) {\n    var that = this;\n\n    // Mouse wheel listener\n    this.wheelListener = function (evt) {\n      return that.handleMouseWheel(evt);\n    };\n\n    // Bind wheelListener\n    var isPassiveListener = !this.options.preventMouseEventsDefault;\n    Wheel.on(\n      this.options.eventsListenerElement || this.svg,\n      this.wheelListener,\n      isPassiveListener\n    );\n\n    this.options.mouseWheelZoomEnabled = true;\n  }\n};\n\n/**\n * Disable ability to zoom using mouse wheel\n */\nSvgPanZoom.prototype.disableMouseWheelZoom = function () {\n  if (this.options.mouseWheelZoomEnabled) {\n    var isPassiveListener = !this.options.preventMouseEventsDefault;\n    Wheel.off(\n      this.options.eventsListenerElement || this.svg,\n      this.wheelListener,\n      isPassiveListener\n    );\n    this.options.mouseWheelZoomEnabled = false;\n  }\n};\n\n/**\n * Handle mouse wheel event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleMouseWheel = function (evt) {\n  if (!this.options.zoomEnabled || this.state !== \"none\") {\n    return;\n  }\n\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  // Default delta in case that deltaY is not available\n  var delta = evt.deltaY || 1,\n    timeDelta = Date.now() - this.lastMouseWheelEventTime,\n    divider = 3 + Math.max(0, 30 - timeDelta);\n\n  // Update cache\n  this.lastMouseWheelEventTime = Date.now();\n\n  // Make empirical adjustments for browsers that give deltaY in pixels (deltaMode=0)\n  if (\"deltaMode\" in evt && evt.deltaMode === 0 && evt.wheelDelta) {\n    delta = evt.deltaY === 0 ? 0 : Math.abs(evt.wheelDelta) / evt.deltaY;\n  }\n\n  delta =\n    -0.3 < delta && delta < 0.3\n      ? delta\n      : ((delta > 0 ? 1 : -1) * Math.log(Math.abs(delta) + 10)) / divider;\n\n  var inversedScreenCTM = this.svg.getScreenCTM().inverse(),\n    relativeMousePoint = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(\n      inversedScreenCTM\n    ),\n    zoom = Math.pow(1 + this.options.zoomScaleSensitivity, -1 * delta); // multiplying by neg. 1 so as to make zoom in/out behavior match Google maps behavior\n\n  this.zoomAtPoint(zoom, relativeMousePoint);\n};\n\n/**\n * Zoom in at a SVG point\n *\n * @param  {SVGPoint} point\n * @param  {Float} zoomScale    Number representing how much to zoom\n * @param  {Boolean} zoomAbsolute Default false. If true, zoomScale is treated as an absolute value.\n *                                Otherwise, zoomScale is treated as a multiplied (e.g. 1.10 would zoom in 10%)\n */\nSvgPanZoom.prototype.zoomAtPoint = function (zoomScale, point, zoomAbsolute) {\n  var originalState = this.viewport.getOriginalState();\n\n  if (!zoomAbsolute) {\n    // Fit zoomScale in set bounds\n    if (\n      this.getZoom() * zoomScale <\n      this.options.minZoom * originalState.zoom\n    ) {\n      zoomScale = (this.options.minZoom * originalState.zoom) / this.getZoom();\n    } else if (\n      this.getZoom() * zoomScale >\n      this.options.maxZoom * originalState.zoom\n    ) {\n      zoomScale = (this.options.maxZoom * originalState.zoom) / this.getZoom();\n    }\n  } else {\n    // Fit zoomScale in set bounds\n    zoomScale = Math.max(\n      this.options.minZoom * originalState.zoom,\n      Math.min(this.options.maxZoom * originalState.zoom, zoomScale)\n    );\n    // Find relative scale to achieve desired scale\n    zoomScale = zoomScale / this.getZoom();\n  }\n\n  var oldCTM = this.viewport.getCTM(),\n    relativePoint = point.matrixTransform(oldCTM.inverse()),\n    modifier = this.svg\n      .createSVGMatrix()\n      .translate(relativePoint.x, relativePoint.y)\n      .scale(zoomScale)\n      .translate(-relativePoint.x, -relativePoint.y),\n    newCTM = oldCTM.multiply(modifier);\n\n  if (newCTM.a !== oldCTM.a) {\n    this.viewport.setCTM(newCTM);\n  }\n};\n\n/**\n * Zoom at center point\n *\n * @param  {Float} scale\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.zoom = function (scale, absolute) {\n  this.zoomAtPoint(\n    scale,\n    SvgUtils.getSvgCenterPoint(this.svg, this.width, this.height),\n    absolute\n  );\n};\n\n/**\n * Zoom used by public instance\n *\n * @param  {Float} scale\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.publicZoom = function (scale, absolute) {\n  if (absolute) {\n    scale = this.computeFromRelativeZoom(scale);\n  }\n\n  this.zoom(scale, absolute);\n};\n\n/**\n * Zoom at point used by public instance\n *\n * @param  {Float} scale\n * @param  {SVGPoint|Object} point    An object that has x and y attributes\n * @param  {Boolean} absolute Marks zoom scale as relative or absolute\n */\nSvgPanZoom.prototype.publicZoomAtPoint = function (scale, point, absolute) {\n  if (absolute) {\n    // Transform zoom into a relative value\n    scale = this.computeFromRelativeZoom(scale);\n  }\n\n  // If not a SVGPoint but has x and y then create a SVGPoint\n  if (Utils.getType(point) !== \"SVGPoint\") {\n    if (\"x\" in point && \"y\" in point) {\n      point = SvgUtils.createSVGPoint(this.svg, point.x, point.y);\n    } else {\n      throw new Error(\"Given point is invalid\");\n    }\n  }\n\n  this.zoomAtPoint(scale, point, absolute);\n};\n\n/**\n * Get zoom scale\n *\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.getZoom = function () {\n  return this.viewport.getZoom();\n};\n\n/**\n * Get zoom scale for public usage\n *\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.getRelativeZoom = function () {\n  return this.viewport.getRelativeZoom();\n};\n\n/**\n * Compute actual zoom from public zoom\n *\n * @param  {Float} zoom\n * @return {Float} zoom scale\n */\nSvgPanZoom.prototype.computeFromRelativeZoom = function (zoom) {\n  return zoom * this.viewport.getOriginalState().zoom;\n};\n\n/**\n * Set zoom to initial state\n */\nSvgPanZoom.prototype.resetZoom = function () {\n  var originalState = this.viewport.getOriginalState();\n\n  this.zoom(originalState.zoom, true);\n};\n\n/**\n * Set pan to initial state\n */\nSvgPanZoom.prototype.resetPan = function () {\n  this.pan(this.viewport.getOriginalState());\n};\n\n/**\n * Set pan and zoom to initial state\n */\nSvgPanZoom.prototype.reset = function () {\n  this.resetZoom();\n  this.resetPan();\n};\n\n/**\n * Handle double click event\n * See handleMouseDown() for alternate detection method\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleDblClick = function (evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  // Check if target was a control button\n  if (this.options.controlIconsEnabled) {\n    var targetClass = evt.target.getAttribute(\"class\") || \"\";\n    if (targetClass.indexOf(\"svg-pan-zoom-control\") > -1) {\n      return false;\n    }\n  }\n\n  var zoomFactor;\n\n  if (evt.shiftKey) {\n    zoomFactor = 1 / ((1 + this.options.zoomScaleSensitivity) * 2); // zoom out when shift key pressed\n  } else {\n    zoomFactor = (1 + this.options.zoomScaleSensitivity) * 2;\n  }\n\n  var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(\n    this.svg.getScreenCTM().inverse()\n  );\n  this.zoomAtPoint(zoomFactor, point);\n};\n\n/**\n * Handle click event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleMouseDown = function (evt, prevEvt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  Utils.mouseAndTouchNormalize(evt, this.svg);\n\n  // Double click detection; more consistent than ondblclick\n  if (this.options.dblClickZoomEnabled && Utils.isDblClick(evt, prevEvt)) {\n    this.handleDblClick(evt);\n  } else {\n    // Pan mode\n    this.state = \"pan\";\n    this.firstEventCTM = this.viewport.getCTM();\n    this.stateOrigin = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(\n      this.firstEventCTM.inverse()\n    );\n  }\n};\n\n/**\n * Handle mouse move event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleMouseMove = function (evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  if (this.state === \"pan\" && this.options.panEnabled) {\n    // Pan mode\n    var point = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(\n        this.firstEventCTM.inverse()\n      ),\n      viewportCTM = this.firstEventCTM.translate(\n        point.x - this.stateOrigin.x,\n        point.y - this.stateOrigin.y\n      );\n\n    this.viewport.setCTM(viewportCTM);\n  }\n};\n\n/**\n * Handle mouse button release event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleMouseUp = function (evt) {\n  if (this.options.preventMouseEventsDefault) {\n    if (evt.preventDefault) {\n      evt.preventDefault();\n    } else {\n      evt.returnValue = false;\n    }\n  }\n\n  if (this.state === \"pan\") {\n    // Quit pan mode\n    this.state = \"none\";\n  }\n};\n\n/**\n * Handle click event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleTouchStart = function (evt, prevEvt) {\n  if (evt.touches.length == 1) {\n    this.handleMouseDown(evt, prevEvt);\n  } else {\n    if (this.options.preventMouseEventsDefault) {\n      if (evt.preventDefault) {\n        evt.preventDefault();\n      } else {\n        evt.returnValue = false;\n      }\n    }\n\n    this.firstEventCTM = this.viewport.getCTM();\n    var touch1 = SvgUtils.getTouchPoint(evt, this.svg, 0);\n    var touch2 = SvgUtils.getTouchPoint(evt, this.svg, 1);\n    this.firstDistance = Utils.calculateDistance(touch1, touch2);\n    touch1.x = (touch1.x + touch2.x) / 2;\n    touch1.y = (touch1.y + touch2.y) / 2;\n    this.stateOrigin = touch1.matrixTransform(this.firstEventCTM.inverse());\n    this.firstZoomLevel = this.getZoom();\n  }\n};\n\n/**\n * Handle mouse move event\n *\n * @param  {Event} evt\n */\nSvgPanZoom.prototype.handleTouchMove = function (evt) {\n  if (evt.touches.length == 1) {\n    this.handleMouseMove(evt);\n  } else {\n    // pan and zoom\n    if (this.options.preventMouseEventsDefault) {\n      if (evt.preventDefault) {\n        evt.preventDefault();\n      } else {\n        evt.returnValue = false;\n      }\n    }\n    if (!this.options.panEnabled && !this.options.zoomEnabled) {\n      return;\n    }\n\n    var touch1 = SvgUtils.getTouchPoint(evt, this.svg, 0);\n    var touch2 = SvgUtils.getTouchPoint(evt, this.svg, 1);\n    var center = this.svg.createSVGPoint();\n    center.x = (touch1.x + touch2.x) / 2;\n    center.y = (touch1.y + touch2.y) / 2;\n\n    if (this.state === \"pan\" && this.options.panEnabled) {\n      // Pan mode\n      var point = center.matrixTransform(this.firstEventCTM.inverse());\n      var viewportCTM = this.firstEventCTM.translate(\n        point.x - this.stateOrigin.x,\n        point.y - this.stateOrigin.y\n      );\n      this.viewport.setCTM(viewportCTM);\n    }\n\n    if (this.options.zoomEnabled) {\n      // zoom\n      var distance = Utils.calculateDistance(touch1, touch2);\n      var scale = distance / this.firstDistance;\n      var inversedScreenCTM = this.svg.getScreenCTM().inverse();\n      var relativeTouchPoint = center.matrixTransform(inversedScreenCTM);\n      this.zoomAtPoint(this.firstZoomLevel * scale, relativeTouchPoint, true);\n    }\n  }\n};\n\n/**\n * Handle mouse button release event\n *\n * @param {Event} evt\n */\nSvgPanZoom.prototype.handleTouchEnd = function (evt) {\n  if (evt.touches.length == 0) {\n    this.handleMouseUp(evt);\n  } else {\n    if (this.options.preventMouseEventsDefault) {\n      if (evt.preventDefault) {\n        evt.preventDefault();\n      } else {\n        evt.returnValue = false;\n      }\n    }\n\n    this.firstEventCTM = this.viewport.getCTM();\n    if (evt.touches.length == 1) {\n      this.stateOrigin = SvgUtils.getEventPoint(evt, this.svg).matrixTransform(\n        this.firstEventCTM.inverse()\n      );\n    } else {\n      var touch1 = SvgUtils.getTouchPoint(evt, this.svg, 0);\n      var touch2 = SvgUtils.getTouchPoint(evt, this.svg, 1);\n      this.firstDistance = Utils.calculateDistance(touch1, touch2);\n      touch1.x = (touch1.x + touch2.x) / 2;\n      touch1.y = (touch1.y + touch2.y) / 2;\n      this.stateOrigin = touch1.matrixTransform(this.firstEventCTM.inverse());\n    }\n  }\n};\n\n/**\n * Adjust viewport size (only) so it will fit in SVG\n * Does not center image\n */\nSvgPanZoom.prototype.fit = function () {\n  var viewBox = this.viewport.getViewBox(),\n    newScale = Math.min(\n      this.width / viewBox.width,\n      this.height / viewBox.height\n    );\n\n  this.zoom(newScale, true);\n};\n\n/**\n * Adjust viewport size (only) so it will contain the SVG\n * Does not center image\n */\nSvgPanZoom.prototype.contain = function () {\n  var viewBox = this.viewport.getViewBox(),\n    newScale = Math.max(\n      this.width / viewBox.width,\n      this.height / viewBox.height\n    );\n\n  this.zoom(newScale, true);\n};\n\n/**\n * Adjust viewport pan (only) so it will be centered in SVG\n * Does not zoom/fit/contain image\n */\nSvgPanZoom.prototype.center = function () {\n  var viewBox = this.viewport.getViewBox(),\n    offsetX =\n      (this.width - (viewBox.width + viewBox.x * 2) * this.getZoom()) * 0.5,\n    offsetY =\n      (this.height - (viewBox.height + viewBox.y * 2) * this.getZoom()) * 0.5;\n\n  this.getPublicInstance().pan({ x: offsetX, y: offsetY });\n};\n\n/**\n * Update content cached BorderBox\n * Use when viewport contents change\n */\nSvgPanZoom.prototype.updateBBox = function () {\n  this.viewport.simpleViewBoxCache();\n};\n\n/**\n * Pan to a rendered position\n *\n * @param  {Object} point {x: 0, y: 0}\n */\nSvgPanZoom.prototype.pan = function (point) {\n  var viewportCTM = this.viewport.getCTM();\n  viewportCTM.e = point.x;\n  viewportCTM.f = point.y;\n  this.viewport.setCTM(viewportCTM);\n};\n\n/**\n * Relatively pan the graph by a specified rendered position vector\n *\n * @param  {Object} point {x: 0, y: 0}\n */\nSvgPanZoom.prototype.panBy = function (point) {\n  var viewportCTM = this.viewport.getCTM();\n  viewportCTM.e += point.x;\n  viewportCTM.f += point.y;\n  this.viewport.setCTM(viewportCTM);\n};\n\n/**\n * Get pan vector\n *\n * @return {Object} {x: 0, y: 0}\n */\nSvgPanZoom.prototype.getPan = function () {\n  var state = this.viewport.getState();\n\n  return { x: state.x, y: state.y };\n};\n\n/**\n * Recalculates cached svg dimensions and controls position\n */\nSvgPanZoom.prototype.resize = function () {\n  // Get dimensions\n  var boundingClientRectNormalized = SvgUtils.getBoundingClientRectNormalized(\n    this.svg\n  );\n  this.width = boundingClientRectNormalized.width;\n  this.height = boundingClientRectNormalized.height;\n\n  // Recalculate original state\n  var viewport = this.viewport;\n  viewport.options.width = this.width;\n  viewport.options.height = this.height;\n  viewport.processCTM();\n\n  // Reposition control icons by re-enabling them\n  if (this.options.controlIconsEnabled) {\n    this.getPublicInstance().disableControlIcons();\n    this.getPublicInstance().enableControlIcons();\n  }\n};\n\n/**\n * Unbind mouse events, free callbacks and destroy public instance\n */\nSvgPanZoom.prototype.destroy = function () {\n  var that = this;\n\n  // Free callbacks\n  this.beforeZoom = null;\n  this.onZoom = null;\n  this.beforePan = null;\n  this.onPan = null;\n  this.onUpdatedCTM = null;\n\n  // Destroy custom event handlers\n  // eslint-disable-next-line eqeqeq\n  if (this.options.customEventsHandler != null) {\n    this.options.customEventsHandler.destroy({\n      svgElement: this.svg,\n      eventsListenerElement: this.options.eventsListenerElement,\n      instance: this.getPublicInstance(),\n    });\n  }\n\n  // Unbind eventListeners\n  for (var event in this.eventListeners) {\n    (this.options.eventsListenerElement || this.svg).removeEventListener(\n      event,\n      this.eventListeners[event],\n      !this.options.preventMouseEventsDefault\n        ? passiveListenerTrueOption\n        : passiveListenerFalseOption\n    );\n  }\n\n  // Unbind wheelListener\n  this.disableMouseWheelZoom();\n\n  // Remove control icons\n  this.getPublicInstance().disableControlIcons();\n\n  // Remove instance from instancesStore\n  instancesStore = instancesStore.filter(function (instance) {\n    return instance.svg !== that.svg;\n  });\n\n  // Delete options and its contents\n  delete this.options;\n\n  // Delete viewport to make public shadow viewport functions uncallable\n  delete this.viewport;\n\n  // Destroy public instance and rewrite getPublicInstance\n  delete this.publicInstance;\n  delete this.pi;\n  this.getPublicInstance = function () {\n    return null;\n  };\n};\n\n/**\n * Returns a public instance object\n *\n * @return {Object} Public instance object\n */\nSvgPanZoom.prototype.getPublicInstance = function () {\n  var that = this;\n\n  // Create cache\n  if (!this.publicInstance) {\n    this.publicInstance = this.pi = {\n      // Pan\n      enablePan: function () {\n        that.options.panEnabled = true;\n        return that.pi;\n      },\n      disablePan: function () {\n        that.options.panEnabled = false;\n        return that.pi;\n      },\n      isPanEnabled: function () {\n        return !!that.options.panEnabled;\n      },\n      pan: function (point) {\n        that.pan(point);\n        return that.pi;\n      },\n      panBy: function (point) {\n        that.panBy(point);\n        return that.pi;\n      },\n      getPan: function () {\n        return that.getPan();\n      },\n      // Pan event\n      setBeforePan: function (fn) {\n        that.options.beforePan =\n          fn === null ? null : Utils.proxy(fn, that.publicInstance);\n        return that.pi;\n      },\n      setOnPan: function (fn) {\n        that.options.onPan =\n          fn === null ? null : Utils.proxy(fn, that.publicInstance);\n        return that.pi;\n      },\n      // Zoom and Control Icons\n      enableZoom: function () {\n        that.options.zoomEnabled = true;\n        return that.pi;\n      },\n      disableZoom: function () {\n        that.options.zoomEnabled = false;\n        return that.pi;\n      },\n      isZoomEnabled: function () {\n        return !!that.options.zoomEnabled;\n      },\n      enableControlIcons: function () {\n        if (!that.options.controlIconsEnabled) {\n          that.options.controlIconsEnabled = true;\n          ControlIcons.enable(that);\n        }\n        return that.pi;\n      },\n      disableControlIcons: function () {\n        if (that.options.controlIconsEnabled) {\n          that.options.controlIconsEnabled = false;\n          ControlIcons.disable(that);\n        }\n        return that.pi;\n      },\n      isControlIconsEnabled: function () {\n        return !!that.options.controlIconsEnabled;\n      },\n      // Double click zoom\n      enableDblClickZoom: function () {\n        that.options.dblClickZoomEnabled = true;\n        return that.pi;\n      },\n      disableDblClickZoom: function () {\n        that.options.dblClickZoomEnabled = false;\n        return that.pi;\n      },\n      isDblClickZoomEnabled: function () {\n        return !!that.options.dblClickZoomEnabled;\n      },\n      // Mouse wheel zoom\n      enableMouseWheelZoom: function () {\n        that.enableMouseWheelZoom();\n        return that.pi;\n      },\n      disableMouseWheelZoom: function () {\n        that.disableMouseWheelZoom();\n        return that.pi;\n      },\n      isMouseWheelZoomEnabled: function () {\n        return !!that.options.mouseWheelZoomEnabled;\n      },\n      // Zoom scale and bounds\n      setZoomScaleSensitivity: function (scale) {\n        that.options.zoomScaleSensitivity = scale;\n        return that.pi;\n      },\n      setMinZoom: function (zoom) {\n        that.options.minZoom = zoom;\n        return that.pi;\n      },\n      setMaxZoom: function (zoom) {\n        that.options.maxZoom = zoom;\n        return that.pi;\n      },\n      // Zoom event\n      setBeforeZoom: function (fn) {\n        that.options.beforeZoom =\n          fn === null ? null : Utils.proxy(fn, that.publicInstance);\n        return that.pi;\n      },\n      setOnZoom: function (fn) {\n        that.options.onZoom =\n          fn === null ? null : Utils.proxy(fn, that.publicInstance);\n        return that.pi;\n      },\n      // Zooming\n      zoom: function (scale) {\n        that.publicZoom(scale, true);\n        return that.pi;\n      },\n      zoomBy: function (scale) {\n        that.publicZoom(scale, false);\n        return that.pi;\n      },\n      zoomAtPoint: function (scale, point) {\n        that.publicZoomAtPoint(scale, point, true);\n        return that.pi;\n      },\n      zoomAtPointBy: function (scale, point) {\n        that.publicZoomAtPoint(scale, point, false);\n        return that.pi;\n      },\n      zoomIn: function () {\n        this.zoomBy(1 + that.options.zoomScaleSensitivity);\n        return that.pi;\n      },\n      zoomOut: function () {\n        this.zoomBy(1 / (1 + that.options.zoomScaleSensitivity));\n        return that.pi;\n      },\n      getZoom: function () {\n        return that.getRelativeZoom();\n      },\n      // CTM update\n      setOnUpdatedCTM: function (fn) {\n        that.options.onUpdatedCTM =\n          fn === null ? null : Utils.proxy(fn, that.publicInstance);\n        return that.pi;\n      },\n      // Reset\n      resetZoom: function () {\n        that.resetZoom();\n        return that.pi;\n      },\n      resetPan: function () {\n        that.resetPan();\n        return that.pi;\n      },\n      reset: function () {\n        that.reset();\n        return that.pi;\n      },\n      // Fit, Contain and Center\n      fit: function () {\n        that.fit();\n        return that.pi;\n      },\n      contain: function () {\n        that.contain();\n        return that.pi;\n      },\n      center: function () {\n        that.center();\n        return that.pi;\n      },\n      // Size and Resize\n      updateBBox: function () {\n        that.updateBBox();\n        return that.pi;\n      },\n      resize: function () {\n        that.resize();\n        return that.pi;\n      },\n      getSizes: function () {\n        return {\n          width: that.width,\n          height: that.height,\n          realZoom: that.getZoom(),\n          viewBox: that.viewport.getViewBox(),\n        };\n      },\n      // Destroy\n      destroy: function () {\n        that.destroy();\n        return that.pi;\n      },\n    };\n  }\n\n  return this.publicInstance;\n};\n\n/**\n * Stores pairs of instances of SvgPanZoom and SVG\n * Each pair is represented by an object {svg: SVGSVGElement, instance: SvgPanZoom}\n *\n * @type {Array}\n */\nvar instancesStore = [];\n\nvar svgPanZoom = function (elementOrSelector, options) {\n  var svg = Utils.getSvg(elementOrSelector);\n\n  if (svg === null) {\n    return null;\n  } else {\n    // Look for existent instance\n    for (var i = instancesStore.length - 1; i >= 0; i--) {\n      if (instancesStore[i].svg === svg) {\n        return instancesStore[i].instance.getPublicInstance();\n      }\n    }\n\n    // If instance not found - create one\n    instancesStore.push({\n      svg: svg,\n      instance: new SvgPanZoom(svg, options),\n    });\n\n    // Return just pushed instance\n    return instancesStore[\n      instancesStore.length - 1\n    ].instance.getPublicInstance();\n  }\n};\n\nmodule.exports = svgPanZoom;\n","import svgPanZoom, * as SvgPanZoom from \"@dash14/svg-pan-zoom\"\n\nexport interface Box {\n  top: number\n  bottom: number\n  left: number\n  right: number\n}\n\ninterface ViewArea {\n  box: Box\n  center: SvgPanZoom.Point\n}\n\nexport interface SvgPanZoomInstance extends SvgPanZoom.Instance {\n  getViewArea(): ViewArea\n  getViewBox(): Box\n  setViewBox(box: Box): void\n  getRealZoom(): number\n  applyAbsoluteZoomLevel(zoomLevel: number, minZoomLevel: number, maxZoomLevel: number): void\n  setPanEnabled(enabled: boolean): SvgPanZoomInstance\n  setZoomEnabled(enabled: boolean): SvgPanZoomInstance\n}\n\nexport interface CustomEventOptions {\n  svgElement: SVGSVGElement;\n  instance: SvgPanZoomInstance;\n}\n\nexport interface CustomEventHandler {\n  init: (options: CustomEventOptions) => void;\n  haltEventListeners: string[];\n  destroy: (options: CustomEventOptions) => void;\n}\n\nexport interface SvgPanZoomOptions extends Omit<SvgPanZoom.Options, \"customEventsHandler\"> {\n  customEventsHandler?: CustomEventHandler; // (default null)\n}\n\nexport interface SvgPanZoomInternal extends SvgPanZoomInstance {\n  _isPanEnabled: boolean\n  _isZoomEnabled: boolean\n  _internalIsPanEnabled(): boolean\n  _internalEnablePan(): void\n  _internalDisablePan(): void\n  _internalIsZoomEnabled(): boolean\n  _internalEnableZoom(): void\n  _internalDisableZoom(): void\n}\n\nconst methods: Partial<SvgPanZoomInternal> = {\n  getViewArea(this: SvgPanZoomInternal) {\n    const sizes = this.getSizes()\n    const pan = this.getPan()\n    const scale = sizes.realZoom\n    pan.x /= scale\n    pan.y /= scale\n    const viewport = {\n      width: sizes.width / scale,\n      height: sizes.height / scale,\n    }\n    return {\n      box: {\n        top: -pan.y,\n        bottom: viewport.height - pan.y,\n        left: -pan.x,\n        right: viewport.width - pan.x,\n      },\n      center: {\n        x: viewport.width / 2 - pan.x,\n        y: viewport.height / 2 - pan.y,\n      },\n    }\n  },\n  getViewBox(this: SvgPanZoomInternal): Box {\n    return this.getViewArea().box\n  },\n  setViewBox(this: SvgPanZoomInternal, box: Box) {\n    // Adjust zoom and pan to include the box.\n    // If the aspect ratio is different from the box, pan to\n    // include the box with keeping the center.\n    const width = box.right - box.left\n    const height = box.bottom - box.top\n    const { width: sizeWidth, height: sizeHeight } = this.getSizes()\n    const ratio = width / height\n    const currentRatio = sizeWidth / sizeHeight\n    const newWidth = ratio < currentRatio ? height * currentRatio : width\n    const newHeight = ratio > currentRatio ? width / currentRatio : height\n    const absoluteZoom = Math.min(\n      sizeWidth / newWidth,\n      sizeHeight / newHeight\n    )\n    const realZoom = this.getRealZoom()\n    const relativeZoom = this.getZoom()\n    const originalZoom = realZoom / relativeZoom\n    this.zoom(absoluteZoom / originalZoom)\n\n    const center = {\n      x: (box.left + width / 2) * absoluteZoom,\n      y: (box.top + height / 2) * absoluteZoom\n    }\n    this.pan({\n      x: -(center.x) + newWidth / 2 * absoluteZoom,\n      y: -(center.y) + newHeight / 2 * absoluteZoom\n    })\n  },\n  getRealZoom(this: SvgPanZoomInternal) {\n    return this.getSizes().realZoom\n  },\n  applyAbsoluteZoomLevel(this: SvgPanZoomInternal, zoomLevel: number, minZoomLevel: number, maxZoomLevel: number) {\n    // normalize\n    const min = Math.max(0.0001, minZoomLevel)\n    const max = Math.max(min, maxZoomLevel)\n    const zoom = Math.max(Math.min(max, zoomLevel), min)\n\n    const realZoom = this.getRealZoom()\n    const relativeZoom = this.getZoom()\n    const originalZoom = realZoom / relativeZoom\n\n    this.setMinZoom(min / originalZoom)\n      .setMaxZoom(max / originalZoom)\n      .zoom(zoom / originalZoom)\n  },\n  isPanEnabled(this: SvgPanZoomInternal) {\n    return this._isPanEnabled\n  },\n  enablePan(this: SvgPanZoomInternal) {\n    this._isPanEnabled = true\n    this._internalEnablePan()\n    return this\n  },\n  disablePan(this: SvgPanZoomInternal) {\n    this._isPanEnabled = false\n    this._internalDisablePan()\n    return this\n  },\n  isZoomEnabled(this: SvgPanZoomInternal) {\n    return this._isZoomEnabled\n  },\n  enableZoom(this: SvgPanZoomInternal) {\n    this._isZoomEnabled = true\n    this._internalEnableZoom()\n    return this\n  },\n  disableZoom(this: SvgPanZoomInternal) {\n    this._isZoomEnabled = false\n    this._internalDisableZoom()\n    return this\n  },\n  setPanEnabled(this: SvgPanZoomInternal, enabled: boolean) {\n    if (enabled) {\n      this.enablePan()\n    } else {\n      this.disablePan()\n    }\n    return this\n  },\n  setZoomEnabled(this: SvgPanZoomInternal, enabled: boolean) {\n    if (enabled) {\n      this.enableZoom()\n      this.enableDblClickZoom()\n    } else {\n      this.disableZoom()\n      this.disableDblClickZoom()\n    }\n    return this\n  },\n}\n\nfunction constructor(\n  svgPanZoom: SvgPanZoom.Instance,\n  options: SvgPanZoomOptions,\n): SvgPanZoomInternal {\n  const instance = svgPanZoom as SvgPanZoomInternal\n  instance._isPanEnabled = options.panEnabled ?? true\n  instance._isZoomEnabled = options?.zoomEnabled ?? true\n  instance._internalIsPanEnabled = instance.isPanEnabled\n  instance._internalEnablePan = instance.enablePan\n  instance._internalDisablePan = instance.disablePan\n  instance._internalIsZoomEnabled = instance.isZoomEnabled\n  instance._internalEnableZoom = instance.enableZoom\n  instance._internalDisableZoom = instance.disableZoom\n  Object.assign(svgPanZoom, methods)\n  return instance\n}\n\nexport function createSvgPanZoomEx(\n  svg: SVGElement,\n  options: SvgPanZoomOptions\n): SvgPanZoomInstance {\n\n  const userInit = options.customEventsHandler?.init ?? ((_: any) => {})\n  const userDestroy = options.customEventsHandler?.destroy ?? ((_: any) => {})\n  const haltEventListeners = options.customEventsHandler?.haltEventListeners ?? []\n\n  if (options.mouseWheelZoomEnabled === undefined) {\n    options.mouseWheelZoomEnabled = options.zoomEnabled\n  }\n\n  options.customEventsHandler = {\n    init: o => {\n      constructor(o.instance, options)\n      userInit(o)\n    },\n    destroy: o => userDestroy(o),\n    haltEventListeners\n  }\n\n  return svgPanZoom(svg, options as SvgPanZoom.Options) as SvgPanZoomInternal\n}\n","import { ref, Ref, onMounted, onUnmounted } from \"vue\"\nimport { nonNull } from \"@/common/common\"\nimport { createSvgPanZoomEx, SvgPanZoomInstance, SvgPanZoomOptions } from \"@/modules/svg-pan-zoom-ex\"\n\ntype Callback = () => void\n\nenum State {\n  INITIAL = 0,\n  MOUNTED = 1,\n  UNMOUNTED = 2\n}\n\nexport function useSvgPanZoom(svg: Ref<SVGSVGElement | undefined>, options: SvgPanZoomOptions) {\n  const instance = ref<SvgPanZoomInstance>()\n  let state = State.INITIAL\n  const mountedCallbacks: Callback[] = []\n  const unmountedCallbacks: Callback[] = []\n\n  const instanceMounted = () => {\n    state = State.MOUNTED\n    mountedCallbacks.forEach(c => c())\n    mountedCallbacks.length = 0 // clear\n  }\n\n  const instanceUnmounted = () => {\n    state = State.UNMOUNTED\n    unmountedCallbacks.forEach(c => c())\n    unmountedCallbacks.length = 0 // clear\n  }\n\n  onMounted(() => {\n    const element = nonNull(svg.value, \"<svg>\")\n    // hook init/destroy custom events\n    const userInit = options.customEventsHandler?.init ?? ((_: any) => {})\n    const userDestroy = options.customEventsHandler?.destroy ?? ((_: any) => {})\n    const haltEventListeners = options.customEventsHandler?.haltEventListeners ?? []\n\n    options.customEventsHandler = {\n      init: o => {\n        instance.value = o.instance\n        userInit(o)\n        instanceMounted()\n      },\n      destroy: o => {\n        instanceUnmounted()\n        userDestroy(o)\n      },\n      haltEventListeners\n    }\n\n    const initialize = () => {\n      const rect = element.getBoundingClientRect()\n      // In svg-pan-zoom, the shadow viewport is generated based with\n      // size on initialization. At this time, if the width and height\n      // are zero, an exception will occur during the calculation.\n      // Therefore, initialization is performed after allocating the area.\n      // Note that even after onMounted, the area is not allocated at\n      // the time of page switching with Nuxt.\n      if (rect.width !== 0 && rect.height !== 0) {\n        createSvgPanZoomEx(element, options)\n      } else {\n        setTimeout(initialize, 200)\n      }\n    }\n    initialize()\n  })\n\n  onUnmounted(() => {\n    instance.value?.destroy()\n    instance.value = undefined\n  })\n\n  const onSvgPanZoomMounted = (callback: Callback) => {\n    if (state === State.INITIAL) {\n      mountedCallbacks.push(callback)\n    } else if (state === State.MOUNTED) {\n      callback()\n    }\n  }\n\n  const onSvgPanZoomUnmounted = (callback: Callback) => {\n    if (state === State.INITIAL || state === State.MOUNTED) {\n      unmountedCallbacks.push(callback)\n    } else {\n      callback()\n    }\n  }\n\n  return { svgPanZoom: instance, onSvgPanZoomMounted, onSvgPanZoomUnmounted }\n}\n","import { provide, inject, InjectionKey, Ref, computed } from \"vue\"\nimport { nonNull } from \"@/common/common\"\nimport { ViewConfig } from \"@/common/configs\"\n\ninterface ZoomProvides {\n  zoomLevel: Ref<number>,\n  scale: Ref<number>\n}\n\nconst zoomLevelKey = Symbol(\"zoomLevel\") as InjectionKey<ZoomProvides>\n\nexport function provideZoomLevel(zoomLevel: Ref<number>, viewStyle: ViewConfig) {\n  const scale = computed(() => {\n    return viewStyle.scalingObjects ? 1 : (1 / zoomLevel.value)\n  })\n  provide(zoomLevelKey, {\n    zoomLevel,\n    scale\n  })\n  return { scale }\n}\n\nexport function useZoomLevel(): ZoomProvides {\n  return nonNull(inject(zoomLevelKey), \"zoomLevel\")\n}\n","import { nextTick, ref } from \"vue\"\n\ntype TimingFunction = \"ease\" | \"linear\" | \"ease-in\" | \"ease-out\" | \"ease-in-out\" | string\n\n/** Parameters of transition */\ninterface TransitionParameters {\n  enabled: boolean\n  duration: number\n  timingFunction: TimingFunction\n}\n\ntype CallbackFunction = () => void | Promise<void>\n\nfunction isPromise(obj: any): boolean {\n  return obj instanceof Promise || (obj && typeof obj.then === \"function\")\n}\n\nexport function useTransitionWhile() {\n  let timerId: number | null = null\n  const transitionOption = ref<TransitionParameters>({\n    enabled: false,\n    duration: 300,\n    timingFunction: \"linear\"\n  })\n\n  function transitionWhile(\n    func: CallbackFunction,\n    duration = 300,\n    timingFunction: TimingFunction = \"linear\"\n  ) {\n    if (timerId) {\n      clearTimeout(timerId)\n      timerId = null\n    }\n    transitionOption.value = {\n      enabled: true,\n      duration,\n      timingFunction\n    }\n\n    nextTick(async () => {\n      const promise = func()\n      if (isPromise(promise)) {\n        await promise\n      }\n\n      if (timerId) {\n        clearTimeout(timerId)\n      }\n      timerId = window?.setTimeout(() => {\n        transitionOption.value.enabled = false\n        timerId = null\n      }, duration)\n    })\n  }\n\n  return { transitionWhile, transitionOption }\n}\n\n","import { ref, Ref, watchEffect } from \"vue\"\nimport { InputPaths, Path } from \"@/common/types\"\n\nexport function useTranslatePathsToObject(input: Ref<InputPaths>) {\n  const objects = ref<Record<string, Path>>({})\n\n  const isInCompatibilityModeForPath = ref(false)\n  let nextId = 1\n  const idStore = new Map<Path, string>()\n\n  // translate for compatibility\n  watchEffect(() => {\n    if (input.value instanceof Array) {\n      const containKeys = new Set<string>([])\n      objects.value = Object.fromEntries(\n        input.value.map(path => {\n          let id = path.id\n          if (!id) {\n            if (!isInCompatibilityModeForPath.value) {\n              isInCompatibilityModeForPath.value = true\n              console.warn(\n                \"[v-network-graph] Please specify the `id` field for the `Path` object.\" +\n                  \" Currently, this works for compatibility,\" +\n                  \" but in the future, the id field will be required.\"\n              )\n            }\n            id = idStore.get(path)\n            if (!id) {\n              id = \"path-\" + nextId++\n              idStore.set(path, id)\n            }\n          }\n          containKeys.add(id)\n          return [id, path]\n        })\n      )\n      if (isInCompatibilityModeForPath.value) {\n        for (const [path, id] of Array.from(idStore.entries())) {\n          if (!containKeys.has(id)) {\n            idStore.delete(path)\n          }\n        }\n      }\n    } else {\n      objects.value = input.value\n    }\n  })\n\n  return { objects, isInCompatibilityModeForPath }\n}\n","import { watch, reactive, ref, Ref } from \"vue\"\nimport { isEqual } from \"lodash-es\"\nimport { Reactive } from \"../common/common\"\n\nexport function bindProp<T extends object, K extends keyof T>(\n  props: T,\n  name: K,\n  emit: (event: `update:${K & string}`, ...args: any[]) => void,\n  filter?: (arg: T[K]) => T[K]\n): Ref<T[K]> {\n  // Build two-way binding ties.\n\n  // Since it is not always passed in props (emit does not\n  // rewrite it), always keep a ref for self management.\n\n  if (filter) {\n    const prop = ref<T[K]>(filter(props[name])) as Ref<T[K]>\n    const update = (filtered: T[K]) => {\n      if (!isEqual(filtered, prop.value)) {\n        prop.value = filtered\n      }\n      if (!isEqual(filtered, props[name])) {\n        emit(`update:${name as string & K}`, filtered)\n      }\n    }\n    watch(() => filter(prop.value), update)\n    watch(() => props[name],v => update(filter(v)))\n    if (prop.value !== props[name]) {\n      emit(`update:${name as string & K}`, prop.value)\n    }\n    return prop\n  }\n\n  const prop = ref<T[K]>(props[name]) as Ref<T[K]>\n  watch(\n    () => props[name],\n    v => {\n      if (!isEqual(v, prop.value)) {\n        prop.value = v\n      }\n    }\n  )\n  watch(prop, v => {\n    if (!isEqual(v, props[name])) {\n      emit(`update:${name as string & K}`, v)\n    }\n  })\n  return prop\n}\n\ntype KeysOfType<Obj, Val> = {\n  [K in keyof Obj]-?: Obj[K] extends Val ? K : never\n}[keyof Obj]\n\nexport function bindPropKeySet<T extends object, K extends string & KeysOfType<T, string[]>>(\n  props: T,\n  name: K,\n  sourceObject: Ref<{ [name: string]: any }>,\n  emit: (event: `update:${K & string}`, ...args: any[]) => void\n): Reactive<Set<string>> {\n  // Generate two-way bindings for a given prop.\n  // Assumes that the specified prop indicates the key of the object.\n  const bound = reactive<Set<string>>(new Set())\n  watch(\n    () => props[name],\n    () => {\n      // Since it is not recognized as a string[] by type checking,\n      // use any for now.\n      const prop: string[] = props[name] as any\n      const filtered = prop.filter(n => n in sourceObject.value)\n      if (!isEqual(filtered, Array.from(bound))) {\n        bound.clear()\n        filtered.forEach(bound.add, bound)\n      }\n    },\n    { deep: true, immediate: true }\n  )\n  watch(bound, () => {\n    const array = Array.from(bound)\n    if (!isEqual(props[name], array)) {\n      emit(`update:${name}` as const, array)\n    }\n  })\n  return Reactive(bound)\n}\n","import { inject, InjectionKey, provide } from \"vue\"\nimport { nonNull, Reactive } from \"@/common/common\"\n\ninterface Selections {\n  selectedNodes: Reactive<Set<string>>\n  selectedEdges: Reactive<Set<string>>\n  selectedPaths: Reactive<Set<string>>\n}\n\nconst injectionKey = Symbol(\"selection\") as InjectionKey<Selections>\n\nexport function provideSelections(\n  selectedNodes: Reactive<Set<string>>,\n  selectedEdges: Reactive<Set<string>>,\n  selectedPaths: Reactive<Set<string>>\n) {\n  provide(injectionKey, {\n    selectedNodes,\n    selectedEdges,\n    selectedPaths,\n  })\n}\n\nexport function useSelections(): Selections {\n  return nonNull(inject(injectionKey), \"Selections\")\n}\n","import { inject, InjectionKey, provide } from \"vue\"\nimport { nonNull, Reactive } from \"@/common/common\"\nimport { Layouts } from \"@/common/types\"\n\nconst injectionKey = Symbol(\"layouts\") as InjectionKey<Reactive<Layouts>>\n\nexport function provideLayouts(layouts: Reactive<Layouts>) {\n  provide(injectionKey, layouts)\n}\n\nexport function useLayouts(): Layouts {\n  return nonNull(inject(injectionKey), \"Layouts\")\n}\n","\nexport function pairwise<T>(arr: T[], func: (p1: T, p2: T) => void) {\n  for (let i = 0; i < arr.length - 1; i++) {\n    func(arr[i], arr[i + 1])\n  }\n}\n","\nexport function removeItem<T extends number | string>(arr: T[], value: T): void {\n  const i = arr.indexOf(value)\n  if (i >= 0) arr.splice(i, 1)\n}\n\nexport function insertAfter<T extends number | string>(arr: T[], base: T, value: T): void {\n  const i = arr.indexOf(base)\n  if (i < 0) return\n  arr.splice(i + 1, 0, value)\n}\n","import { computed, ComputedRef, Slot } from \"vue\"\nimport { uniq } from \"lodash-es\"\nimport { Configs } from \"@/common/configs\"\nimport { LayerName } from \"@/common/types\"\nimport { pairwise } from \"@/modules/collection/iterate\"\nimport { insertAfter, removeItem } from \"@/modules/collection/array\"\n\nexport interface LayerSlotProps {\n  scale: number\n}\nexport type LayerSlots = Record<string, Slot<LayerSlotProps>>\n\nexport function useBuiltInLayerOrder<T extends Configs>(\n  configs: T,\n  slots: Readonly<LayerSlots>\n): ComputedRef<LayerName[]> {\n  const builtInLayers: Readonly<LayerName[]> = [\n    \"edges\",\n    \"edge-labels\",\n    \"focusring\",\n    \"nodes\",\n    \"node-labels\",\n    \"paths\",\n  ] as const\n\n  return computed<LayerName[]>(() => {\n    const request = uniq(configs.view.builtInLayerOrder)\n      .filter(layer => {\n        const defined = builtInLayers.includes(layer)\n        if (!defined) {\n          console.warn(`Layer ${layer} is not a built-in layer.`)\n        }\n        return defined\n      })\n      .reverse()\n    const order = [...builtInLayers]\n    pairwise(request, (lower, higher) => {\n      removeItem(order, higher)\n      insertAfter(order, lower, higher)\n    })\n\n    // Remove unused layers\n    if (!(\"edge-label\" in slots || \"edges-label\" in slots)) {\n      removeItem(order, \"edge-labels\")\n    }\n    if (!configs.node.focusring.visible) {\n      removeItem(order, \"focusring\")\n    }\n    if (configs.node.label.visible === false) {\n      removeItem(order, \"node-labels\")\n    }\n    if (!configs.path.visible) {\n      removeItem(order, \"paths\")\n    }\n\n    return order\n  })\n}\n","import { nextTick } from \"vue\"\n\nexport const asyncNextTick = () => {\n  return new Promise((resolve) => nextTick(resolve as () => void))\n}\n","import { Box, ViewBox } from \"@/common/types\"\n\nexport function areBoxesSame(box1: ViewBox, box2: ViewBox): boolean {\n  // Compare with sufficient precision to be considered identical,\n  // taking into account the resolution at which they are displayed.\n  const error = Math.max(box1.width, box1.height, box2.width, box2.height) / 10000\n  return (\n    Math.abs(box1.x - box2.x) < error &&\n    Math.abs(box1.y - box2.y) < error &&\n    Math.abs(box1.width - box2.width) < error &&\n    Math.abs(box1.height - box2.height) < error\n  )\n}\n\nexport function boxAdd(box1: Box, box2: Box): Box {\n  return {\n    top: box1.top + box2.top,\n    left: box1.left + box2.left,\n    right: box1.right + box2.right,\n    bottom: box1.bottom + box2.bottom,\n  }\n}\n\nexport function boxMultiply(box: Box, m: number): Box {\n  return {\n    top: box.top * m,\n    left: box.left * m,\n    right: box.right * m,\n    bottom: box.bottom * m,\n  }\n}\n\nexport function boxDivide(box: Box, d: number): Box {\n  return {\n    top: box.top / d,\n    left: box.left / d,\n    right: box.right / d,\n    bottom: box.bottom / d,\n  }\n}\n\nexport function viewBoxToBox(viewBox: ViewBox): Box {\n  return {\n    top: viewBox.y,\n    left: viewBox.x,\n    right: viewBox.x + viewBox.width,\n    bottom: viewBox.y + viewBox.height,\n  }\n}\n\nexport function boxToViewBox(box: Box): ViewBox {\n  return {\n    x: box.left,\n    y: box.top,\n    width: box.right - box.left,\n    height: box.bottom - box.top,\n  }\n}\n\nexport function mergeBox(box1: Box, box2: Box): Box {\n  return {\n    top: Math.min(box1.top, box2.top),\n    left: Math.min(box1.left, box2.left),\n    right: Math.max(box1.right, box2.right),\n    bottom: Math.max(box1.bottom, box2.bottom),\n  }\n}\n","import { Point } from \"@dash14/svg-pan-zoom\"\nimport { Box, NodePositions, Position, Size, ViewBox } from \"@/common/types\"\nimport { getNodesBox } from \"@/modules/node/node\"\nimport { FitContentMargin, MarginValue } from \"@/common/configs\"\nimport {\n  areBoxesSame,\n  boxAdd,\n  boxDivide,\n  boxMultiply,\n  boxToViewBox,\n  mergeBox,\n  viewBoxToBox,\n} from \"@/utils/box\"\n\n// -----------------------------------------------------------------------\n// Type definitions\n// -----------------------------------------------------------------------\n\ninterface ZoomAt {\n  zoom: number\n  pos: Point\n}\n\n// -----------------------------------------------------------------------\n// Constants\n// -----------------------------------------------------------------------\n\nconst NUMERIC_PATTERN = new RegExp(\"^\\\\d+$\")\n\n// -----------------------------------------------------------------------\n// Exported functions\n// -----------------------------------------------------------------------\n\nexport function parseFitContentMargin(fitContentMargin: FitContentMargin, container: Size): Box {\n  let margins = { top: 0, left: 0, right: 0, bottom: 0 }\n  if (typeof fitContentMargin === \"string\") {\n    const x = parseFitContentMarginValue(fitContentMargin, container.width)\n    const y = parseFitContentMarginValue(fitContentMargin, container.height)\n    if (x === undefined || y === undefined) {\n      console.warn(\"Invalid `fitContentMargin` value.\", fitContentMargin)\n    } else {\n      margins = { top: y, left: x, right: x, bottom: y }\n    }\n  } else if (typeof fitContentMargin === \"number\") {\n    const v = fitContentMargin\n    margins = { top: v, left: v, right: v, bottom: v }\n  } else {\n    if (fitContentMargin.top) {\n      const top = parseFitContentMarginValue(fitContentMargin.top, container.height)\n      if (top === undefined) {\n        console.warn(\"Invalid `fitContentMargin` value.\", fitContentMargin.top)\n      } else {\n        margins.top = top\n      }\n    }\n\n    if (fitContentMargin.left) {\n      const left = parseFitContentMarginValue(fitContentMargin.left, container.width)\n      if (left === undefined) {\n        console.warn(\"Invalid `fitContentMargin` value.\", fitContentMargin.left)\n      } else {\n        margins.left = left\n      }\n    }\n\n    if (fitContentMargin.right) {\n      const right = parseFitContentMarginValue(fitContentMargin.right, container.width)\n      if (right === undefined) {\n        console.warn(\"Invalid `fitContentMargin` value.\", fitContentMargin.right)\n      } else {\n        margins.right = right\n      }\n    }\n\n    if (fitContentMargin.bottom) {\n      const bottom = parseFitContentMarginValue(fitContentMargin.bottom, container.height)\n      if (bottom === undefined) {\n        console.warn(\"Invalid `fitContentMargin` value.\", fitContentMargin.bottom)\n      } else {\n        margins.bottom = bottom\n      }\n    }\n  }\n  return margins\n}\n\nexport function calculateFit(\n  viewport: SVGGElement,\n  container: Size,\n  nodesLayouts: NodePositions,\n  zoomLevel: number,\n  margins: Box,\n  scalingObjects: boolean\n): ZoomAt | undefined {\n  const viewportBox: ViewBox = viewport.getBBox()\n\n  if (scalingObjects) {\n    return calculateFitWithScalingObjects(viewportBox, container, nodesLayouts, margins)\n  } else {\n    const graphBox = getGraphBox(viewport)\n    return calculateFitWithoutScalingObjects(\n      viewportBox,\n      graphBox,\n      container,\n      nodesLayouts,\n      zoomLevel,\n      margins\n    )\n  }\n}\n\n// -----------------------------------------------------------------------\n// Local functions\n// -----------------------------------------------------------------------\n\nfunction parseFitContentMarginValue(\n  marginValue: MarginValue,\n  baseSize: number\n): number | undefined {\n  if (typeof marginValue === \"string\") {\n    if (marginValue.endsWith(\"%\")) {\n      const value = parseInt(marginValue.toString())\n      if (Number.isFinite(value)) {\n        return baseSize * (value / 100.0)\n      }\n    } else if (marginValue.endsWith(\"px\") || NUMERIC_PATTERN.test(marginValue)) {\n      const value = parseInt(marginValue.toString())\n      if (Number.isFinite(value)) {\n        return value\n      }\n    }\n  } else if (typeof marginValue === \"number\") {\n    return marginValue\n  }\n  return undefined\n}\n\nfunction getGraphBox(viewport: SVGGElement): ViewBox {\n  const rects = Array.from(viewport.querySelectorAll<SVGGElement>(\".v-ng-graph-objects\")).map(g =>\n    g.getBBox()\n  )\n  return rects.reduce(\n    (accum, r, i) => {\n      if (i === 0) return r\n      const x = Math.min(accum.x, r.x)\n      const y = Math.min(accum.y, r.y)\n      return {\n        x,\n        y,\n        width: Math.max(accum.x + accum.width - x, r.x + r.width - x),\n        height: Math.max(accum.y + accum.height - y, r.y + r.height - y),\n      }\n    },\n    { x: 0, y: 0, width: 0, height: 0 }\n  )\n}\n\nfunction calculateFitWithScalingObjects(\n  viewport: ViewBox,\n  container: Size,\n  nodesLayouts: NodePositions,\n  margins: Box\n): ZoomAt | undefined {\n  if (Object.keys(nodesLayouts).length <= 1) {\n    return undefined\n  }\n\n  const zoom = calculateZoomLevelForFixedBox(viewport, container, margins)\n  if (zoom > 0) {\n    const box = viewBoxToBox(viewport)\n    return {\n      zoom,\n      pos: calculatePanForCentering(box, zoom, container, margins),\n    }\n  } else {\n    return undefined\n  }\n}\n\nfunction calculateFitWithoutScalingObjects(\n  viewport: ViewBox,\n  graphBox: ViewBox,\n  container: Size,\n  nodesLayouts: NodePositions,\n  zoomLevel: number,\n  margins: Box\n): ZoomAt | undefined {\n  if (Object.keys(nodesLayouts).length <= 1) {\n    return undefined\n  }\n\n  // For regions of the graph objects (i.e., nodes, edges, paths, labels),\n  // assume that all outside of the center of a node will change size\n  // according to the zoom value.\n  // 1. Calculate the pixels from the center of the nodes to the edges\n  //    of the graph area.\n  const nodesBox = getNodesBox(nodesLayouts)\n  const fixedSizes = {\n    top: (nodesBox.top - graphBox.y) * zoomLevel,\n    left: (nodesBox.left - graphBox.x) * zoomLevel,\n    right: (graphBox.x + graphBox.width - nodesBox.right) * zoomLevel,\n    bottom: (graphBox.y + graphBox.height - nodesBox.bottom) * zoomLevel,\n  }\n\n  // 2. Get the zoom value to be calculated from the viewport.\n  // The viewport is the entire area including the background layer.\n  // Since the background image may be further out than the graph elements,\n  // a fixed scale viewport is also used to calculate the zoom value.\n  let zoom = calculateZoomLevelForFixedBox(viewport, container, margins)\n  if (zoom === 0) {\n    return undefined\n  }\n\n  const tmpTarget = calculateSizeWithoutMargin(container, boxAdd(margins, fixedSizes))\n  if (tmpTarget.width <= 0 || tmpTarget.height <= 0) {\n    return undefined\n  }\n\n  // 3. Calculate the zoom value and the pixel size of the display area.\n  // Calculate several times until the zoom value stabilizes, since the\n  // size of the graph elements changes according to the zoom value and\n  // the calculation of the zoom value depends on the size of the entire\n  // area.\n  const viewportBox = viewBoxToBox(viewport)\n  const target = calculateSizeWithoutMargin(container, margins)\n  const hasOnlyGraphLayer = areBoxesSame(viewport, graphBox)\n\n  let i = 0\n  let lastZoom = 0\n  let box: Box = { top: 0, left: 0, right: 0, bottom: 0 }\n  do {\n    lastZoom = zoom\n    const zoomed = boxDivide(fixedSizes, zoom)\n    const zoomedBox: Box = {\n      top: nodesBox.top - zoomed.top,\n      left: nodesBox.left - zoomed.left,\n      right: nodesBox.right + zoomed.right,\n      bottom: nodesBox.bottom + zoomed.bottom,\n    }\n    // The graph area to which the zoom is applied is not necessarily\n    // contained within the background layer, so merge size.\n    box = hasOnlyGraphLayer ? zoomedBox : mergeBox(viewportBox, zoomedBox)\n    const viewBox = boxToViewBox(box)\n    const zooms = [target.width / viewBox.width, target.height / viewBox.height]\n    const availableZooms = zooms.filter(z => z > 0)\n    if (availableZooms.length === 0) {\n      return undefined\n    }\n    zoom = Math.min(...availableZooms)\n    i++\n  } while (Math.abs(lastZoom - zoom) > 0.000001 && i < 10)\n\n  return {\n    zoom,\n    pos: calculatePanForCentering(box, zoom, container, margins),\n  }\n}\n\nfunction calculateZoomLevelForFixedBox(box: ViewBox, container: Size, margins: Box): number {\n  if (box.width === 0 || box.height === 0) return 0\n  const target = calculateSizeWithoutMargin(container, margins)\n  if (target.width <= 0 || target.height <= 0) {\n    return 0\n  }\n  const zooms = [target.width / box.width, target.height / box.height]\n  return Math.min(...zooms)\n}\n\nfunction calculatePanForCentering(box: Box, zoom: number, container: Size, margins: Box): Position {\n  const target = calculateSizeWithoutMargin(container, margins)\n  const zoomed = boxToViewBox(boxMultiply(box, zoom))\n  const offsetX = (target.width - zoomed.width) / 2\n  const offsetY = (target.height - zoomed.height) / 2\n\n  const left = zoomed.x - margins.left\n  const top = zoomed.y - margins.top\n\n  return {\n    x: -left + offsetX,\n    y: -top + offsetY,\n  }\n}\n\nfunction calculateSizeWithoutMargin(container: Size, margins: Box): Size {\n  const marginX = margins.left + margins.right\n  const marginY = margins.top + margins.bottom\n  return {\n    width: container.width - marginX,\n    height: container.height - marginY,\n  }\n}\n\nif (import.meta.env.MODE == \"test\") {\n  module.exports.exportedForTesting = {\n    calculateFitWithScalingObjects,\n    calculateFitWithoutScalingObjects,\n    calculateZoomLevelForFixedBox,\n    calculatePanForCentering,\n    calculateSizeWithoutMargin,\n  }\n}\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { MarkerUnits } from \"@/common/configs\"\n\nconst props = defineProps<{\n  width: number\n  height: number\n  refX: number\n  color: string\n  isSource: boolean\n  units: MarkerUnits\n}>()\n\nconst arrowPoints = computed(() => {\n  const w = props.width\n  const h = props.height\n  if (props.isSource) {\n    return `${w} ${h}, 0 ${h / 2}, ${w} 0`\n  } else {\n    return `0 0, ${w} ${h / 2}, 0 ${h}`\n  }\n})\n</script>\n\n<template>\n  <polygon :points=\"arrowPoints\" :fill=\"color\" />\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { MarkerUnits } from \"@/common/configs\"\n\nconst props = defineProps<{\n  width: number\n  height: number\n  refX: number\n  color: string\n  isSource: boolean\n  units: MarkerUnits\n}>()\n\nconst angleStroke = computed(() => {\n  return props.units === \"strokeWidth\" ? 1 : Math.min(props.width, props.height) / 5\n})\n\nconst anglePoints = computed(() => {\n  const m = angleStroke.value / 2\n  const w = props.width\n  const h = props.height\n  if (props.isSource) {\n    return `${w - m} ${h - m}, ${m} ${h / 2}, ${w - m} ${m}`\n  } else {\n    return `${m} ${m}, ${w - m} ${h / 2}, ${m} ${h - m}`\n  }\n})\n</script>\n\n<template>\n  <polyline\n    :points=\"anglePoints\"\n    fill=\"none\"\n    :stroke-width=\"angleStroke\"\n    :stroke=\"color\"\n    stroke-linecap=\"round\"\n    stroke-linejoin=\"round\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { EdgeHeadType } from \"@/common/configs\"\nimport { HeadMarker } from \"@/composables/marker\"\nimport VMarkerHeadArrow from \"./VMarkerHeadArrow.vue\"\nimport VMarkerHeadAngle from \"./VMarkerHeadAngle.vue\"\nimport VMarkerHeadCircle from \"./VMarkerHeadCircle.vue\"\n\ntype MarkerType = Exclude<EdgeHeadType, \"none\" | \"custom\">\n\nconst types: Record<MarkerType, any> = {\n  arrow: VMarkerHeadArrow,\n  angle: VMarkerHeadAngle,\n  circle: VMarkerHeadCircle,\n}\n\nconst props = defineProps<{\n  id: string\n  marker: HeadMarker\n  scale: number\n}>()\n\nconst width = computed(\n  () => props.marker.width * (props.marker.units === \"strokeWidth\" ? 1 : props.scale)\n)\n\nconst height = computed(\n  () => props.marker.height * (props.marker.units === \"strokeWidth\" ? 1 : props.scale)\n)\n\nconst refX = computed(() => {\n  const margin = props.marker.margin * (props.marker.units === \"strokeWidth\" ? 1 : props.scale)\n  return props.marker.isSource ? width.value + margin : -margin\n})\n\nconst refYOffset = computed(() => {\n  const offset = props.marker.offset * (props.marker.units === \"strokeWidth\" ? 1 : props.scale)\n  return props.marker.isSource ? offset : -offset\n})\n</script>\n\n<template>\n  <marker\n    v-if=\"marker.type !== 'none' && marker.type !== 'custom'\"\n    :id=\"id\"\n    :markerWidth=\"width\"\n    :markerHeight=\"height\"\n    :refX=\"refX\"\n    :refY=\"height / 2 + refYOffset\"\n    orient=\"auto\"\n    :markerUnits=\"marker.units\"\n    class=\"v-ng-marker\"\n  >\n    <component\n      :is=\"types[marker.type]\"\n      :width=\"width\"\n      :height=\"height\"\n      :refX=\"refX\"\n      :color=\"marker.color\"\n      :is-source=\"marker.isSource\"\n      :units=\"marker.units\"\n    />\n  </marker>\n</template>\n","<script setup lang=\"ts\">\nimport { onMounted, ref, watchEffect } from \"vue\"\nimport { Point, Size } from \"@/common/types\"\nimport { useViewConfig } from \"@/composables/config\"\nimport { useContainers } from \"@/composables/container\"\nimport { useEventEmitter } from \"@/composables/event-emitter\"\nimport { useZoomLevel } from \"@/composables/zoom\"\n\n// [index, pos, start, end, attrs][]\ntype LineDefinitions = [number, number, number, number, Record<string, any>][]\n\nconst { container, svgPanZoom } = useContainers()\nconst { zoomLevel } = useZoomLevel()\nconst emitter = useEventEmitter()\nconst config = useViewConfig()\n\n// left-top point in SVG coordinates\nconst basePoint = ref<Point>({ x: 0, y: 0 })\n\n// container size in pixel\nconst viewport = ref<Size>({ width: 500, height: 500 })\n\nonMounted(() => {\n  const pan = svgPanZoom.value?.getPan()\n  if (pan) {\n    basePoint.value = {\n      x: -pan.x,\n      y: -pan.y,\n    }\n  }\n  const rect = container.value.getBoundingClientRect()\n  viewport.value = {\n    width: rect.width,\n    height: rect.height,\n  }\n})\n\nemitter.on(\"view:resize\", rect => {\n  viewport.value = { width: rect.width, height: rect.height }\n})\n\nemitter.on(\"view:pan\", pan => {\n  basePoint.value = { x: -pan.x, y: -pan.y }\n})\n\nemitter.on(\"view:zoom\", () => {\n  const pan = svgPanZoom.value?.getPan()\n  if (pan) {\n    basePoint.value = { x: -pan.x, y: -pan.y }\n  }\n})\n\nconst thickVerticals = ref<LineDefinitions>([])\nconst thickHorizontals = ref<LineDefinitions>([])\nconst normalVerticals = ref<LineDefinitions>([])\nconst normalHorizontals = ref<LineDefinitions>([])\n\n// make grid lines\nwatchEffect(() => {\n  const thickH: LineDefinitions = []\n  const thickV: LineDefinitions = []\n  const normalH: LineDefinitions = []\n  const normalV: LineDefinitions = []\n\n  const s = 1 / zoomLevel.value\n  const gi = config.grid.interval\n  const x = basePoint.value.x * s\n  const y = basePoint.value.y * s\n  const width = Math.floor(viewport.value.width / gi + 1) * gi\n  const height = Math.floor(viewport.value.height / gi + 1) * gi\n  const maxWidth = (basePoint.value.x + width) * s\n  const maxHeight = (basePoint.value.y + height) * s\n  const inc = config.grid.thickIncrements // interval to make the line thicker\n  const normalDasharray = config.grid.line.dasharray\n  const thickDasharray = config.grid.thick.dasharray\n\n  let thickAttrs = {\n    stroke: config.grid.thick.color,\n    \"stroke-width\": config.grid.thick.width,\n    \"stroke-dasharray\": thickDasharray,\n    \"stroke-dashoffset\": thickDasharray ? x / s : undefined,\n  }\n\n  let normalAttrs = {\n    stroke: config.grid.line.color,\n    \"stroke-width\": config.grid.line.width,\n    \"stroke-dasharray\": normalDasharray,\n    \"stroke-dashoffset\": normalDasharray ? x / s : undefined,\n  }\n\n  // horizontal lines\n  const w = (basePoint.value.x + width) * s\n  for (let i = y; i <= maxHeight; i += gi) {\n    const index = Math.floor(i / gi)\n    if (inc && index % inc === 0) {\n      thickH.push([index, index * gi, x, w, thickAttrs])\n    } else {\n      normalH.push([index, index * gi, x, w, normalAttrs])\n    }\n  }\n\n  thickAttrs = { ...thickAttrs }\n  thickAttrs[\"stroke-dashoffset\"] = thickDasharray ? y / s : undefined\n\n  normalAttrs = { ...normalAttrs }\n  normalAttrs[\"stroke-dashoffset\"] = normalDasharray ? y / s : undefined\n\n  // vertical lines\n  const h = (basePoint.value.y + height) * s\n  for (let i = x; i <= maxWidth; i += gi) {\n    const index = Math.floor(i / gi)\n    if (inc && index % inc === 0) {\n      thickV.push([index, index * gi, y, h, thickAttrs])\n    } else {\n      normalV.push([index, index * gi, y, h, normalAttrs])\n    }\n  }\n\n  thickHorizontals.value = thickH\n  thickVerticals.value = thickV\n  normalHorizontals.value = normalH\n  normalVerticals.value = normalV\n})\n</script>\n\n<template>\n  <g class=\"v-ng-background-grid\" shape-rendering=\"crispEdges\">\n    <!-- normal -->\n    <path\n      v-for=\"[i, v, x, w, attrs] in normalHorizontals\"\n      :key=\"`nv${i}`\"\n      :d=\"`M ${x} ${v} L ${w} ${v}`\"\n      v-bind=\"attrs\"\n      style=\"vector-effect: non-scaling-stroke\"\n    />\n    <path\n      v-for=\"[i, v, y, h, attrs] in normalVerticals\"\n      :key=\"`nh${i}`\"\n      :d=\"`M ${v} ${y} L ${v} ${h}`\"\n      v-bind=\"attrs\"\n      style=\"vector-effect: non-scaling-stroke\"\n    />\n    <!-- thick -->\n    <path\n      v-for=\"[i, v, x, w, attrs] in thickHorizontals\"\n      :key=\"`tv${i}`\"\n      :d=\"`M ${x} ${v} L ${w} ${v}`\"\n      v-bind=\"attrs\"\n      style=\"vector-effect: non-scaling-stroke\"\n    />\n    <path\n      v-for=\"[i, v, y, h, attrs] in thickVerticals\"\n      :key=\"`th${i}`\"\n      :d=\"`M ${v} ${y} L ${v} ${h}`\"\n      v-bind=\"attrs\"\n      style=\"vector-effect: non-scaling-stroke\"\n    />\n  </g>\n</template>\n\n<style lang=\"scss\">\n.v-ng-background-grid {\n  pointer-events: none;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { onMounted, onUnmounted, ref } from \"vue\"\nimport { useContainers } from \"@/composables/container\"\n\n// By detecting and copying changes in the `transform` and `style`\n// attributes reflected by svg-pan-zoom, it follows changes in the\n// display area caused by panning and zooming.\n\nconst { viewport } = useContainers()\n\n// ref=\"background\"\nconst background = ref<SVGGElement>()\n\nconst updateAttributes = (attrs: string[], bgLayer: SVGGElement, vpLayer: SVGGElement) => {\n  attrs.forEach(attr => bgLayer.setAttribute(attr, vpLayer.getAttribute(attr) ?? \"\"))\n}\n\nconst observer = new MutationObserver(records => {\n  if (!background.value) return\n  const attrs = records.map(r => r.attributeName ?? \"\").filter(Boolean)\n  updateAttributes(attrs, background.value, viewport.value)\n})\n\nonMounted(() => {\n  const attrs = [\"transform\", \"style\"]\n  observer.observe(viewport.value, {\n    attributes: true,\n    attributeFilter: attrs,\n  })\n  if (!background.value) return\n  updateAttributes(attrs, background.value, viewport.value)\n})\n\nonUnmounted(() => {\n  observer.disconnect()\n})\n</script>\n\n<template>\n  <g ref=\"background\" class=\"v-ng-background-viewport\">\n    <slot />\n  </g>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { chunk } from \"lodash-es\"\nimport { Position } from \"@/common/types\"\nimport { EdgeState } from \"@/models/edge\"\nimport { useEdgeConfig } from \"@/composables/config\"\nimport { useMouseOperation } from \"@/composables/mouse\"\nimport { useZoomLevel } from \"@/composables/zoom\"\n\ninterface Props {\n  id: string\n  state: EdgeState\n  sourcePos?: Position\n  targetPos?: Position\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  sourcePos: undefined,\n  targetPos: undefined,\n})\n\nconst { scale } = useZoomLevel()\n\nconst config = useEdgeConfig()\nconst {\n  handleEdgePointerDownEvent,\n  handleEdgePointerOverEvent,\n  handleEdgePointerOutEvent,\n  handleEdgeClickEvent,\n  handleEdgeDoubleClickEvent,\n  handleEdgeContextMenu,\n} = useMouseOperation()\n\nconst pathD = computed(() => {\n  const p = props.state.position\n  if (props.state.loop) {\n    const { radius, isLargeArc, isClockwise } = props.state.loop\n    const [rx, ry] = radius\n    const f1 = isLargeArc ? 1 : 0\n    const f2 = isClockwise ? 1 : 0\n    return `M ${p.p1.x} ${p.p1.y} A ${rx} ${ry} 0 ${f1} ${f2} ${p.p2.x} ${p.p2.y}`\n  } else if (config.type === \"straight\" || !props.state.curve) {\n    return `M ${p.p1.x} ${p.p1.y} L ${p.p2.x} ${p.p2.y}`\n  } else {\n    const points = [...props.state.curve.control, { x: p.p2.x, y: p.p2.y }]\n    const d: string[] = []\n    d.push(`M ${p.p1.x} ${p.p1.y}`)\n    chunk(points, 2).forEach(([p1, p2]) => d.push(`Q ${p1.x} ${p1.y} ${p2.x} ${p2.y}`))\n    return d.join(\" \")\n  }\n})\n\nconst strokeWidth = computed(() => (props.state.line.stroke.width + 10) * scale.value)\n</script>\n\n<template>\n  <path\n    :class=\"{ 'v-ng-line-background': true, selectable: state.selectable }\"\n    :d=\"pathD\"\n    stroke=\"transparent\"\n    :stroke-width=\"strokeWidth\"\n    fill=\"none\"\n    @pointerdown.stop=\"handleEdgePointerDownEvent(id, $event)\"\n    @pointerenter.passive=\"handleEdgePointerOverEvent(id, $event)\"\n    @pointerleave.passive=\"handleEdgePointerOutEvent(id, $event)\"\n    @click.stop=\"handleEdgeClickEvent(id, $event)\"\n    @dblclick.stop=\"handleEdgeDoubleClickEvent(id, $event)\"\n    @contextmenu=\"handleEdgeContextMenu(id, $event)\"\n  />\n</template>\n\n<style lang=\"scss\">\n.v-ng-line-background {\n  &.selectable {\n    cursor: pointer;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { useStates } from \"@/composables/state\"\nimport VEdgeBackground from \"./VEdgeBackground.vue\"\n\nconst { edgeStates, edgeGroupStates, layouts } = useStates()\n</script>\n\n<template>\n  <template v-for=\"{ summarize, edges } in edgeGroupStates.edgeGroups\">\n    <template v-if=\"!summarize\">\n      <template v-for=\"(edge, id) in edges\" :key=\"id\">\n        <v-edge-background\n          :id=\"id\"\n          :state=\"edgeStates[id]\"\n          :source-pos=\"layouts.nodes[edge.source]\"\n          :target-pos=\"layouts.nodes[edge.target]\"\n        />\n      </template>\n    </template>\n  </template>\n</template>\n","<script setup lang=\"ts\">\nimport { CSSProperties, computed } from \"vue\"\nimport { Position } from \"@/common/types\"\nimport { StrokeStyle } from \"@/common/configs\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { applyScaleToDasharray, getDasharrayUnit } from \"@/utils/visual\"\n\nconst props = defineProps<{\n  p1: Position\n  p2: Position\n  config: StrokeStyle\n}>()\n\nconst { scale } = useZoomLevel()\n\nconst strokeWidth = computed(() => {\n  return props.config.width * scale.value\n})\n\nconst strokeDasharray = computed(() => {\n  return applyScaleToDasharray(props.config.dasharray, scale.value)\n})\n\nconst animationSpeed = computed(() => {\n  const speed = props.config.animate\n    ? getDasharrayUnit(props.config.dasharray) * props.config.animationSpeed * scale.value\n    : false\n  return speed ? ({ \"--animation-speed\": speed } as CSSProperties) : undefined\n})\n</script>\n\n<template>\n  <path\n    :class=\"{ 'v-ng-line': true, animate: config.animate }\"\n    :d=\"`M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`\"\n    :stroke=\"config.color\"\n    :stroke-width=\"strokeWidth\"\n    :stroke-dasharray=\"strokeDasharray\"\n    :stroke-linecap=\"config.linecap\"\n    :style=\"animationSpeed\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { CSSProperties, computed } from \"vue\"\nimport { Position } from \"@/common/types\"\nimport { StrokeStyle } from \"@/common/configs\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { applyScaleToDasharray, getDasharrayUnit } from \"@/utils/visual\"\n\nconst props = defineProps<{\n  p1: Position\n  p2: Position\n  radius: number[]\n  isLargeArc: boolean\n  isClockwise: boolean\n  config: StrokeStyle\n}>()\n\nconst { scale } = useZoomLevel()\n\nconst strokeWidth = computed(() => {\n  return props.config.width * scale.value\n})\n\nconst strokeDasharray = computed(() => {\n  return applyScaleToDasharray(props.config.dasharray, scale.value)\n})\n\nconst animationSpeed = computed(() => {\n  const speed = props.config.animate\n    ? getDasharrayUnit(props.config.dasharray) * props.config.animationSpeed * scale.value\n    : false\n  return speed ? ({ \"--animation-speed\": speed } as CSSProperties) : undefined\n})\n\nconst pathD = computed(() => {\n  const { p1, p2, radius, isLargeArc, isClockwise } = props\n  const [rx, ry] = radius\n  const f1 = isLargeArc ? 1 : 0\n  const f2 = isClockwise ? 1 : 0\n  return `M ${p1.x} ${p1.y} A ${rx} ${ry} 0 ${f1} ${f2} ${p2.x} ${p2.y}`\n})\n</script>\n\n<template>\n  <path\n    :class=\"{ 'v-ng-line': true, animate: config.animate }\"\n    :d=\"pathD\"\n    :stroke=\"config.color\"\n    :stroke-width=\"strokeWidth\"\n    :stroke-dasharray=\"strokeDasharray\"\n    :stroke-linecap=\"config.linecap\"\n    :style=\"animationSpeed\"\n    fill=\"none\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { CSSProperties, computed } from \"vue\"\nimport { chunk } from \"lodash-es\"\nimport { StrokeStyle } from \"@/common/configs\"\nimport { EdgeState } from \"@/models/edge\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { applyScaleToDasharray, getDasharrayUnit } from \"@/utils/visual\"\n\ninterface Props {\n  state: EdgeState\n  config: StrokeStyle\n  markerStart?: string\n  markerEnd?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  markerStart: undefined,\n  markerEnd: undefined,\n})\n\nconst { scale } = useZoomLevel()\n\nconst pathD = computed(() => {\n  const p = props.state.position\n  const points = [...(props.state.curve?.control ?? []), { x: p.p2.x, y: p.p2.y }]\n  const d: string[] = []\n  d.push(`M ${p.p1.x} ${p.p1.y}`)\n  chunk(points, 2).forEach(([p1, p2]) => d.push(`Q ${p1.x} ${p1.y} ${p2.x} ${p2.y}`))\n  return d.join(\" \")\n})\n\nconst strokeWidth = computed(() => {\n  return props.config.width * scale.value\n})\n\nconst strokeDasharray = computed(() => {\n  return applyScaleToDasharray(props.config.dasharray, scale.value)\n})\n\nconst animationSpeed = computed(() => {\n  const speed = props.config.animate\n    ? getDasharrayUnit(props.config.dasharray) * props.config.animationSpeed * scale.value\n    : false\n  return speed ? ({ \"--animation-speed\": speed } as CSSProperties) : undefined\n})\n</script>\n\n<template>\n  <!-- <circle\n    v-if=\"state.curve\"\n    :cx=\"state.curve.circle.center.x\"\n    :cy=\"state.curve.circle.center.y\"\n    :r=\"state.curve.circle.radius\"\n    fill=\"#ff000080\"\n  />\n  <circle\n    v-for=\"cp in state.curve?.control\"\n    :key=\"JSON.stringify(cp)\"\n    :cx=\"cp.x\"\n    :cy=\"cp.y\"\n    :r=\"2\"\n    fill=\"#0000ff\"\n  /> -->\n  <path\n    :class=\"{ 'v-ng-line': true, animate: config.animate }\"\n    :d=\"pathD\"\n    fill=\"none\"\n    :stroke=\"config.color\"\n    :stroke-width=\"strokeWidth\"\n    :stroke-dasharray=\"strokeDasharray\"\n    :stroke-linecap=\"config.linecap\"\n    :style=\"animationSpeed\"\n    :marker-start=\"markerStart\"\n    :marker-end=\"markerEnd\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { Position } from \"@/common/types\"\nimport { EdgeState } from \"@/models/edge\"\nimport { useEdgeConfig } from \"@/composables/config\"\nimport VLine from \"@/components/base/VLine.vue\"\nimport VArc from \"@/components/base/VArc.vue\"\nimport VEdgeCurved from \"./VEdgeCurved.vue\"\n\ninterface Props {\n  id: string\n  state: EdgeState\n  sourcePos?: Position\n  targetPos?: Position\n}\n\nwithDefaults(defineProps<Props>(), {\n  sourcePos: undefined,\n  targetPos: undefined,\n})\n\nconst config = useEdgeConfig()\n</script>\n\n<template>\n  <v-arc\n    v-if=\"state.loop\"\n    v-bind=\"state.position\"\n    :radius=\"state.loop.radius\"\n    :is-large-arc=\"state.loop.isLargeArc\"\n    :is-clockwise=\"state.loop.isClockwise\"\n    :class=\"{ selectable: state.selectable, hover: state.hovered, selected: state.selected }\"\n    :config=\"state.line.stroke\"\n    :marker-start=\"state.sourceMarkerId ? `url('#${state.sourceMarkerId}')` : undefined\"\n    :marker-end=\"state.targetMarkerId ? `url('#${state.targetMarkerId}')` : undefined\"\n    class=\"v-ng-edge\"\n  />\n  <v-line\n    v-else-if=\"config.type == 'straight' || !state.curve\"\n    :data-edge-id=\"id\"\n    v-bind=\"state.position\"\n    :class=\"{ selectable: state.selectable, hover: state.hovered, selected: state.selected }\"\n    :config=\"state.line.stroke\"\n    :marker-start=\"state.sourceMarkerId ? `url('#${state.sourceMarkerId}')` : undefined\"\n    :marker-end=\"state.targetMarkerId ? `url('#${state.targetMarkerId}')` : undefined\"\n    class=\"v-ng-edge\"\n  />\n  <v-edge-curved\n    v-else\n    :data-edge-id=\"id\"\n    :class=\"{ selectable: state.selectable, hover: state.hovered, selected: state.selected }\"\n    :state=\"state\"\n    :config=\"state.line.stroke\"\n    :marker-start=\"state.sourceMarkerId ? `url('#${state.sourceMarkerId}')` : undefined\"\n    :marker-end=\"state.targetMarkerId ? `url('#${state.targetMarkerId}')` : undefined\"\n    class=\"v-ng-edge\"\n  />\n</template>\n\n<style lang=\"scss\">\n$transition: 0.1s linear;\n\n.v-ng-edge {\n  transition:\n    stroke $transition,\n    stroke-width $transition;\n  pointer-events: none;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, watchEffect } from \"vue\"\nimport { AnyShapeStyle } from \"@/common/configs\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { applyScaleToDasharray } from \"@/utils/visual\"\n\ninterface Props {\n  baseX?: number\n  baseY?: number\n  config: AnyShapeStyle\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  baseX: 0,\n  baseY: 0,\n})\n\nconst { scale } = useZoomLevel()\n\nconst x = ref(props.baseX)\nconst y = ref(props.baseY)\nconst strokeWidth = ref(0)\nconst strokeColor = ref(\"#000000\")\nconst strokeDasharray = ref<string | number | undefined>(undefined)\nconst radius = ref(0)\nconst width = ref(0)\nconst height = ref(0)\nconst borderRadius = ref(0)\n\nwatchEffect(() => {\n  const s = scale.value\n  strokeWidth.value = props.config.strokeWidth * s\n  strokeColor.value = props.config.strokeColor ?? \"none\"\n  strokeDasharray.value = applyScaleToDasharray(props.config.strokeDasharray, s)\n\n  if (props.config.type === \"circle\") {\n    x.value = props.baseX\n    y.value = props.baseY\n    radius.value = props.config.radius * s\n  } else {\n    width.value = props.config.width * s\n    height.value = props.config.height * s\n    borderRadius.value = props.config.borderRadius * s\n    x.value = props.baseX - width.value / 2\n    y.value = props.baseY - height.value / 2\n  }\n})\n</script>\n\n<template>\n  <circle\n    v-if=\"config.type === 'circle'\"\n    class=\"v-ng-shape-circle\"\n    :cx=\"x\"\n    :cy=\"y\"\n    :r=\"radius\"\n    :fill=\"config.color\"\n    :stroke=\"strokeColor\"\n    :stroke-width=\"strokeWidth\"\n    :stroke-dasharray=\"strokeDasharray\"\n  />\n  <rect\n    v-else\n    class=\"v-ng-shape-rect\"\n    :x=\"x\"\n    :y=\"y\"\n    :width=\"width\"\n    :height=\"height\"\n    :rx=\"borderRadius\"\n    :ry=\"borderRadius\"\n    :fill=\"config.color\"\n    :stroke=\"strokeColor\"\n    :stroke-width=\"strokeWidth\"\n    :stroke-dasharray=\"strokeDasharray\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { computed, reactive, Ref, ref, useAttrs, watch, onMounted, onUnmounted } from \"vue\"\nimport { LabelStyle } from \"@/common/configs\"\nimport { useZoomLevel } from \"@/composables/zoom\"\n\ntype Rect = { x: number; y: number; width: number; height: number }\n\ninterface Props {\n  text: string\n  x?: number\n  y?: number\n  dominantBaseline?: string\n  config: LabelStyle\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  x: 0,\n  y: 0,\n  dominantBaseline: \"central\",\n})\n\nconst attrs = useAttrs()\n\nconst { scale } = useZoomLevel()\n\nconst texts = computed(() => props.text?.toString().split(/\\r?\\n/) ?? \"\")\n\nconst fontSize = computed(() => {\n  return (attrs[\"font-size\"] as number) ?? props.config.fontSize * scale.value\n})\n\nconst lineHeight = computed(() => fontSize.value * props.config.lineHeight)\n\nconst topDeltaY = computed(() => {\n  const dominantBaseline = props.dominantBaseline\n  if (dominantBaseline === \"hanging\") {\n    return 0\n  } else if (dominantBaseline === \"central\") {\n    return -(lineHeight.value * (texts.value.length - 1)) / 2\n  } else {\n    // \"auto\", \"text-top\"\n    return -lineHeight.value * (texts.value.length - 1)\n  }\n})\n\nconst element = ref<SVGTextElement>()\nconst transform = ref(\"\") // copy from <text>\nconst pos = reactive<Rect>({ x: 0, y: 0, width: 0, height: 0 })\nconst backgroundRectPos = computed(() => {\n  const config = props.config.background\n  if (!config) return pos\n  let paddingVertical, paddingHorizontal\n  if (config.padding instanceof Object) {\n    paddingVertical = config.padding.vertical\n    paddingHorizontal = config.padding.horizontal\n  } else {\n    paddingVertical = config.padding ?? 0\n    paddingHorizontal = config.padding ?? 0\n  }\n  const lineMargin = lineHeight.value - fontSize.value\n  return {\n    x: pos.x - paddingHorizontal * scale.value,\n    y: pos.y - paddingVertical * scale.value - lineMargin / 2,\n    width: pos.width + paddingHorizontal * 2 * scale.value,\n    height: pos.height + paddingVertical * 2 * scale.value + lineMargin,\n  }\n})\n\nlet observer: MutationObserver | undefined\nconst updateObserver = () => {\n  if (props.config.background && props.config.background.visible) {\n    if (!observer && element.value) {\n      observer = enableMutationObserver(element.value, pos, transform)\n    }\n  } else {\n    observer?.disconnect()\n    observer = undefined\n  }\n}\n\nonMounted(() => updateObserver())\nwatch(\n  () => props.config.background && props.config.background.visible,\n  (v, prev) => {\n    if (v == prev) return\n    updateObserver()\n  }\n)\nonUnmounted(() => {\n  observer?.disconnect()\n  observer = undefined\n})\n\nfunction updateBackgroundPosition(\n  element: SVGTextElement,\n  pos: Rect,\n  transform: Ref<string | undefined>\n) {\n  const bbox = element.getBBox()\n  pos.x = bbox.x\n  pos.y = bbox.y\n  pos.width = bbox.width\n  pos.height = bbox.height\n  transform.value = element.getAttribute(\"transform\") ?? undefined\n}\n\nfunction enableMutationObserver(\n  element: SVGTextElement,\n  pos: Rect,\n  transform: Ref<string | undefined>\n) {\n  const observer = new MutationObserver(() => {\n    updateBackgroundPosition(element, pos, transform)\n  })\n  observer.observe(element, {\n    attributes: true,\n    attributeFilter: [\"x\", \"y\", \"transform\", \"font-size\"],\n  })\n  updateBackgroundPosition(element, pos, transform)\n  return observer\n}\n</script>\n\n<template>\n  <rect\n    v-if=\"config.background && config.background.visible\"\n    class=\"v-ng-text-background\"\n    v-bind=\"backgroundRectPos\"\n    :rx=\"(config.background?.borderRadius ?? 0) * scale\"\n    :ry=\"(config.background?.borderRadius ?? 0) * scale\"\n    :fill=\"config.background?.color ?? '#ffffff'\"\n    :transform=\"transform\"\n  />\n  <text\n    ref=\"element\"\n    class=\"v-ng-text\"\n    v-bind=\"$attrs\"\n    :x=\"x\"\n    :y=\"y\"\n    :dominant-baseline=\"dominantBaseline\"\n    :font-family=\"$attrs['font-family'] ? `${$attrs['font-family']}` : config.fontFamily\"\n    :font-size=\"fontSize\"\n    :fill=\"$attrs.fill ? `${$attrs.fill}` : config.color\"\n  >\n    <template v-if=\"texts.length <= 1\">\n      {{ text }}\n    </template>\n    <template v-else>\n      <!--\n        In Safari, it seems that `<tspan>` does not inherit the\n        `dominant-baseline` attribute from its parent `<text>` element.\n        Therefore, set the dominant-baseline directly on `<tspan>`.\n        Chrome and Firefox do not have this issue.\n        refs. https://stackoverflow.com/questions/41985077/centering-an-svg-element-chrome-vs-safari/42023579#42023579\n      -->\n      <tspan\n        v-for=\"(t, i) in texts\"\n        :key=\"i\"\n        :x=\"x\"\n        :dy=\"i == 0 ? topDeltaY : lineHeight\"\n        :dominant-baseline=\"dominantBaseline\"\n      >{{ t }}</tspan>\n    </template>\n  </text>\n</template>\n","<script setup lang=\"ts\">\nimport { computed, ref, watchEffect } from \"vue\"\nimport { Edges, NodePositions, LinePosition, Position } from \"@/common/types\"\nimport { Config } from \"@/common/configs\"\nimport { useEdgeConfig } from \"@/composables/config\"\nimport { useStates } from \"@/composables/state\"\nimport { useMouseOperation } from \"@/composables/mouse\"\nimport VLine from \"@/components/base/VLine.vue\"\nimport VShape from \"@/components/base/VShape.vue\"\nimport VText from \"@/components/base/VLabelText.vue\"\n\nconst props = defineProps<{\n  edges: Edges\n  layouts: NodePositions\n}>()\n\nconst config = useEdgeConfig()\nconst {\n  handleEdgesPointerDownEvent,\n  handleEdgesPointerOverEvent,\n  handleEdgesPointerOutEvent,\n  handleEdgesClickEvent,\n  handleEdgesDoubleClickEvent,\n  handleEdgesContextMenu,\n} = useMouseOperation()\n\nconst { edgeStates } = useStates()\n\n// Since the specified edges are in the same pair,\n// get the first one and draw it.\nconst pos = ref<LinePosition>({ p1: { x: 0, y: 0 }, p2: { x: 0, y: 0 } })\nconst centerPos = ref<Position>({ x: 0, y: 0 })\n\nwatchEffect(() => {\n  const edgeId = Object.keys(props.edges).find(edgeId => edgeId in edgeStates)\n  if (edgeId) {\n    pos.value = edgeStates[edgeId].position\n    centerPos.value = {\n      x: (pos.value.p1.x + pos.value.p2.x) / 2,\n      y: (pos.value.p1.y + pos.value.p2.y) / 2,\n    }\n  }\n})\n\nconst edgeIds = computed(() => Object.keys(props.edges))\nconst labelConfig = computed(() => Config.values(config.summarized.label, props.edges))\nconst shapeConfig = computed(() => Config.values(config.summarized.shape, props.edges))\nconst strokeConfig = computed(() => Config.values(config.summarized.stroke, props.edges))\n\nconst hovered = computed(() => edgeIds.value.some(edge => edgeStates[edge].hovered))\nconst selectable = computed(() => edgeIds.value.some(edge => edgeStates[edge].selectable))\nconst selected = computed(() => edgeIds.value.some(edge => edgeStates[edge].selected))\n</script>\n\n<template>\n  <g\n    :class=\"{ 'v-ng-line-summarized': true, hovered, selectable, selected }\"\n    @pointerdown.stop=\"handleEdgesPointerDownEvent(edgeIds, $event)\"\n    @pointerenter.passive=\"handleEdgesPointerOverEvent(edgeIds, $event)\"\n    @pointerleave.passive=\"handleEdgesPointerOutEvent(edgeIds, $event)\"\n    @click.stop=\"handleEdgesClickEvent(edgeIds, $event)\"\n    @dblclick.stop=\"handleEdgesDoubleClickEvent(edgeIds, $event)\"\n    @contextmenu=\"handleEdgesContextMenu(edgeIds, $event)\"\n  >\n    <v-line v-bind=\"pos\" :config=\"strokeConfig\" :data-edge-id=\"edgeIds[0]\" />\n    <v-shape :base-x=\"centerPos.x\" :base-y=\"centerPos.y\" :config=\"shapeConfig\" />\n    <v-text\n      :text=\"Object.keys(edges).length.toString()\"\n      :x=\"centerPos.x\"\n      :y=\"centerPos.y\"\n      :config=\"labelConfig\"\n      text-anchor=\"middle\"\n      dominant-baseline=\"central\"\n    />\n  </g>\n</template>\n\n<style lang=\"scss\">\n.v-ng-line-summarized {\n  &.selectable {\n    cursor: pointer;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { Edge, EdgePosition, Edges, LinePosition, Point } from \"@/common/types\"\nimport { EdgeState } from \"@/models/edge\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { useContainers } from \"@/composables/container\"\nimport { Config } from \"@/common/configs\"\nimport { useEdgeConfig } from \"@/composables/config\"\n\ninterface Props {\n  edgeId?: string\n  edge?: Edge\n  edges?: Edges\n  state: EdgeState\n  isSummarized: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  edgeId: undefined,\n  edge: undefined,\n  edges: () => ({}),\n})\n\nconst { svg } = useContainers()\nconst { scale } = useZoomLevel()\nconst edgeConfig = useEdgeConfig()\n\nfunction getStrokeConfig() {\n  if (props.isSummarized) {\n    return Config.values(edgeConfig.summarized.stroke, props.edges)\n  } else {\n    return props.state.line.stroke\n  }\n}\n\nfunction toEdgePosition(line: LinePosition): EdgePosition {\n  return { source: line.p1, target: line.p2 }\n}\n\nfunction calculateCenterPoint(state: EdgeState): Point {\n  if (state.curve) {\n    return state.curve.center\n  } else {\n    const p1 = state.origin.p1\n    const p2 = state.origin.p2\n    return {\n      x: (p1.x + p2.x) / 2,\n      y: (p1.y + p2.y) / 2,\n    }\n  }\n}\n\nfunction getPathTotalLength() {\n  if (!svg.value) return 0\n  const edgeId = props.edgeId ?? Object.keys(props.edges)[0]\n  const path = svg.value.querySelector<SVGPathElement>(`path[data-edge-id=\"${edgeId}\"]`)\n  if (!path) return 0\n  return path.getTotalLength()\n}\n\nfunction calculatePointAtLength(distance: number): Point {\n  if (!svg.value || !isFinite(distance)) return props.state.position.p1\n\n  // for detecting changes and re-calculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  props.state\n\n  const edgeId = props.edgeId ?? Object.keys(props.edges)[0]\n\n  const path = svg.value.querySelector<SVGPathElement>(`path[data-edge-id=\"${edgeId}\"]`)\n  if (!path) return props.state.position.p1\n\n  const p = path.getPointAtLength(distance)\n  return { x: p.x, y: p.y }\n}\n</script>\n\n<template>\n  <g class=\"v-ng-edge-overlay\">\n    <slot\n      v-if=\"isSummarized\"\n      :edges=\"edges\"\n      :is-summarized=\"isSummarized\"\n      :stroke=\"getStrokeConfig()\"\n      :position=\"toEdgePosition(state.origin)\"\n      :center=\"calculateCenterPoint(state)\"\n      :hovered=\"state.hovered\"\n      :selected=\"state.selected\"\n      :scale=\"scale\"\n      :length=\"getPathTotalLength()\"\n      :point-at-length=\"calculatePointAtLength\"\n    />\n    <slot\n      v-else\n      :edge-id=\"edgeId\"\n      :edge=\"edge\"\n      :edges=\"{ [edgeId!]: edge }\"\n      :is-summarized=\"isSummarized\"\n      :stroke=\"getStrokeConfig()\"\n      :position=\"toEdgePosition(state.origin)\"\n      :center=\"calculateCenterPoint(state)\"\n      :hovered=\"state.hovered\"\n      :selected=\"state.selected\"\n      :scale=\"scale\"\n      :length=\"getPathTotalLength()\"\n      :point-at-length=\"calculatePointAtLength\"\n    />\n  </g>\n</template>\n","<script setup lang=\"ts\">\nimport { useStates, isSummarizedEdges } from \"@/composables/state\"\nimport VEdge from \"./VEdge.vue\"\nimport VEdgeSummarized from \"./VEdgeSummarized.vue\"\nimport VEdgeOverlay from \"./VEdgeOverlay.vue\"\n\ndefineProps<{\n  hasEdgeOverlaySlot: boolean\n}>()\n\nconst { edgeStates, edgeZOrderedList, layouts } = useStates()\n\n// type FlattenEdge = {\n//     key: string\n//     summarize: true\n//     edges: Edges\n//     id?: undefined\n//     edge?: undefined\n// } | {\n//     key: string\n//     summarize: false\n//     edges?: undefined\n//     id: string\n//     edge: Edge\n// }\n\n// const flattenEdges = computed(() => {\n//   const results: FlattenEdge[] = []\n//   for (const [key, {summarize, edges}] of Object.entries(edgeGroupStates.edgeGroups)) {\n//     if (summarize) {\n//       results.push({ key, summarize, edges })\n//     } else {\n//       results.push(...Object.entries(edges).map(([id, edge]) => ({ key, summarize, id, edge })))\n//     }\n//   }\n//   return results\n// })\n</script>\n\n<template>\n  <template v-for=\"entry in edgeZOrderedList\">\n    <template v-if=\"isSummarizedEdges(entry)\">\n      <v-edge-summarized\n        :key=\"entry.key\"\n        :edges=\"entry.group.edges\"\n        :layouts=\"layouts.nodes\"\n      />\n      <v-edge-overlay\n        v-if=\"hasEdgeOverlaySlot\"\n        :key=\"entry.key\"\n        :edges=\"entry.group.edges\"\n        :state=\"edgeStates[Object.keys(entry.group.edges)[0]]\"\n        :is-summarized=\"true\"\n      >\n        <template #default=\"slotProps\">\n          <slot v-bind=\"slotProps\" />\n        </template>\n      </v-edge-overlay>\n    </template>\n    <template v-else>\n      <v-edge\n        :id=\"entry.key\"\n        :key=\"entry.key\"\n        :state=\"edgeStates[entry.key]\"\n        :source-pos=\"layouts.nodes[entry.edge.source]\"\n        :target-pos=\"layouts.nodes[entry.edge.target]\"\n      />\n      <v-edge-overlay\n        v-if=\"hasEdgeOverlaySlot\"\n        :key=\"entry.key\"\n        :edge-id=\"entry.key\"\n        :edge=\"entry.edge\"\n        :state=\"edgeStates[entry.key]\"\n        :is-summarized=\"false\"\n      >\n        <template #default=\"slotProps\">\n          <slot v-bind=\"slotProps\" />\n        </template>\n      </v-edge-overlay>\n    </template>\n  </template>\n</template>\n","<script setup lang=\"ts\">\nimport { computed, useSlots } from \"vue\"\n\nimport VEdgeBackgrounds from \"../edge/VEdgeBackgrounds.vue\"\nimport VEdgeGroups from \"../edge/VEdgeGroups.vue\"\n\nconst slots = useSlots()\n\nconst hasEdgeOverlaySlot = computed(() => \"edge-overlay\" in slots)\n</script>\n\n<template>\n  <!-- edges -->\n  <g class=\"v-ng-layer-edges v-ng-graph-objects\">\n    <v-edge-backgrounds />\n    <v-edge-groups :has-edge-overlay-slot=\"hasEdgeOverlaySlot\">\n      <template v-if=\"hasEdgeOverlaySlot\" #default=\"slotProps\">\n        <slot name=\"edge-overlay\" v-bind=\"slotProps\" />\n      </template>\n    </v-edge-groups>\n  </g>\n</template>\n","<!--\n  When using slots in v-for, unnecessary update hooks are called,\n  resulting in performance degradation.\n  This can be avoided by placing a component inside the v-for and\n  placing a fixed number of slots inside that component.\n  ref: https://github.com/vuejs/core/issues/6833\n-->\n<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { Edge } from \"@/common/types\"\nimport { EdgeState } from \"@/models/edge\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport * as v2d from \"@/modules/calculation/2d\"\n\ninterface Props {\n  edgeId: string\n  edge: Edge\n  state: EdgeState\n}\n\nconst props = defineProps<Props>()\nconst { scale } = useZoomLevel()\n\nconst area = computed(() => {\n  return v2d.calculateEdgeLabelArea(\n    props.state.labelPosition,\n    props.state.line.stroke,\n    props.state.label.margin,\n    props.state.label.padding,\n    scale.value\n  )\n})\n</script>\n<template>\n  <slot\n    v-if=\"!state.loop\"\n    :edge-id=\"edgeId\"\n    :edge=\"edge\"\n    :config=\"state.label\"\n    :area=\"area\"\n    :hovered=\"state.hovered\"\n    :selected=\"state.selected\"\n    :scale=\"scale\"\n  />\n</template>\n","<!--\n  When using slots in v-for, unnecessary update hooks are called,\n  resulting in performance degradation.\n  This can be avoided by placing a component inside the v-for and\n  placing a fixed number of slots inside that component.\n  ref: https://github.com/vuejs/core/issues/6833\n-->\n<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { Edges } from \"@/common/types\"\nimport { EdgeState, SummarizedEdgeState } from \"@/models/edge\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport * as v2d from \"@/modules/calculation/2d\"\n\ninterface Props {\n  edges: Edges\n  state: EdgeState\n  summarizeState?: SummarizedEdgeState\n}\n\nconst props = defineProps<Props>()\nconst { scale } = useZoomLevel()\n\nconst area = computed(() => {\n  return v2d.calculateEdgeLabelArea(\n    props.state.labelPosition,\n    props.summarizeState?.stroke ?? props.state.line.stroke,\n    props.state.label.margin,\n    props.state.label.padding,\n    scale.value\n  )\n})\n</script>\n<template>\n  <slot\n    v-if=\"!state.loop\"\n    :edges=\"edges\"\n    :config=\"state.label\"\n    :area=\"area\"\n    :hovered=\"state.hovered\"\n    :selected=\"state.selected\"\n    :scale=\"scale\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { EdgeGroup } from \"@/models/edge\"\nimport { useStates } from \"@/composables/state\"\nimport VEdgeLabelPlace from \"./VEdgeLabelPlace.vue\"\nimport VEdgeLabelsPlace from \"./VEdgeLabelsPlace.vue\"\n\ninterface Props {\n  enableEdgeLabel: boolean\n  enableEdgesLabel: boolean\n}\n\nwithDefaults(defineProps<Props>(), {\n  enableEdgeLabel: false,\n  enableEdgesLabel: false,\n})\n\nconst { edgeStates, edgeGroupStates, summarizedEdgeStates } = useStates()\n\nconst edgeGroups = computed(() => {\n  const individual: Record<string, EdgeGroup> = {}\n  const summarized: Record<string, EdgeGroup> = {}\n  Object.entries(edgeGroupStates.edgeGroups).forEach(([id, group]) => {\n    if (Object.keys(group.edges).length > 0) {\n      if (group.summarize) {\n        summarized[id] = group\n      } else {\n        individual[id] = group\n      }\n    }\n  })\n  return { individual, summarized }\n})\n\nfunction getRepresentativeEdgeKey(group: EdgeGroup) {\n  return Object.keys(group.edges)[0]\n}\n</script>\n\n<template>\n  <g class=\"v-ng-edge-labels\">\n    <template v-if=\"enableEdgeLabel\">\n      <template v-for=\"(group, id) in edgeGroups.individual\" :key=\"id\">\n        <template v-for=\"(edge, edgeId) in group.edges\" :key=\"edgeId\">\n          <v-edge-label-place\n            :edge-id=\"edgeId\"\n            :edge=\"edge\"\n            :state=\"edgeStates[edgeId]\"\n          >\n            <template #default=\"slotProps\">\n              <slot name=\"edge-label\" v-bind=\"slotProps\" />\n            </template>\n          </v-edge-label-place>\n        </template>\n      </template>\n    </template>\n    <template v-if=\"enableEdgesLabel\">\n      <template v-for=\"(group, id) in edgeGroups.summarized\" :key=\"id\">\n        <v-edge-labels-place\n          :edges=\"group.edges\"\n          :state=\"edgeStates[getRepresentativeEdgeKey(group)]\"\n          :summarize-state=\"summarizedEdgeStates[getRepresentativeEdgeKey(group)]\"\n        >\n          <template #default=\"slotProps\">\n            <slot name=\"edges-label\" v-bind=\"slotProps\" />\n          </template>\n        </v-edge-labels-place>\n      </template>\n    </template>\n  </g>\n</template>\n\n<style lang=\"scss\">\n.v-ng-edge-labels {\n  .v-ng-text,\n  .v-ng-text-background {\n    pointer-events: none;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, reactive, watchEffect } from \"vue\"\nimport { Position } from \"@/common/types\"\nimport { CircleShapeStyle, RectangleShapeStyle, ShapeStyle } from \"@/common/configs\"\nimport { NodeState } from \"@/models/node\"\nimport { useNodeConfig } from \"@/composables/config\"\nimport VShape from \"@/components/base/VShape.vue\"\n\ninterface Props {\n  id: string\n  state: NodeState\n  pos: Position\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  pos: undefined,\n})\n\nconst x = computed(() => props.pos?.x || 0)\nconst y = computed(() => props.pos?.y || 0)\n\nconst config = useNodeConfig()\nconst shapeConfig = reactive<ShapeStyle>({} as any)\n\nwatchEffect(() => {\n  const shapeStyle = props.state.shape\n  if (shapeStyle.type === \"circle\") {\n    const shape: CircleShapeStyle = {\n      type: \"circle\",\n      radius:\n        shapeStyle.radius +\n        (shapeStyle.strokeWidth ?? 0) / 2 +\n        config.focusring.padding +\n        config.focusring.width / 2,\n      color: \"none\",\n      strokeWidth: config.focusring.width,\n      strokeColor: config.focusring.color,\n      strokeDasharray: config.focusring.dasharray,\n    }\n    Object.assign(shapeConfig, shape)\n  } else {\n    const shape: RectangleShapeStyle = {\n      type: \"rect\",\n      width:\n        shapeStyle.width +\n        (shapeStyle.strokeWidth ?? 0) +\n        config.focusring.padding * 2 +\n        config.focusring.width,\n      height:\n        shapeStyle.height +\n        (shapeStyle.strokeWidth ?? 0) +\n        config.focusring.padding * 2 +\n        config.focusring.width,\n      borderRadius:\n        shapeStyle.borderRadius > 0 ? shapeStyle.borderRadius + config.focusring.padding : 0,\n      color: \"none\",\n      strokeWidth: config.focusring.width,\n      strokeColor: config.focusring.color,\n      strokeDasharray: config.focusring.dasharray,\n    }\n    Object.assign(shapeConfig, shape)\n  }\n})\n</script>\n\n<template>\n  <v-shape\n    class=\"v-ng-node-focusring\"\n    :base-x=\"x\"\n    :base-y=\"y\"\n    :config=\"shapeConfig\"\n  />\n</template>\n\n<style lang=\"scss\">\n$transition: 0.1s linear;\n\n.v-ng-node-focusring {\n  pointer-events: none;\n}\n\n:where(.v-ng-shape-circle) {\n  transition: r $transition;\n}\n:where(.v-ng-shape-rect) {\n  transition:\n    x $transition,\n    y $transition,\n    width $transition,\n    height $transition;\n}\n:where(.dragging .v-ng-shape-circle),\n:where(.dragging .v-ng-shape-rect) {\n  transition: none;\n}\n</style>\n","<script setup lang=\"ts\">\nimport VNodeFocusRing from \"@/components/node/VNodeFocusRing.vue\"\nimport { useStates } from \"@/composables/state\"\nimport { useSelections } from \"@/composables/selection\"\nimport { useLayouts } from \"@/composables/layout\"\n\nconst { nodeStates } = useStates()\nconst { selectedNodes } = useSelections()\nconst layouts = useLayouts()\n</script>\n\n<template>\n  <!-- node selections (focus ring) -->\n  <g class=\"v-ng-layer-nodes-selections\">\n    <v-node-focus-ring\n      v-for=\"nodeId in selectedNodes\"\n      :id=\"nodeId\"\n      :key=\"nodeId\"\n      :state=\"nodeStates[nodeId]\"\n      :pos=\"layouts.nodes[nodeId]\"\n    />\n  </g>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\"\nimport { Position } from \"@/common/types\"\nimport { NodeState } from \"@/models/node\"\nimport { useMouseOperation } from \"@/composables/mouse\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport VShape from \"@/components/base/VShape.vue\"\n\ninterface Props {\n  id: string\n  state: NodeState\n  pos?: Position\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  pos: undefined,\n})\n\nconst x = computed(() => props.pos?.x || 0)\nconst y = computed(() => props.pos?.y || 0)\n\nconst { scale } = useZoomLevel()\n\nconst {\n  handleNodePointerDownEvent,\n  handleNodePointerOverEvent,\n  handleNodePointerOutEvent,\n  handleNodeClickEvent,\n  handleNodeDoubleClickEvent,\n  handleNodeContextMenu,\n} = useMouseOperation()\n</script>\n\n<template>\n  <g\n    :class=\"{ 'v-ng-node': true, hover: state.hovered, selected: state.selected }\"\n    :transform=\"`translate(${x} ${y})`\"\n    @pointerdown.stop=\"handleNodePointerDownEvent(id, $event)\"\n    @pointerenter.passive=\"handleNodePointerOverEvent(id, $event)\"\n    @pointerleave.passive=\"handleNodePointerOutEvent(id, $event)\"\n    @click.stop=\"handleNodeClickEvent(id, $event)\"\n    @dblclick.stop=\"handleNodeDoubleClickEvent(id, $event)\"\n    @contextmenu=\"handleNodeContextMenu(id, $event)\"\n  >\n    <slot\n      name=\"override-node\"\n      :node-id=\"id\"\n      :scale=\"scale\"\n      :config=\"state.shape\"\n      :class=\"{ draggable: state.draggable, selectable: state.selectable }\"\n    >\n      <v-shape\n        :config=\"state.shape\"\n        :class=\"{\n          'v-ng-node-default': true,\n          draggable: state.draggable,\n          selectable: state.selectable,\n        }\"\n      />\n    </slot>\n  </g>\n</template>\n\n<style lang=\"scss\">\n$transition: 0.1s linear;\n\n.v-ng-node {\n  :where(.v-ng-shape-circle) {\n    transition:\n      fill $transition,\n      stroke $transition,\n      stroke-width $transition,\n      r $transition;\n  }\n  :where(.v-ng-shape-rect) {\n    transition:\n      fill $transition,\n      stroke $transition,\n      stroke-width $transition,\n      x $transition,\n      y $transition,\n      width $transition,\n      height $transition;\n  }\n\n  :where(.v-ng-node-default.v-ng-shape-circle) {\n    pointer-events: none;\n  }\n  :where(.v-ng-node-default.v-ng-shape-rect) {\n    pointer-events: none;\n  }\n\n  .draggable,\n  .selectable {\n    pointer-events: all;\n    cursor: pointer;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, useSlots } from \"vue\"\nimport { useNodeConfig } from \"@/composables/config\"\nimport { useLayouts } from \"@/composables/layout\"\nimport { useStates } from \"@/composables/state\"\nimport VNode from \"@/components/node/VNode.vue\"\n\nconst slots = useSlots()\nconst hasOverrideNodeSlot = computed(() => \"override-node\" in slots)\nconst { nodeZOrderedList } = useStates()\n\nconst configs = useNodeConfig()\nconst layouts = useLayouts()\n</script>\n\n<template>\n  <template v-if=\"hasOverrideNodeSlot\">\n    <transition-group\n      :name=\"configs.transition\"\n      :css=\"!!configs.transition\"\n      tag=\"g\"\n      class=\"v-ng-layer-nodes v-ng-graph-objects\"\n    >\n      <v-node\n        v-for=\"nodeState in nodeZOrderedList\"\n        :id=\"nodeState.id\"\n        :key=\"nodeState.id\"\n        :state=\"nodeState\"\n        :pos=\"layouts.nodes[nodeState.id]\"\n      >\n        <!-- override the node -->\n        <template #override-node=\"slotProps\">\n          <slot name=\"override-node\" v-bind=\"slotProps\" />\n        </template>\n      </v-node>\n    </transition-group>\n  </template>\n  <template v-else>\n    <!--\n      If a `v-node` contains a slot and no external slot is specified,\n      `v-ng-layer-nodes` element will be needlessly redrawn and all\n      `v-node` components get update notifications. Therefore, if there is\n      no external slot, do not specify a slot in the `v-node` component. -->\n    <transition-group\n      :name=\"configs.transition\"\n      :css=\"!!configs.transition\"\n      tag=\"g\"\n      class=\"v-ng-layer-nodes v-ng-graph-objects\"\n    >\n      <v-node\n        v-for=\"nodeState in nodeZOrderedList\"\n        :id=\"nodeState.id\"\n        :key=\"nodeState.id\"\n        :state=\"nodeState\"\n        :pos=\"layouts.nodes[nodeState.id]\"\n      />\n    </transition-group>\n  </template>\n</template>\n","import { NodeLabelDirection, NodeLabelDirectionType, OppositeNodes } from \"@/common/configs\"\nimport { Position } from \"@/common/types\"\nimport { subtract, angleDegree } from \"@/modules/vector2d\"\n\nconst labelDirections: Record<NodeLabelDirectionType, number> = {\n  [NodeLabelDirection.NORTH]: 0,\n  [NodeLabelDirection.NORTH_EAST]: 1,\n  [NodeLabelDirection.EAST]: 2,\n  [NodeLabelDirection.SOUTH_EAST]: 3,\n  [NodeLabelDirection.SOUTH]: 4,\n  [NodeLabelDirection.SOUTH_WEST]: 5,\n  [NodeLabelDirection.WEST]: 6,\n  [NodeLabelDirection.NORTH_WEST]: 7,\n  [NodeLabelDirection.CENTER]: -1,\n}\n\nconst denyAngles: ((a: number, loop: boolean) => boolean)[] = [\n  /* N */ (a, loop) => inRange(a, 0, loop ? 90 : 60),\n  /* NE */ (a, loop) => inRange(a, 45, loop ? 90 : 45),\n  /* E */ (a, loop) => inRange(a, 90, loop ? 60 : 30),\n  /* SE */ (a, loop) => inRange(a, 135, loop ? 90 : 45),\n  /* S */ (a, loop) => inRange(a, 180, loop ? 90 : 60),\n  /* SW */ (a, loop) => inRange(a, 225, loop ? 90 : 45),\n  /* W */ (a, loop) => inRange(a, 270, loop ? 60 : 30),\n  /* NW */ (a, loop) => inRange(a, 315, loop ? 90 : 45),\n]\n\nexport function handleNodeLabelAutoAdjustment(\n  nodeId: string,\n  currentPos: Position,\n  oppositeNodes: OppositeNodes,\n  getLoopCenter: (edgeId: string) => Position | undefined,\n  defaultDirection: NodeLabelDirectionType\n): NodeLabelDirectionType {\n  if (defaultDirection === NodeLabelDirection.CENTER) {\n    return NodeLabelDirection.CENTER\n  }\n\n  // Avoid overlapping edges from the node.\n  const angles: [number, boolean][] = []\n  Object.entries(oppositeNodes).forEach(([edgeId, oppositeNode]) => {\n    let isSelfLoop = false\n    if (oppositeNode.nodeId === nodeId) {\n      // self looped edge\n      const center = getLoopCenter(edgeId)\n      if (center) {\n        isSelfLoop = true\n        oppositeNode = {\n          ...oppositeNode,\n          pos: { x: center.x, y: center.y },\n        }\n      }\n    }\n    // angleDegree(): east=0, north=90, west=180, south=-90\n    // -> Divide into 10 azimuths except horizontal, and assign indexes including\n    //    horizontal in clockwise direction\n    const angle = (angleDegree(subtract(oppositeNode.pos, currentPos)) + 360 + 90) % 360\n    angles.push([angle, isSelfLoop])\n  })\n\n  const directionIndex = directionToIndex(defaultDirection)\n\n  // order of priority.\n  const candidates = [\n    directionIndex,\n    (directionIndex + 4) % 8, // priority is given to diagonals\n    (directionIndex + 2) % 8,\n    (directionIndex - 2 + 8) % 8,\n    (directionIndex + 1) % 8,\n    (directionIndex - 1 + 8) % 8,\n    (directionIndex + 3) % 8,\n    (directionIndex - 3 + 8) % 8,\n  ]\n\n  const azimuth = candidates.find(c => {\n    return angles.every(a => !denyAngles[c](...a))\n  })\n  if (azimuth === undefined) {\n    return defaultDirection\n  } else {\n    return indexToDirection(azimuth, defaultDirection)\n  }\n}\n\nfunction inRange(target: number, center: number, amount: number): boolean {\n  target %= 360\n  const min = (center - amount + 360) % 360\n  const max = (center + amount) % 360\n  if (min <= max) {\n    return min < target && target < max\n  } else {\n    return min < target || target < max\n  }\n}\n\nfunction directionToIndex(direction: NodeLabelDirectionType) {\n  return labelDirections[direction] ?? 0\n}\n\nfunction indexToDirection(index: number, defaultValue: NodeLabelDirectionType) {\n  return (Object.entries(labelDirections)[index]?.[0] ?? defaultValue) as NodeLabelDirectionType\n}\n","<script setup lang=\"ts\">\nimport { computed, ref, watchEffect } from \"vue\"\nimport { Position } from \"@/common/types\"\nimport { NodeLabelDirection } from \"@/common/configs\"\nimport { NodeState } from \"@/models/node\"\nimport { useMouseOperation } from \"@/composables/mouse\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { useNodeConfig } from \"@/composables/config\"\nimport { useStates } from \"@/composables/state\"\nimport { handleNodeLabelAutoAdjustment } from \"@/modules/node/label\"\nimport VLabelText from \"@/components/base/VLabelText.vue\"\n\ninterface Props {\n  id: string\n  state: NodeState\n  pos?: Position\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  pos: undefined,\n})\n\nconst configs = useNodeConfig()\nconst { edgeStates } = useStates()\nconst { scale } = useZoomLevel()\n\nconst {\n  handleNodePointerDownEvent,\n  handleNodePointerOverEvent,\n  handleNodePointerOutEvent,\n  handleNodeClickEvent,\n  handleNodeDoubleClickEvent,\n  handleNodeContextMenu,\n} = useMouseOperation()\n\nconst x = computed(() => props.pos?.x || 0)\nconst y = computed(() => props.pos?.y || 0)\n\nconst labelMargin = computed(() => {\n  if (props.state.label.direction === NodeLabelDirection.CENTER) {\n    return 0\n  } else {\n    return props.state.label.margin * scale.value\n  }\n})\n\nconst labelShiftV = ref(0) // Amount of label shift (vertical)\nconst labelShiftH = ref(0) // Amount of label shift (horizontal)\nconst labelDiagonalShiftV = ref(0) // Amount of shift in diagonal direction (vertical)\nconst labelDiagonalShiftH = ref(0) // Amount of shift in diagonal direction (horizontal)\n\nconst labelDirection = computed(() => {\n  const direction = props.state.label.direction\n  const autoAdjustment = props.state.label.directionAutoAdjustment\n  if (autoAdjustment === false) {\n    return direction\n  }\n\n  const pos = { x: x.value, y: y.value }\n  if (autoAdjustment === true) {\n    return handleNodeLabelAutoAdjustment(\n      props.state.id,\n      pos,\n      props.state.oppositeNodes,\n      (edgeId: string) => edgeStates[edgeId]?.loop?.center,\n      direction\n    )\n  } else {\n    return (\n      autoAdjustment({\n        nodeId: props.state.id,\n        pos,\n        oppositeNodes: props.state.oppositeNodes,\n      }) ?? direction\n    )\n  }\n})\n\nconst textAnchor = computed(() => {\n  switch (labelDirection.value) {\n    case NodeLabelDirection.CENTER:\n    case NodeLabelDirection.NORTH:\n    case NodeLabelDirection.SOUTH:\n      return \"middle\"\n    case NodeLabelDirection.EAST:\n    case NodeLabelDirection.NORTH_EAST:\n    case NodeLabelDirection.SOUTH_EAST:\n      return \"start\"\n    case NodeLabelDirection.WEST:\n    case NodeLabelDirection.NORTH_WEST:\n    case NodeLabelDirection.SOUTH_WEST:\n    default:\n      return \"end\"\n  }\n})\n\nconst dominantBaseline = computed(() => {\n  switch (labelDirection.value) {\n    case NodeLabelDirection.NORTH:\n    case NodeLabelDirection.NORTH_EAST:\n    case NodeLabelDirection.NORTH_WEST:\n      return \"text-top\"\n    case NodeLabelDirection.SOUTH:\n    case NodeLabelDirection.SOUTH_EAST:\n    case NodeLabelDirection.SOUTH_WEST:\n      return \"hanging\"\n    case NodeLabelDirection.CENTER:\n    case NodeLabelDirection.EAST:\n    case NodeLabelDirection.WEST:\n    default:\n      return \"central\"\n  }\n})\n\nconst labelX = computed(() => {\n  switch (labelDirection.value) {\n    case NodeLabelDirection.CENTER:\n    case NodeLabelDirection.NORTH:\n    case NodeLabelDirection.SOUTH:\n      return 0\n    case NodeLabelDirection.EAST:\n      return labelShiftH.value\n    case NodeLabelDirection.WEST:\n      return -labelShiftH.value\n    case NodeLabelDirection.NORTH_EAST:\n    case NodeLabelDirection.SOUTH_EAST:\n      return labelDiagonalShiftH.value\n    case NodeLabelDirection.NORTH_WEST:\n    case NodeLabelDirection.SOUTH_WEST:\n    default:\n      return -labelDiagonalShiftH.value\n  }\n})\n\nconst labelY = computed(() => {\n  switch (labelDirection.value) {\n    case NodeLabelDirection.NORTH:\n      return -labelShiftV.value\n    case NodeLabelDirection.SOUTH:\n      return labelShiftV.value\n    case NodeLabelDirection.CENTER:\n    case NodeLabelDirection.EAST:\n    case NodeLabelDirection.WEST:\n      return 0\n    case NodeLabelDirection.NORTH_EAST:\n    case NodeLabelDirection.NORTH_WEST:\n      return -labelDiagonalShiftV.value\n    case NodeLabelDirection.SOUTH_EAST:\n    case NodeLabelDirection.SOUTH_WEST:\n    default:\n      return labelDiagonalShiftV.value\n  }\n})\n\nwatchEffect(() => {\n  const s = scale.value\n  const shape = props.state.shape\n  if (shape.type == \"circle\") {\n    const radius = shape.radius * s\n    const m = radius + labelMargin.value\n    const diagonalMargin = Math.sqrt(m ** 2 / 2)\n    labelShiftV.value = radius + labelMargin.value\n    labelShiftH.value = radius + labelMargin.value\n    labelDiagonalShiftV.value = diagonalMargin\n    labelDiagonalShiftH.value = diagonalMargin\n  } else {\n    const borderRadius = shape.borderRadius * s\n    const width = shape.width * s\n    const height = shape.height * s\n    const m = borderRadius + labelMargin.value\n    const diagonalMargin = Math.sqrt(m ** 2 / 2)\n    labelShiftV.value = height / 2 + labelMargin.value\n    labelShiftH.value = width / 2 + labelMargin.value\n    labelDiagonalShiftV.value = height / 2 - borderRadius + diagonalMargin\n    labelDiagonalShiftH.value = width / 2 - borderRadius + diagonalMargin\n  }\n})\n\nconst eventHandlers = computed(() => (id: string) => {\n  if (configs.label.handleNodeEvents) {\n    return {\n      pointerdown: (e: PointerEvent) => {\n        e.stopPropagation()\n        handleNodePointerDownEvent(id, e)\n      },\n      pointerenter: (e: PointerEvent) => handleNodePointerOverEvent(id, e),\n      pointerleave: (e: PointerEvent) => handleNodePointerOutEvent(id, e),\n      click: (e: MouseEvent) => {\n        e.stopPropagation()\n        handleNodeClickEvent(id, e)\n      },\n      dblclick: (e: MouseEvent) => {\n        e.stopPropagation()\n        handleNodeDoubleClickEvent(id, e)\n      },\n      contextmenu: (e: MouseEvent) => {\n        handleNodeContextMenu(id, e)\n      },\n    }\n  } else {\n    return {}\n  }\n})\n\nconst groupClasses = computed(() => {\n  const handleEvents = configs.label.handleNodeEvents\n  return {\n    \"v-ng-node-label\": true,\n    hover: handleEvents && props.state.hovered,\n    selected: handleEvents && props.state.selected,\n  }\n})\n\nconst labelClasses = computed(() => {\n  const handleEvents = configs.label.handleNodeEvents\n  return {\n    draggable: handleEvents && props.state.draggable,\n    selectable: handleEvents && props.state.selectable,\n  }\n})\n</script>\n\n<template>\n  <g\n    :class=\"groupClasses\"\n    :transform=\"`translate(${x} ${y})`\"\n    v-on=\"eventHandlers(id)\"\n  >\n    <slot\n      name=\"override-node-label\"\n      :node-id=\"id\"\n      :scale=\"scale\"\n      :text=\"state.labelText\"\n      :x=\"labelX\"\n      :y=\"labelY\"\n      :config=\"state.label\"\n      :shape=\"state.shape\"\n      :text-anchor=\"textAnchor\"\n      :dominant-baseline=\"dominantBaseline\"\n      :class=\"labelClasses\"\n    >\n      <v-label-text\n        :text=\"state.labelText\"\n        :x=\"0\"\n        :y=\"0\"\n        :config=\"state.label\"\n        :text-anchor=\"textAnchor\"\n        :dominant-baseline=\"dominantBaseline\"\n        :class=\"labelClasses\"\n        :transform=\"`translate(${labelX} ${labelY})`\"\n      />\n    </slot>\n  </g>\n</template>\n\n<style lang=\"scss\">\n$transition: 0.1s linear;\n\n:where(.v-ng-node-label) {\n  > :where(*) {\n    cursor: default;\n    user-select: none;\n    transition: transform $transition;\n  }\n\n  .draggable,\n  .selectable {\n    pointer-events: all;\n    cursor: pointer;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, useSlots } from \"vue\"\nimport { useNodeConfig } from \"@/composables/config\"\nimport { useLayouts } from \"@/composables/layout\"\nimport { useStates } from \"@/composables/state\"\nimport { NodeState } from \"@/models/node\"\nimport VNodeLabel from \"@/components/node/VNodeLabel.vue\"\n\nconst slots = useSlots()\nconst hasOverrideNodeLabelSlot = computed(() => \"override-node-label\" in slots)\nconst { nodeZOrderedList } = useStates()\n\nconst configs = useNodeConfig()\nconst layouts = useLayouts()\n\nconst nodeStates = computed(() => onlyHasDisplayLabel(nodeZOrderedList.value))\n\nfunction onlyHasDisplayLabel(nodeZOrderedList: NodeState[]): NodeState[] {\n  return nodeZOrderedList.filter(state => {\n    return state.label.visible && (state.labelText ?? false)\n  })\n}\n</script>\n\n<template>\n  <template v-if=\"hasOverrideNodeLabelSlot\">\n    <transition-group\n      :name=\"configs.transition\"\n      :css=\"!!configs.transition\"\n      tag=\"g\"\n      class=\"v-ng-layer-node-labels v-ng-graph-objects\"\n    >\n      <v-node-label\n        v-for=\"nodeState in nodeStates\"\n        :id=\"nodeState.id\"\n        :key=\"nodeState.id\"\n        :state=\"nodeState\"\n        :pos=\"layouts.nodes[nodeState.id]\"\n      >\n        <!-- override the node label -->\n        <template #override-node-label=\"slotProps\">\n          <slot name=\"override-node-label\" v-bind=\"slotProps\" />\n        </template>\n      </v-node-label>\n    </transition-group>\n  </template>\n  <template v-else>\n    <transition-group\n      :name=\"configs.transition\"\n      :css=\"!!configs.transition\"\n      tag=\"g\"\n      class=\"v-ng-layer-node-labels v-ng-graph-objects\"\n    >\n      <v-node-label\n        v-for=\"nodeState in nodeStates\"\n        :id=\"nodeState.id\"\n        :key=\"nodeState.id\"\n        :state=\"nodeState\"\n        :pos=\"layouts.nodes[nodeState.id]\"\n      />\n    </transition-group>\n  </template>\n</template>\n","<script setup lang=\"ts\">\nimport { chunk } from \"lodash-es\"\nimport { CSSProperties, computed } from \"vue\"\nimport { PositionOrCurve } from \"@/common/types\"\nimport { Config } from \"@/common/configs\"\nimport { PathState } from \"@/models/path\"\nimport { usePathConfig } from \"@/composables/config\"\nimport { useZoomLevel } from \"@/composables/zoom\"\nimport { applyScaleToDasharray, getDasharrayUnit } from \"@/utils/visual\"\nimport { useStates } from \"@/composables/state\"\nimport { calculatePathPoints } from \"@/modules/calculation/path\"\n\nconst props = defineProps<{\n  path: PathState\n}>()\n\nconst { nodeStates, edgeStates, layouts } = useStates()\nconst { scale } = useZoomLevel()\nconst pathConfig = usePathConfig()\n\nfunction calcPathPoints(path: PathState): PositionOrCurve[] {\n  if (path.edges.length === 0) return []\n  const margin = Config.value(pathConfig.margin, path.path) * scale.value\n  return calculatePathPoints(\n    path,\n    nodeStates,\n    layouts.nodes,\n    edgeStates,\n    scale.value,\n    pathConfig.curveInNode,\n    pathConfig.end,\n    margin\n  )\n}\n\nfunction calcPathD(path: PathState) {\n  const points = calcPathPoints(path)\n  let move = true\n  return points\n    .map(p => {\n      if (p === null) {\n        move = true\n      } else if (typeof p === \"string\") {\n        return p\n      } else if (p instanceof Array) {\n        p = [...p]\n        const list = []\n        if (p.length % 2 === 1) {\n          const x = p[0]\n          p = p.slice(1)\n          list.push(`L ${x.x} ${x.y}`)\n        }\n        chunk(p, 2).map(([p1, p2]) => list.push(`Q ${p1.x} ${p1.y} ${p2.x} ${p2.y}`))\n        return list.join(\" \")\n      } else {\n        const m = move\n        move = false\n        return `${m ? \"M \" : \"L \"}${p.x} ${p.y}`\n      }\n    })\n    .join(\" \")\n}\n\nconst config = computed(() => {\n  const state = props.path\n  if (state.selected) {\n    return Config.values(pathConfig.selected, state.path)\n  } else if (state.hovered && pathConfig.hover) {\n    return Config.values(pathConfig.hover, state.path)\n  } else {\n    return Config.values(pathConfig.normal, state.path)\n  }\n})\n\nconst strokeDasharray = computed(() => {\n  return applyScaleToDasharray(config.value.dasharray, scale.value)\n})\n\nconst animationSpeed = computed(() => {\n  const speed = config.value.animate\n    ? getDasharrayUnit(config.value.dasharray) * config.value.animationSpeed * scale.value\n    : false\n  return speed ? ({ \"--animation-speed\": speed } as CSSProperties) : undefined\n})\n</script>\n\n<template>\n  <path\n    :class=\"{\n      'v-ng-path': true,\n      animate: config.animate,\n      clickable: path.clickable,\n      hoverable: path.hoverable,\n    }\"\n    :d=\"calcPathD(path)\"\n    fill=\"none\"\n    :stroke=\"config.color\"\n    :stroke-width=\"config.width * scale\"\n    :stroke-dasharray=\"strokeDasharray\"\n    :stroke-linecap=\"config.linecap\"\n    :stroke-linejoin=\"config.linejoin\"\n    :style=\"animationSpeed\"\n  />\n</template>\n\n<style lang=\"scss\">\n$transition: 0.1s linear;\n\n.v-path {\n  pointer-events: none;\n  transition:\n    stroke $transition,\n    stroke-width $transition;\n\n  &.clickable {\n    pointer-events: stroke;\n    cursor: pointer;\n  }\n  &.hoverable {\n    pointer-events: stroke;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { useStates } from \"@/composables/state\"\nimport { usePathConfig } from \"@/composables/config\"\nimport { useMouseOperation } from \"@/composables/mouse\"\nimport VPath from \"./VPath.vue\"\n\nconst { pathZOrderedList } = useStates()\nconst pathConfig = usePathConfig()\n\nconst {\n  handlePathPointerDownEvent,\n  handlePathPointerOverEvent,\n  handlePathPointerOutEvent,\n  handlePathClickEvent,\n  handlePathDoubleClickEvent,\n  handlePathContextMenu,\n} = useMouseOperation()\n</script>\n\n<template>\n  <transition-group\n    :name=\"pathConfig.transition\"\n    :css=\"!!pathConfig.transition\"\n    tag=\"g\"\n    class=\"v-ng-paths v-ng-layer-paths v-ng-graph-objects\"\n  >\n    <template v-for=\"path in pathZOrderedList\" :key=\"path.id\">\n      <v-path\n        :path=\"path\"\n        @pointerdown=\"handlePathPointerDownEvent(path.id, $event)\"\n        @pointerenter.passive=\"handlePathPointerOverEvent(path.id, $event)\"\n        @pointerleave.passive=\"handlePathPointerOutEvent(path.id, $event)\"\n        @click.stop=\"handlePathClickEvent(path.id, $event)\"\n        @dblclick.stop=\"handlePathDoubleClickEvent(path.id, $event)\"\n        @contextmenu=\"handlePathContextMenu(path.id, $event)\"\n      />\n    </template>\n  </transition-group>\n</template>\n","<script setup lang=\"ts\">\nimport { readonly, ref, toRef, computed, nextTick, watch, CSSProperties } from \"vue\"\nimport { EventHandlers, Nodes, Edges, InputPaths, Layouts, UserLayouts } from \"@/common/types\"\nimport { Layers, LayerPosition, LayerPositions, Point, Sizes } from \"@/common/types\"\nimport { Reactive, nonNull } from \"@/common/common\"\nimport { UserConfigs, ViewConfig, FitContentMargin } from \"@/common/configs\"\nimport { provideContainers } from \"@/composables/container\"\nimport { provideConfigs } from \"@/composables/config\"\nimport { provideStates, makeStateInput } from \"@/composables/state\"\nimport { provideMouseOperation } from \"@/composables/mouse\"\nimport { provideEventEmitter } from \"@/composables/event-emitter\"\nimport { makeMarkerState } from \"@/composables/marker\"\nimport { useSvgPanZoom } from \"@/composables/svg-pan-zoom\"\nimport { provideZoomLevel } from \"@/composables/zoom\"\nimport { useTransitionWhile } from \"@/composables/transition\"\nimport { useTranslatePathsToObject } from \"@/composables/object\"\nimport { bindProp, bindPropKeySet } from \"@/utils/props\"\nimport * as svgUtils from \"@/utils/svg\"\nimport { SvgPanZoomInstance, Box } from \"@/modules/svg-pan-zoom-ex\"\nimport { exportSvgElement, exportSvgElementWithOptions, ExportOptions } from \"@/utils/svg\"\nimport { provideSelections } from \"@/composables/selection\"\nimport { provideLayouts } from \"@/composables/layout\"\nimport { LayerSlotProps, useBuiltInLayerOrder } from \"@/composables/layer\"\nimport { asyncNextTick } from \"@/modules/vue/nextTick\"\nimport { isPromise } from \"@/utils/object\"\nimport { calculateFit, parseFitContentMargin } from \"@/modules/view/fit\"\nimport VSelectionBox from \"./base/VSelectionBox.vue\"\nimport VMarkerHead from \"./marker/VMarkerHead.vue\"\nimport VBackgroundGrid from \"./background/VBackgroundGrid.vue\"\nimport VBackgroundViewport from \"./background/VBackgroundViewport.vue\"\nimport VEdgesLayer from \"./layers/VEdgesLayer.vue\"\nimport VEdgeLabelsLayer from \"./layers/VEdgeLabelsLayer.vue\"\nimport VFocusringLayer from \"./layers/VFocusringLayer.vue\"\nimport VNodesLayer from \"./layers/VNodesLayer.vue\"\nimport VNodeLabelsLayer from \"./layers/VNodeLabelsLayer.vue\"\nimport VPathsLayer from \"./layers/VPathsLayer.vue\"\n\nconst SYSTEM_SLOTS = [\n  \"override-node\",\n  \"override-node-label\",\n  \"edge-overlay\",\n  \"edge-label\",\n  \"edges-label\",\n]\n\nenum State {\n  INITIAL = 0,\n  LOADED = 1,\n  UNLOADED = 2,\n}\n\ninterface Props {\n  nodes?: Nodes\n  edges?: Edges\n  paths?: InputPaths\n  layouts?: UserLayouts\n  zoomLevel?: number\n  selectedNodes?: string[]\n  selectedEdges?: string[]\n  selectedPaths?: string[]\n  configs?: UserConfigs\n  layers?: Layers\n  eventHandlers?: EventHandlers\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  nodes: () => ({}),\n  edges: () => ({}),\n  paths: () => ({}),\n  layouts: () => ({}),\n  zoomLevel: 1,\n  selectedNodes: () => [],\n  selectedEdges: () => [],\n  selectedPaths: () => [],\n  configs: () => ({}),\n  layers: () => ({}),\n  eventHandlers: () => ({}),\n})\n\nconst emit = defineEmits<{\n  (e: \"update:zoomLevel\", v: number): void\n  (e: \"update:selectedNodes\", v: string[]): void\n  (e: \"update:selectedEdges\", v: string[]): void\n  (e: \"update:selectedPaths\", v: string[]): void\n  (e: \"update:layouts\", v: Layouts): void\n}>()\n\nconst slots = defineSlots<{\n  default: (props: LayerSlotProps) => any\n  [key: string]: (props: LayerSlotProps) => any\n}>()\n\nconst nodesRef = toRef(props, \"nodes\")\nconst edgesRef = toRef(props, \"edges\")\nconst { objects: pathsRef, isInCompatibilityModeForPath } = useTranslatePathsToObject(\n  toRef(props, \"paths\")\n)\n\n// Event Bus\nconst emitter = provideEventEmitter()\nObject.entries(props.eventHandlers).forEach(([type, event]) => {\n  emitter.on(type as any, event as any)\n})\n\n// Style settings\nconst configs = provideConfigs(toRef(props, \"configs\"))\n\n// Additional layers\nconst layerDefs = computed(() => {\n  const definedSlots = new Set(Object.keys(slots))\n  SYSTEM_SLOTS.forEach(s => definedSlots.delete(s))\n\n  const layers = Object.fromEntries(LayerPositions.map(n => [n, [] as string[]]))\n  Object.assign(\n    layers,\n    Object.entries(props.layers).reduce(\n      (accum, [name, type]) => {\n        definedSlots.delete(name)\n        if (type in accum) {\n          accum[type].push(name)\n        } else {\n          accum[type] = [name]\n        }\n        return accum\n      },\n      {} as Record<LayerPosition, string[]>\n    )\n  )\n  // The default slot and any slots not defined in the layers into root.\n  layers[\"root\"].push(...definedSlots)\n  return layers as Record<LayerPosition, string[]>\n})\n\n// Grid layer\nconst isShowGrid = computed(() => configs.view.grid.visible)\nconst isShowBackgroundViewport = computed(() => {\n  const layers = layerDefs.value\n  return isShowGrid.value || layers[\"background\"].length > 0 || layers[\"grid\"].length > 0\n})\n\nconst builtInLayerOrder = useBuiltInLayerOrder(configs, slots)\n\n// -----------------------------------------------------------------------\n// SVG\n// -----------------------------------------------------------------------\nconst container = ref<HTMLDivElement>()\nconst svg = ref<SVGElement & SVGSVGElement>()\nconst viewport = ref<SVGGElement>()\nconst state = ref<State>(State.INITIAL)\nconst show = computed(() => state.value !== State.INITIAL)\n\nconst zoomLevel = bindProp(props, \"zoomLevel\", emit, v => {\n  v = Math.max(v, configs.view.minZoomLevel)\n  v = Math.min(v, configs.view.maxZoomLevel)\n  return v\n})\n\n// SVG pan / zoom\nconst { svgPanZoom, onSvgPanZoomMounted, onSvgPanZoomUnmounted } = useSvgPanZoom(svg, {\n  viewportSelector: \".v-ng-viewport\",\n  minZoom: configs.view.minZoomLevel, // temporary\n  maxZoom: configs.view.maxZoomLevel, // temporary\n  dblClickZoomEnabled: isDoubleClickZoomEnabled(configs.view),\n  mouseWheelZoomEnabled: isMouseWheelZoomEnabled(configs.view),\n  fit: configs.view.autoPanAndZoomOnLoad === \"fit-content\",\n  center: configs.view.autoPanAndZoomOnLoad !== false,\n  zoomEnabled: configs.view.zoomEnabled,\n  preventMouseEventsDefault: false,\n  onZoom: _ => {\n    if (state.value === State.UNLOADED) return\n    const z = svgPanZoom.value?.getRealZoom() ?? 1\n    if (Math.abs(zoomLevel.value - z) >= 1.0e-6) {\n      zoomLevel.value = z\n      emitter.emit(\"view:zoom\", z)\n    }\n  },\n  panEnabled: configs.view.panEnabled,\n  onPan: p => {\n    if (state.value === State.UNLOADED) return\n    emitter.emit(\"view:pan\", p)\n  },\n})\n\nprovideContainers({ container, svg, viewport, svgPanZoom })\n\n// Observe container resizing\nconst rectSize = { width: 0, height: 0 }\nconst resizeObserver = globalThis.ResizeObserver\n  ? new ResizeObserver(() => {\n      svgPanZoom.value?.resize()\n      if (!configs.view.autoPanOnResize) return\n      // Pan to keep the view area centered\n      const r = container.value?.getBoundingClientRect()\n      if (r) {\n        const x = -(rectSize.width - r.width) / 2\n        const y = -(rectSize.height - r.height) / 2\n        svgPanZoom.value?.panBy({ x, y })\n        const { width, height } = r\n        if (rectSize.width !== width || rectSize.height !== height) {\n          Object.assign(rectSize, { width, height })\n          emitter.emit(\"view:resize\", { x: r.x, y: r.y, width, height })\n        }\n      }\n    })\n  : undefined\nonSvgPanZoomMounted(() => {\n  const c = nonNull(container.value, \"svg-pan-zoom container\")\n  resizeObserver?.observe(c)\n  configs.view.onSvgPanZoomInitialized?.(nonNull(svgPanZoom.value, \"svg-pan-zoom instance\"))\n  const r = c.getBoundingClientRect()\n  const { width, height } = r\n  Object.assign(rectSize, { width, height })\n  viewport.value?.addEventListener(\"touchstart\", stopEventPropagation, { passive: false })\n})\nonSvgPanZoomUnmounted(() => {\n  resizeObserver?.disconnect()\n  viewport.value?.removeEventListener(\"touchstart\", stopEventPropagation)\n})\n\nconst applyAbsoluteZoomLevel = (absoluteZoomLevel: number) => {\n  svgPanZoom.value?.applyAbsoluteZoomLevel(\n    absoluteZoomLevel,\n    configs.view.minZoomLevel,\n    configs.view.maxZoomLevel\n  )\n}\n\nwatch(\n  () => configs.view.panEnabled,\n  v => {\n    svgPanZoom.value?.setPanEnabled(v)\n  }\n)\nwatch(\n  () => [\n    configs.view.zoomEnabled,\n    isDoubleClickZoomEnabled(configs.view),\n    isMouseWheelZoomEnabled(configs.view),\n  ],\n  () => {\n    const svgPanZoomInstance = svgPanZoom.value\n    if (!svgPanZoomInstance) return\n    applyZoomEnabled(\n      svgPanZoomInstance,\n      configs.view.zoomEnabled,\n      configs.view.doubleClickZoomEnabled,\n      configs.view.mouseWheelZoomEnabled\n    )\n  }\n)\n\nwatch(zoomLevel, v => applyAbsoluteZoomLevel(v))\nwatch(\n  () => [configs.view.minZoomLevel, configs.view.maxZoomLevel],\n  _ => {\n    applyAbsoluteZoomLevel(zoomLevel.value)\n  }\n)\n\n// Provide zoom level / scaling parameter\nconst { scale } = provideZoomLevel(zoomLevel, configs.view)\n\nonSvgPanZoomMounted(() => {\n  // apply initial zoom level\n  const initialZoomLevel = props.zoomLevel\n  applyAbsoluteZoomLevel(initialZoomLevel)\n})\n\n// To resolve the problem that the center position and\n// magnification rate may not be recognized.\nconst updateBorderBox = async () => {\n  if (Object.keys(props.nodes).length > 0) {\n    svgPanZoom.value?.updateBBox()\n    await asyncNextTick()\n  }\n}\n\n// Scales the content to fit in the SVG area.\nconst fitToContents = async (options?: { margin?: FitContentMargin }) => {\n  const fitContentMargin =\n    !options || options.margin === undefined ? configs.view.fitContentMargin : options.margin\n\n  await updateBorderBox()\n\n  const rect = nonNull(svg.value).getBoundingClientRect()\n  const margins = parseFitContentMargin(fitContentMargin, rect)\n\n  const result = calculateFit(\n    nonNull(viewport.value),\n    rect,\n    currentLayouts.nodes,\n    zoomLevel.value,\n    margins,\n    configs.view.scalingObjects\n  )\n\n  if (result) {\n    applyAbsoluteZoomLevel(result.zoom)\n    svgPanZoom.value?.pan(result.pos)\n  } else {\n    svgPanZoom.value?.center()\n  }\n  emitter.emit(\"view:fit\", undefined)\n}\n\n// Place content in the center of the SVG area.\nconst panToCenter = async () => {\n  await updateBorderBox()\n  svgPanZoom.value?.center()\n}\n\n// Get viewport box\nconst getViewBox = () =>\n  svgPanZoom.value?.getViewBox() ?? {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n  }\n\n// Get viewport box\nconst setViewBox = (box: Box) => svgPanZoom.value?.setViewBox(box)\n\n// -----------------------------------------------------------------------\n// States of selected nodes/edges\n// -----------------------------------------------------------------------\nconst currentSelectedNodes = bindPropKeySet(props, \"selectedNodes\", nodesRef, emit)\nwatch(currentSelectedNodes, nodes => emitter.emit(\"node:select\", Array.from(nodes)))\n\nconst currentSelectedEdges = bindPropKeySet(props, \"selectedEdges\", edgesRef, emit)\nwatch(currentSelectedEdges, edges => emitter.emit(\"edge:select\", Array.from(edges)))\n\nconst currentSelectedPaths = bindPropKeySet(props, \"selectedPaths\", pathsRef, emit)\nwatch(currentSelectedPaths, paths => emitter.emit(\"path:select\", Array.from(paths)))\n\nprovideSelections(currentSelectedNodes, currentSelectedEdges, currentSelectedPaths)\n\nconst hoveredNodes = Reactive(new Set<string>())\nconst hoveredEdges = Reactive(new Set<string>())\nconst hoveredPaths = Reactive(new Set<string>())\nconst currentLayouts = Reactive<Layouts>({ nodes: {} })\n\nprovideLayouts(currentLayouts)\n\n// two-way binding\nwatch(\n  () => props.layouts,\n  () => Object.assign(currentLayouts.nodes, props.layouts.nodes ?? {}),\n  { deep: true, immediate: true }\n)\nwatch(currentLayouts, () => emit(\"update:layouts\", currentLayouts), { deep: true })\n\n// -----------------------------------------------------------------------\n// SVG Markers\n// -----------------------------------------------------------------------\nconst markerState = makeMarkerState()\n\n// -----------------------------------------------------------------------\n// Mouse processing\n// -----------------------------------------------------------------------\n\n// mouse pointer change on dragging\nconst dragging = ref<boolean>(false)\nemitter.on(\"node:dragstart\", _ => (dragging.value = true))\nemitter.on(\"node:dragend\", _ => (dragging.value = false))\nemitter.on(\"view:mode\", mode => {\n  // avoid pan/zoom when using nodes and edges with multi-touch\n  if (configs.view.panEnabled) {\n    if (mode === \"default\") {\n      svgPanZoom.value?.enablePan()\n    } else {\n      svgPanZoom.value?.disablePan()\n    }\n  }\n  if (configs.view.zoomEnabled) {\n    if (mode === \"default\") {\n      svgPanZoom.value?.enableZoom()\n    } else {\n      svgPanZoom.value?.disableZoom()\n    }\n  }\n})\n\nconst touches = computed(() => {\n  return configs.view.panEnabled || configs.view.zoomEnabled || configs.node.draggable\n})\n\nconst { nodeStates, edgeStates, pathStates } = provideStates(\n  makeStateInput(nodesRef, currentSelectedNodes, hoveredNodes),\n  makeStateInput(edgesRef, currentSelectedEdges, hoveredEdges),\n  makeStateInput(pathsRef, currentSelectedPaths, hoveredPaths),\n  readonly(configs),\n  currentLayouts,\n  props.layouts,\n  markerState,\n  scale\n)\n\nconst isSvgWheelZoomEnabled = computed(() => isMouseWheelZoomEnabled(configs.view))\n\n// mouse and touch support\nconst { isBoxSelectionMode, selectionBox, startBoxSelection, stopBoxSelection } =\n  provideMouseOperation(\n    svg,\n    readonly(currentLayouts),\n    readonly(zoomLevel),\n    nodeStates,\n    edgeStates,\n    pathStates,\n    currentSelectedNodes,\n    currentSelectedEdges,\n    currentSelectedPaths,\n    hoveredNodes,\n    hoveredEdges,\n    hoveredPaths,\n    isInCompatibilityModeForPath,\n    isSvgWheelZoomEnabled,\n    configs,\n    emitter\n  )\n\n// -----------------------------------------------------------------------\n// Node layout handler\n// -----------------------------------------------------------------------\n\nconst activateParams = () => ({\n  layouts: Reactive(currentLayouts.nodes), // deprecated parameter.\n  nodePositions: toRef(currentLayouts, \"nodes\"),\n  nodes: nodesRef,\n  edges: edgesRef,\n  configs: readonly(configs),\n  scale: readonly(scale),\n  emitter,\n  svgPanZoom: nonNull(svgPanZoom.value),\n})\nwatch(\n  () => configs.view.layoutHandler,\n  (newHandler, oldHandler) => {\n    oldHandler.deactivate()\n    newHandler.activate(activateParams())\n  }\n)\n\n// -----------------------------------------------------------------------\n// Transition of element positions\n// -----------------------------------------------------------------------\n\n// #transitionWhile() method\nconst { transitionWhile, transitionOption } = useTransitionWhile()\nconst transitionStyles = computed(() => {\n  const o = transitionOption.value\n  return (\n    o.enabled\n      ? {\n          \"--transition-duration\": o.duration + \"ms\",\n          \"--transition-function\": o.timingFunction,\n        }\n      : {}\n  ) as CSSProperties\n})\n\n// -----------------------------------------------------------------------\n// Events\n// -----------------------------------------------------------------------\n\nonSvgPanZoomMounted(async () => {\n  // Wait promise for network loading\n  if (configs.view.onBeforeInitialDisplay) {\n    const promise = configs.view.onBeforeInitialDisplay()\n    if (isPromise(promise)) {\n      await promise\n    }\n  }\n\n  // pan to center\n  const svg = nonNull(svgPanZoom.value, \"svg-pan-zoom\")\n\n  // activate layout handler.\n  // (calc the positions of nodes whose positions are not specified)\n  configs.view.layoutHandler.activate(activateParams())\n\n  // Wait for applying network/layout changes such as nodes, layouts, etc.\n  // by onBeforeInitialDisplay/LayoutHandler\n  await asyncNextTick()\n\n  const autoPanAndZoom = configs.view.autoPanAndZoomOnLoad\n  if (configs.view.fit || autoPanAndZoom !== false) {\n    const nodesEmpty = Object.keys(props.nodes).length == 0\n    const pan1 = svg.getPan()\n    if (nodesEmpty || autoPanAndZoom === \"center-zero\") {\n      await updateBorderBox()\n      // Pan (0, 0) to the center.\n      const sizes = svg.getSizes()\n      svg.pan({\n        x: sizes.width / 2,\n        y: sizes.height / 2,\n      })\n    } else if (autoPanAndZoom === \"fit-content\" || configs.view.fit) {\n      await fitToContents()\n    } else if (autoPanAndZoom === \"center-content\") {\n      await panToCenter()\n    } else {\n      await updateBorderBox()\n    }\n\n    // If the pan position does not change, the onPan event of svg-pan-zoom\n    // is not fired, but v-network-graph always fires the `view:pan` event\n    // when initialized.\n    nextTick(() => {\n      const pan2 = svg.getPan()\n      if (pan1.x === pan2.x && pan1.y === pan2.y) {\n        emitter.emit(\"view:pan\", pan2)\n      }\n    })\n  } else {\n    await updateBorderBox()\n  }\n\n  emitter.emit(\"view:load\")\n\n  // start displaying the svg\n  state.value = State.LOADED\n})\n\nonSvgPanZoomUnmounted(() => {\n  state.value = State.UNLOADED\n  emitter.emit(\"view:unload\")\n  configs.view.layoutHandler.deactivate()\n})\n\n/**\n * Zoom in\n */\nfunction zoomIn() {\n  svgPanZoom.value?.zoomIn()\n}\n\n/**\n * Zoom out\n */\nfunction zoomOut() {\n  svgPanZoom.value?.zoomOut()\n}\n\n/**\n * Pan to a rendered position\n * @return {Point} point to pan\n */\nfunction panTo(point: Point) {\n  svgPanZoom.value?.pan(point)\n}\n\n/**\n * Relatively pan the graph by a specified rendered position vector\n * @return {Point} relative point to pan\n */\nfunction panBy(point: Point) {\n  svgPanZoom.value?.panBy(point)\n}\n\n/**\n * Get pan vector\n * @return {Point} pan vector\n */\nfunction getPan(): Point {\n  return nonNull(svgPanZoom.value).getPan()\n}\n\n/**\n * Get all calculate svg dimensions\n */\nfunction getSizes(): Sizes {\n  const sizes = nonNull(svgPanZoom.value).getSizes()\n  return {\n    width: sizes.width,\n    height: sizes.height,\n    viewBox: sizes.viewBox,\n  }\n}\n\n/**\n * Translate from DOM to SVG coordinates\n * @return {Point} coordinates in the SVG\n */\nfunction translateFromDomToSvgCoordinates(coordinates: Point): Point {\n  return svgUtils.translateFromDomToSvgCoordinates(\n    nonNull(svg.value, \"svg\"),\n    nonNull(viewport.value, \"viewport\"),\n    coordinates\n  )\n}\n\n/**\n * Translate from SVG to DOM coordinates\n * @return {Point} coordinates in the DOM\n */\nfunction translateFromSvgToDomCoordinates(coordinates: Point): Point {\n  return svgUtils.translateFromSvgToDomCoordinates(\n    nonNull(svg.value, \"svg\"),\n    nonNull(viewport.value, \"viewport\"),\n    coordinates\n  )\n}\n\n/**\n * Get graph as SVG text.\n * @return {string} SVG text\n * @deprecated\n */\nfunction getAsSvg(): string {\n  const target = exportSvgElement(\n    nonNull(svg.value, \"svg\"),\n    nonNull(viewport.value, \"viewport\"),\n    scale.value\n  )\n  return target.outerHTML\n}\n\n/**\n * Export graph as SVG text.\n * @return {string} SVG text\n */\nasync function exportAsSvgText(options: Partial<ExportOptions> = {}): Promise<string> {\n  const target = exportAsSvgElement(options)\n  return (await target).outerHTML\n}\n\n/**\n * Export graph as SVG element.\n * @return {SVGElement} SVG element\n */\nasync function exportAsSvgElement(options: Partial<ExportOptions> = {}): Promise<SVGElement> {\n  return exportSvgElementWithOptions(\n    nonNull(svg.value, \"svg\"),\n    nonNull(viewport.value, \"viewport\"),\n    scale.value,\n    options\n  )\n}\n\ndefineExpose({\n  // methods\n  fitToContents,\n  panToCenter,\n  getViewBox,\n  setViewBox,\n  transitionWhile,\n  startBoxSelection,\n  stopBoxSelection,\n  zoomIn,\n  zoomOut,\n  panTo,\n  panBy,\n  getPan,\n  getSizes,\n  translateFromDomToSvgCoordinates,\n  translateFromSvgToDomCoordinates,\n  getAsSvg,\n  exportAsSvgText,\n  exportAsSvgElement,\n})\n\n// local functions\n\nfunction applyZoomEnabled(\n  svgPanZoom: SvgPanZoomInstance,\n  enable: boolean,\n  enableDblClick: boolean,\n  enableMouseWheel: boolean\n): void {\n  svgPanZoom.setZoomEnabled(enable)\n  if (enable && enableDblClick) {\n    svgPanZoom.enableDblClickZoom()\n  } else {\n    svgPanZoom.disableDblClickZoom()\n  }\n  if (enable && enableMouseWheel) {\n    svgPanZoom.enableMouseWheelZoom()\n  } else {\n    svgPanZoom.disableMouseWheelZoom()\n  }\n}\n\nfunction isDoubleClickZoomEnabled(view: ViewConfig): boolean {\n  return view.zoomEnabled && view.doubleClickZoomEnabled\n}\n\nfunction isMouseWheelZoomEnabled(view: ViewConfig): boolean {\n  return view.zoomEnabled && view.mouseWheelZoomEnabled\n}\n\nfunction stopEventPropagation(event: Event) {\n  event.stopPropagation()\n}\n</script>\n\n<template>\n  <div ref=\"container\" class=\"v-network-graph v-ng-container\">\n    <svg\n      ref=\"svg\"\n      class=\"v-ng-canvas\"\n      :class=\"{ show, dragging, touches, 'box-selection-mode': isBoxSelectionMode }\"\n      width=\"100%\"\n      height=\"100%\"\n    >\n      <!-- outside of viewport -->\n      <template v-for=\"layerName in layerDefs['root']\" :key=\"layerName\">\n        <slot :name=\"layerName\" :scale=\"scale\" />\n      </template>\n\n      <defs v-if=\"Object.keys(markerState.markers).length > 0\">\n        <v-marker-head\n          v-for=\"(marker, id) in markerState.markers\"\n          :id=\"id\"\n          :key=\"id\"\n          :marker=\"marker\"\n          :scale=\"scale\"\n        />\n      </defs>\n\n      <!-- background-viewport:\n           area outside the scope of SVG text retrieval but targeted by pan/zoom. -->\n      <v-background-viewport v-if=\"isShowBackgroundViewport\">\n        <g v-for=\"layerName in layerDefs['background']\" :key=\"layerName\" class=\"v-ng-layer\">\n          <slot :name=\"layerName\" :scale=\"scale\" />\n        </g>\n\n        <!-- grid -->\n        <v-background-grid v-if=\"isShowGrid\" />\n\n        <g v-for=\"layerName in layerDefs['grid']\" :key=\"layerName\" class=\"v-ng-layer\">\n          <slot :name=\"layerName\" :scale=\"scale\" />\n        </g>\n      </v-background-viewport>\n\n      <!-- viewport: pan/zoom target and within the range of SVG text retrieval. -->\n      <g\n        ref=\"viewport\"\n        class=\"v-ng-viewport\"\n        :class=\"{ 'v-ng-transition': transitionOption.enabled }\"\n        :style=\"transitionStyles\"\n      >\n        <g v-for=\"layerName in layerDefs['base']\" :key=\"layerName\" class=\"v-ng-layer\">\n          <slot :name=\"layerName\" :scale=\"scale\" />\n        </g>\n\n        <!-- Sortable built-in layers -->\n        <template v-for=\"layerName in builtInLayerOrder\" :key=\"layerName\">\n          <!-- Edges -->\n          <template v-if=\"layerName === 'edges'\">\n            <v-edges-layer>\n              <template v-if=\"'edge-overlay' in slots\" #edge-overlay=\"slotProps\">\n                <slot name=\"edge-overlay\" v-bind=\"slotProps\" />\n              </template>\n            </v-edges-layer>\n          </template>\n\n          <!-- Edge labels -->\n          <template v-else-if=\"layerName === 'edge-labels'\">\n            <v-edge-labels-layer\n              :enable-edge-label=\"'edge-label' in slots\"\n              :enable-edges-label=\"'edges-label' in slots\"\n            >\n              <template #edge-label=\"slotProps\">\n                <slot name=\"edge-label\" v-bind=\"slotProps\" />\n              </template>\n              <template #edges-label=\"slotProps\">\n                <slot name=\"edges-label\" v-bind=\"slotProps\" />\n              </template>\n            </v-edge-labels-layer>\n          </template>\n\n          <!-- Node focusring -->\n          <template v-else-if=\"layerName === 'focusring'\">\n            <v-focusring-layer />\n          </template>\n\n          <!-- Nodes -->\n          <template v-else-if=\"layerName === 'nodes'\">\n            <v-nodes-layer>\n              <template #override-node=\"slotProps\">\n                <slot name=\"override-node\" v-bind=\"slotProps\" />\n              </template>\n            </v-nodes-layer>\n          </template>\n\n          <!-- Node labels -->\n          <template v-else-if=\"layerName === 'node-labels'\">\n            <v-node-labels-layer>\n              <template #override-node-label=\"slotProps\">\n                <slot name=\"override-node-label\" v-bind=\"slotProps\" />\n              </template>\n            </v-node-labels-layer>\n          </template>\n\n          <!-- Paths -->\n          <template v-else-if=\"layerName === 'paths'\">\n            <v-paths-layer />\n          </template>\n\n          <!-- User defined layer -->\n          <template v-for=\"customLayerName in layerDefs[layerName]\" :key=\"customLayerName\">\n            <g class=\"v-ng-layer\">\n              <slot :name=\"customLayerName\" :scale=\"scale\" />\n            </g>\n          </template>\n        </template>\n      </g>\n\n      <!-- selection box -->\n      <v-selection-box\n        v-if=\"selectionBox\"\n        :box=\"selectionBox\"\n        :config=\"configs.view.selection.box\"\n      />\n    </svg>\n  </div>\n</template>\n\n<style lang=\"scss\">\n:where(.v-ng-container) {\n  width: 100%;\n  height: 100%;\n}\n\n.v-ng-container {\n  padding: 0;\n  position: relative;\n  user-select: none;\n}\n\n.v-ng-canvas {\n  -webkit-tap-highlight-color: transparent;\n  width: 100%;\n  height: 100%;\n  // Respond to disorder until the svgPanZoom library is activated\n  opacity: 0;\n  &.show {\n    opacity: 1;\n    transition: opacity 0.5s linear;\n  }\n}\n\n.v-ng-canvas.dragging {\n  * {\n    cursor: grabbing !important;\n  }\n  .v-ng-line {\n    transition: d 0s;\n  }\n}\n\n.v-ng-canvas.touches {\n  // prevent to perform browser's default action\n  touch-action: none;\n}\n\n.v-ng-canvas.box-selection-mode {\n  cursor: crosshair !important;\n  * {\n    cursor: crosshair !important;\n  }\n}\n\n// Disable transitions before initialization is completed\n.v-ng-canvas:not(.show) {\n  .v-ng-node,\n  .v-ng-node-label,\n  .v-ng-node-focusring,\n  .v-ng-edge,\n  .v-ng-edge-label,\n  .v-ng-path {\n    transition: none;\n    > * {\n      transition: none;\n    }\n  }\n}\n\n// transition options for #transitionWhile()\n.v-ng-viewport.v-ng-transition {\n  --transition-duration: 300ms;\n  --transition-function: linear;\n  .v-ng-node,\n  .v-ng-node-label,\n  .v-ng-node-focusring,\n  .v-ng-edge,\n  .v-ng-edge-label,\n  .v-ng-path {\n    transition: all var(--transition-duration) var(--transition-function);\n    > * {\n      transition: all var(--transition-duration) var(--transition-function);\n    }\n  }\n}\n\n.v-ng-line.animate,\n.v-ng-path.animate {\n  --animation-speed: 100;\n  animation: v-ng-dash 10s linear infinite;\n  stroke-dashoffset: var(--animation-speed);\n}\n@keyframes v-ng-dash {\n  to {\n    stroke-dashoffset: 0;\n  }\n}\n</style>\n","<template>\n  <defs>\n    <component :is=\"'style'\">\n      <slot />\n    </component>\n  </defs>\n</template>\n","<script setup lang=\"ts\">\nimport { computed, Ref, ref, watchEffect } from \"vue\"\nimport { EdgeLabelStyle } from \"@/common/configs\"\nimport { Edge, EdgeLabelArea } from \"@/common/types\"\nimport { VectorLine } from \"@/modules/calculation/line\"\nimport VText from \"@/components/base/VLabelText.vue\"\n\ninterface Props {\n  area: EdgeLabelArea\n  config: EdgeLabelStyle\n  text?: string\n  align?: \"center\" | \"source\" | \"target\"\n  verticalAlign?: \"center\" | \"above\" | \"below\"\n  // The followings are the definitions to avoid passing unwanted\n  // items to <text> when they are specified in v-bind.\n  edge?: Edge\n  hovered?: boolean\n  selected?: boolean\n  scale?: number\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  text: \"\",\n  align: \"center\",\n  verticalAlign: \"center\",\n  edge: undefined,\n  hovered: undefined,\n  selected: undefined,\n  scale: undefined,\n})\n\nconst x = ref(0)\nconst y = ref(0)\nconst textAnchor: Ref<\"middle\" | \"start\" | \"end\"> = ref(\"middle\")\nconst dominantBaseline: Ref<\"text-top\" | \"hanging\" | \"central\"> = ref(\"central\")\nconst angle = ref(0)\n\nwatchEffect(() => {\n  const s = props.area.source\n  const t = props.area.target\n  if (props.align === \"source\") {\n    if (s.above.x == t.above.x) {\n      textAnchor.value = s.above.y > t.above.y ? \"start\" : \"end\"\n    } else {\n      textAnchor.value = s.above.x < t.above.x ? \"start\" : \"end\"\n    }\n    if (props.verticalAlign === \"above\") {\n      x.value = s.above.x\n      y.value = s.above.y\n      dominantBaseline.value = \"text-top\"\n    } else if (props.verticalAlign === \"below\") {\n      x.value = s.below.x\n      y.value = s.below.y\n      dominantBaseline.value = \"hanging\"\n    } else {\n      // center\n      x.value = (s.above.x + s.below.x) / 2\n      y.value = (s.above.y + s.below.y) / 2\n      dominantBaseline.value = \"central\"\n    }\n  } else if (props.align === \"target\") {\n    if (s.above.x == t.above.x) {\n      textAnchor.value = s.above.y < t.above.y ? \"start\" : \"end\"\n    } else {\n      textAnchor.value = s.above.x > t.above.x ? \"start\" : \"end\"\n    }\n    if (props.verticalAlign === \"above\") {\n      x.value = t.above.x\n      y.value = t.above.y\n      dominantBaseline.value = \"text-top\"\n    } else if (props.verticalAlign === \"below\") {\n      x.value = t.below.x\n      y.value = t.below.y\n      dominantBaseline.value = \"hanging\"\n    } else {\n      // center\n      x.value = (t.above.x + t.below.x) / 2\n      y.value = (t.above.y + t.below.y) / 2\n      dominantBaseline.value = \"central\"\n    }\n  } else {\n    // center\n    textAnchor.value = \"middle\"\n    if (props.verticalAlign === \"above\") {\n      x.value = (s.above.x + t.above.x) / 2\n      y.value = (s.above.y + t.above.y) / 2\n      dominantBaseline.value = \"text-top\"\n    } else if (props.verticalAlign === \"below\") {\n      x.value = (s.below.x + t.below.x) / 2\n      y.value = (s.below.y + t.below.y) / 2\n      dominantBaseline.value = \"hanging\"\n    } else {\n      // center\n      x.value = (s.above.x + t.below.x) / 2\n      y.value = (s.above.y + t.below.y) / 2\n      dominantBaseline.value = \"central\"\n    }\n  }\n  let degree = VectorLine.fromPositions(s.above, t.above).v.angleDegree()\n  if (degree < -90 || degree >= 90) {\n    degree = degree + 180\n    if (degree > 180) {\n      degree -= 360\n    }\n  }\n  angle.value = degree\n})\n\n// If there is no background config and text overlaps the line,\n// automatically set the background.\nconst updatedConfig = computed(() => {\n  if (dominantBaseline.value === \"central\" && !props.config.background) {\n    return {\n      ...props.config,\n      background: {\n        visible: true,\n        color: \"#ffffff\",\n        padding: {\n          vertical: 1,\n          horizontal: 4,\n        },\n        borderRadius: 2,\n      },\n    }\n  } else {\n    return props.config\n  }\n})\n</script>\n\n<template>\n  <v-text\n    class=\"v-ng-edge-label\"\n    :text=\"text\"\n    :x=\"x\"\n    :y=\"y\"\n    :config=\"updatedConfig\"\n    :text-anchor=\"textAnchor\"\n    :dominant-baseline=\"dominantBaseline\"\n    :transform=\"`rotate(${angle} ${x} ${y})`\"\n  />\n  <!-- <g>\n    <circle\n      :cx=\"area.source.above.x\"\n      :cy=\"area.source.above.y\"\n      r=\"3\"\n      fill=\"red\"\n    />\n    <circle\n      :cx=\"area.target.above.x\"\n      :cy=\"area.target.above.y\"\n      r=\"3\"\n      fill=\"green\"\n    />\n    <circle\n      :cx=\"area.source.below.x\"\n      :cy=\"area.source.below.y\"\n      r=\"3\"\n      fill=\"blue\"\n    />\n    <circle\n      :cx=\"area.target.below.x\"\n      :cy=\"area.target.below.y\"\n      r=\"3\"\n      fill=\"orange\"\n    />\n  </g> -->\n</template>\n","import { Ref } from \"vue\"\nimport { Position } from \"@/common/types\"\nimport { SimpleLayout } from \"./simple\"\n\nconst DEFAULT_GRID = 10\n\nexport type GridLayoutParameters = {\n  grid?: number\n}\n\nexport class GridLayout extends SimpleLayout {\n  constructor(private options: GridLayoutParameters = {}) {\n    super()\n  }\n\n  protected setNodePosition(nodeLayout: Ref<Position>, pos: Position) {\n    const grid = this.options.grid || DEFAULT_GRID\n    nodeLayout.value.x = Math.floor(pos.x / grid) * grid\n    nodeLayout.value.y = Math.floor(pos.y / grid) * grid\n  }\n}\n","import { App, Plugin } from \"vue\"\n\n// Import vue components\nimport * as components from \"./components/index\"\n\n// install function executed by Vue.use()\nconst install: Exclude<Plugin[\"install\"], undefined> = function (app: App) {\n  Object.entries(components).forEach(([componentName, component]) => {\n    app.component(componentName, component)\n  })\n}\n\n// Create module definition for Vue.use()\nexport default install\n\nexport type VNetworkGraphInstance = InstanceType<typeof components.VNetworkGraph>\nexport type Instance = InstanceType<typeof components.VNetworkGraph>\n\n// To allow individual component use, export components\n// each can be registered via Vue.component()\nexport * from \"./components/index\"\n\nexport { getFullConfigs } from \"./common/config-defaults\"\n\nexport { SimpleLayout } from \"./layouts/simple\"\nexport { GridLayout } from \"./layouts/grid\"\n// export { ForceLayout } from \"./layouts/force\"\nexport type { LayoutHandler } from \"./layouts/handler\"\n\nexport * from \"./common/types\"\nexport * from \"./common/configs\"\nexport { Vector2D } from \"./modules/vector2d\"\n\n// Export for more advanced visualization. However, be aware of the\n// possibility of destructive specification changes in the future.\nexport { useStates } from \"./composables/state\"\n\nexport type { Box } from \"./modules/svg-pan-zoom-ex\"\n"],"names":["LayerPositions","Reactive","value","isReactive","reactive","nonNull","val","name","containersKey","provideContainers","containers","provide","useContainers","inject","freeGlobal","freeSelf","root","Symbol","objectProto","hasOwnProperty","nativeObjectToString","symToStringTag","getRawTag","isOwn","tag","unmasked","e","result","objectToString","nullTag","undefinedTag","baseGetTag","isObjectLike","symbolTag","isSymbol","arrayMap","array","iteratee","index","length","isArray","symbolProto","symbolToString","baseToString","reWhitespace","trimmedEndIndex","string","reTrimStart","baseTrim","isObject","type","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber","other","isBinary","INFINITY","MAX_INTEGER","toFinite","sign","toInteger","remainder","identity","asyncTag","funcTag","genTag","proxyTag","isFunction","coreJsData","maskSrcKey","uid","isMasked","func","funcProto","funcToString","toSource","reRegExpChar","reIsHostCtor","reIsNative","baseIsNative","pattern","getValue","object","key","getNative","WeakMap","objectCreate","baseCreate","proto","apply","thisArg","args","noop","copyArray","source","HOT_COUNT","HOT_SPAN","nativeNow","shortOut","count","lastCalled","stamp","remaining","constant","defineProperty","baseSetToString","setToString","baseFindIndex","predicate","fromIndex","fromRight","baseIsNaN","strictIndexOf","baseIndexOf","arrayIncludes","MAX_SAFE_INTEGER","reIsUint","isIndex","baseAssignValue","eq","assignValue","objValue","copyObject","props","customizer","isNew","newValue","nativeMax","overRest","start","transform","otherArgs","baseRest","isLength","isArrayLike","isIterateeCall","createAssigner","assigner","sources","guard","isPrototype","Ctor","baseTimes","n","argsTag","baseIsArguments","propertyIsEnumerable","isArguments","stubFalse","freeExports","exports","freeModule","moduleExports","Buffer","nativeIsBuffer","isBuffer","arrayTag","boolTag","dateTag","errorTag","mapTag","numberTag","objectTag","regexpTag","setTag","stringTag","weakMapTag","arrayBufferTag","dataViewTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","typedArrayTags","baseIsTypedArray","baseUnary","freeProcess","nodeUtil","types","nodeIsTypedArray","isTypedArray","arrayLikeKeys","inherited","isArr","isArg","isBuff","isType","skipIndexes","overArg","arg","nativeKeys","baseKeys","keys","nativeKeysIn","baseKeysIn","isProto","keysIn","nativeCreate","hashClear","hashDelete","HASH_UNDEFINED","hashGet","data","hashHas","hashSet","Hash","entries","entry","listCacheClear","assocIndexOf","arrayProto","splice","listCacheDelete","lastIndex","listCacheGet","listCacheHas","listCacheSet","ListCache","Map","mapCacheClear","isKeyable","getMapData","map","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","size","MapCache","toString","arrayPush","values","offset","getPrototype","objectCtorString","isPlainObject","baseSlice","end","nativeIsFinite","nativeMin","createRound","methodName","number","precision","pair","nativeCeil","chunk","resIndex","stackClear","stackDelete","stackGet","stackHas","LARGE_ARRAY_SIZE","stackSet","pairs","Stack","cloneBuffer","buffer","isDeep","arrayFilter","stubArray","nativeGetSymbols","getSymbols","symbol","baseGetAllKeys","keysFunc","symbolsFunc","getAllKeys","DataView","Promise","Set","promiseTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","getTag","ctorString","Uint8Array","cloneArrayBuffer","arrayBuffer","cloneTypedArray","typedArray","initCloneObject","setCacheAdd","setCacheHas","SetCache","arraySome","cacheHas","cache","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","equalArrays","bitmask","equalFunc","stack","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","mapToArray","setToArray","set","symbolValueOf","equalByTag","convert","stacked","equalObjects","objProps","objLength","othProps","objStacked","skipCtor","objCtor","othCtor","baseIsEqualDeep","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","baseIsEqual","createBaseFor","iterable","baseFor","now","FUNC_ERROR_TEXT","debounce","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","flush","debounced","isInvoking","assignMergeValue","isArrayLikeObject","safeGet","toPlainObject","baseMergeDeep","srcIndex","mergeFunc","srcValue","isCommon","isTyped","baseMerge","mergeWith","isEqual","merge","round","createSet","baseUniq","comparator","includes","outer","computed","seenIndex","uniq","Config","target","v","k","NodeLabelDirection","withSelf","callback","self","configsWithType","configs","defineConfigs","getNodeSize","node","style","scale","shape","areNodesCollision","nodePos","nodeSize","targetNodePos","targetNodeSize","collisionX","collisionY","applyScaleToDasharray","dasharray","getDasharrayUnit","s","NEW_NODE_POSITION_MARGIN","SimpleLayout","parameters","nodePositions","nodes","emitter","svgPanZoom","onDrag","positions","id","pos","layout","setNewNodePositions","nodeIds","newNodes","area","nodeId","candidate","__spreadValues","collision","targetNode","stopNodeWatch","watch","equality","nodeLayout","toRef","getConfigDefaults","event","detect","_a","edge","w","_edges","p","list","hash","a","b","path","getFullConfigs","config","injectionKey","merger","destination","provideConfigs","results","styleKeys","injectConfig","useViewConfig","useNodeConfig","useEdgeConfig","usePathConfig","nextId","useId","entriesOf","obj","updateObjectDiff","from","isPromise","makeEdgeGroupStates","edges","state","watchEffect","edgeLayoutPoints","edgeGroups","calculateEdgeGroupAndPositions","summarizedEdges","groupWidth","summarize","defaultCheckSummarize","calculateEdgeShiftedPosition","isSummarized","keepOrder","calculateEdgePositionInner","calcGap","_e","_c","edgeLen","gap","edgeId","pointInGroup","lineHalfWidths","width","points","i","minWidth","x1","y1","x2","y2","calculateLinePosition","_b","_d","_f","_g","_h","dx","dy","diff","radian","perpendicular","moveSlope","diffX","add","v1","v2","subtract","multiply","multiplyScalar","scalar","divide","dot","cross","lengthSquared","distanceSquared","distance","normalize","len","rotate","angle","newX","newY","DEGREES","rad2deg","rad","angleDegree","Vector2D","x","y","V","VectorLine","line","toLineVector","sourcePos","targetPos","toVectorsFromLinePosition","getCenterOfLinePosition","toLinePosition","p1","p2","applyMargin","linePos","sourceMargin","targetMargin","applyMarginInner","normalized","sv","tv","check","c1","c2","inverseLine","calculatePerpendicularLine","n1","getNearestPoint","lp","getIntersectionOfLineTargetAndCircle","center","radius","h","hpLen","t","__pow","getIntersectionOfLineTargetAndCircle2","nearBy","ip1","ip2","d1","d2","getIntersectionPointOfLines","line1","line2","t2","getIntersectionOfCircles","center1","radius1","center2","radius2","near","vC1C2","sumR","subR","isLarge","cos","rc","rs","n2","tn1","sn2","result1","result2","calculateDistanceToAvoidOverlapsWithRect","rect","centerLine","halfWidth","halfHeight","borderRadius","angleVRad","angleHRad","isCrossedVLine","isCrossedHLine","left","top","right","bottom","vertexes","centerOfNearestCircle","point","PointUtils.getIntersectionOfLineTargetAndCircle","PointUtils.getNearestPoint","LineUtils.toLineVector","calculateEdgeLabelArea","edgeStyle","margin","padding","labelMargin","vMargin","sourceAbove","sourceBelow","targetAbove","targetBelow","calculateDistancesFromCenterOfNodeToEndOfNode","sourceNodePos","sourceNodeShape","targetNodeShape","distance1","distance2","moveOnCircumference","reverseAngleRadian","theta","calculateBezierCurveControlPoint","theta0","control","centerToSource","centerToTarget","calculateRelativeAngleRadian","middle","centerToMp","mpTangent","LineUtils.calculatePerpendicularLine","theta1","tangent","cp","PointUtils.getIntersectionPointOfLines","mp","tangent2","cp1","cp2","theta2","calculateCircleCenterAndRadiusBy3Points","p3","x3","y3","x12","y12","x32","y32","getNodeRadius","getNodesBox","layouts","findFirstNonNull","EPSILON","calculatePathPoints","nodeStates","nodeLayouts","edgeStates","curveInNode","pathEndType","directions","edgePos","_getEdgeLine","isMarginOverRunStart","isMarginOverRunEnd","firstEdge","nodeRadius","NodeUtils.getNodeRadius","lineMargin","nextPoint","_calculateEdgeOfNode","prev","next","crossPoint","_getIntersectionOfLines","nodeCoreRadius","isForwardPrev","_isForward","isForwardNext","prevCoreIp","_getIntersectionOfLineAndNode","nextCoreIp","prevNodeIp","nextNodeIp","d","lastPoints","lastPoint","v2d.calculateBezierCurveControlPoint","arc","_makeArcString","lastEdge","_","calculateDirectionsOfPathEdges","lastNode","isForward","joint","_getJointNode","edgeObject0","edgeObject1","currentEdge","nextEdge","direction","curve","moveRad","v2d.moveOnCircumference","PointUtils.getIntersectionOfCircles","PointUtils.getIntersectionOfLineTargetAndCircle2","prevSlope","_getSlope","nextSlope","nodeCenter","targetSide","position","loop","LineUtils.inverseLine","__spreadProps","rx","ry","ends","end1","end2","isClockwise","a1","largeArc","useObjectState","objects","selected","hovered","createState","terminateState","entriesForZOrder","states","idSet","createNewState","append","removed","zOrderedList","makeZOrderedList","stateObject","unref","zOrder","hover1","hover2","selected1","selected2","convertToAscii","makeMarkerState","useMarker","markerState","markers","referenceCount","addMarker","marker","m","removeMarker","clearMarker","makeMarker","isSource","previousId","strokeColor","instanceId","headMarker","toHeadMarker","buildKey","c","u","makeStateInput","statesKey","NONE_MARKER","provideStates","paths","readonlyLayouts","makerState","summarizedEdgeStates","opposingNodes","_nodes","nodeZOrderedList","newState","createNewNodeState","_state","edgeGroupStates","EdgeGroup.makeEdgeGroupStates","edgeEntries","ref","edgeZOrderedList","createNewEdgeState","_edgeId","createEdgeEntries","createSummarizedEdgeStates","pathStates","pathZOrderedList","toEdgeObjects","isSummarizedEdges","item","useStates","getNodeShape","getNodeStaticShape","oppositeNodeIds","getEdgeStroke","toEdgeMarker","stroke","normalWidth","edgeLayoutPoint","isEdgeSummarized","stopCalcHandle","sourceShape","targetShape","shiftedPosition","EdgeGroup.calculateEdgeShiftedPosition","sourceShapeMargin","targetShapeMargin","v2d.calculateDistancesFromCenterOfNodeToEndOfNode","LineUtils.applyMargin","l","isStartEdgeOfNode","LineUtils.toLinePosition","selfLoopStyle","calculateArcPositionAndState","shift","calculateCurvePositionAndState","stopUpdateMarkerHandle","group","z","originPosition","origin","shifted","shiftedCenter","LineUtils.getCenterOfLinePosition","v2d.calculateCircleCenterAndRadiusBy3Points","centerToTop","v2d.calculateRelativeAngleRadian","sourceMoveRad","targetMoveRad","v2d.reverseAngleRadian","LineUtils.toVectorsFromLinePosition","nodeShape","intersects","radiusLine","V2D.rotate","isLargeArc","groups","MapUtil","MOUSE_MOVE_DETECTION_THRESHOLD","TOUCH_MOVE_DETECTION_THRESHOLD","DOUBLE_CLICK_THRESHOLD","getPointerMoveDetectionThreshold","detectClicks","clickStates","pointerId","clickState","idAndState","oldPointerId","clickEvent","doubleClickEvent","createClickEvents","initDict","cleanClickState","makeNodeInteractionHandlers","modes","hoveredNodes","selectedNodes","zoomLevel","nodePointerHandlers","handleNodePointerMoveEvent","handleNodePointerUpEvent","handleNodePointerCancelEvent","_updateFollowNodes","pointerState","isFollowed","isSelectedNode","followed","userGrabs","_unwrapNodePosition","mode","_calculateNodeNewPosition","handleNodeClickEvent","selectable","isTouchAnySelectedNode","handleNodeDoubleClickEvent","threshold","draggingNodes","ev","handler","isMoved","handleNodePointerDownEvent","handleNodePointerOverEvent","handleNodePointerOutEvent","handleNodeContextMenu","makeEdgeInteractionHandlers","hoveredEdges","selectedEdges","edgePointerHandlers","handleEdgePointerUpEvent","handleEdgePointerCancelEvent","handleEdgePointerDownEvent","_makeEdgeEventObject","handleEdgeClickEvent","isTouchAnySelectedEdge","handleEdgeDoubleClickEvent","handleEdgePointerOverEvent","handleEdgePointerOutEvent","handleEdgeContextMenu","handleEdgesPointerDownEvent","handleEdgesPointerOverEvent","handleEdgesPointerOutEvent","handleEdgesClickEvent","handleEdgesDoubleClickEvent","handleEdgesContextMenu","setupContainerInteractionHandlers","container","isSvgWheelZoomEnabled","containerPointerHandlers","handleContainerPointerMoveEvent","handleContainerPointerUpEvent","handleContainerPointerDownEvent","handleContainerClickEvent","handleContainerDoubleClickEvent","handleContainerContextMenuEvent","preventDefault","onMounted","onUnmounted","enabled","old","makePathInteractionHandlers","hoveredPaths","selectedPaths","isInCompatibilityModeForPath","_makePathEventObject","pathPointerHandlers","handlePathPointerUpEvent","handlePathPointerCancelEvent","handlePathPointerDownEvent","handlePathPointerOverEvent","handlePathPointerOutEvent","handlePathClickEvent","isTouchAnySelectedPath","handlePathDoubleClickEvent","handlePathContextMenu","urlContentToDataUrl","url","__async","blob","onSuccess","onError","reader","translateFromDomToSvgCoordinates","svg","viewport","coordinates","svgPoint","translateFromSvgToDomCoordinates","domPoint","exportSvgElement","element","svgViewport","box","svgRect","iter","commentNode","replaceImageSourceToDataUrl","image","useNS","href","dataUrl","exportSvgElementWithOptions","_0","_1","_2","promises","img","makeBoxSelectionMethods","isBoxSelectionEnabled","isBoxSelectionMode","selectionBox","updateNodesSelection","_updateNodesSelection","pointerEventHandler","PointerEventRegistrar","handlePointerDownEvent","handlePointerUpEvent","handlePointerMoveEvent","handleClickEvent","handleKeyDownEvent","stopBoxSelection","updateRectangle","pos1","pos2","pointerArray","first","last","keyEventRegistrar","KeyEventRegistrar","startBoxSelection","selectedNodesAtSelectStarted","selectionType","enclosedNodes","temporary","handleKeyUpEvent","mouseEventHandlersKey","provideMouseOperation","provides","useMouseOperation","mitt","eventEmitterKey","provideEventEmitter","useEventEmitter","utilities","global","prop","o","elementOrSelector","fn","context","evt","touch","prevEvt","timeStampDiff","touchesDistance","that","timeout","previous","later","refreshRate","requestTimeout","point1","point2","Utils","require$$0","uniwheel","prefix","_addEventListener","_removeEventListener","support","fns","passiveTrueOption","passiveFalseOption","getSupport","createCallback","originalEvent","getCallback","removeCallback","_addWheelListener","elem","eventName","isPassiveListener","cb","_removeWheelListener","addWheelListener","removeWheelListener","_browser","svgUtilities","selector","childNodes","el","viewportId","svgChildren","classNames","allDefs","allDefsCount","thisDefs","this","matrix","defs","height","SvgUtils","controlIcons","instance","styleEl","zoomGroup","zoomIn","zoomInBackground","zoomInShape","resetPanZoomControl","resetPanZoomControlBackground","resetPanZoomControlShape1","resetPanZoomControlShape2","zoomOut","zoomOutBackground","zoomOutShape","require$$1","ShadowViewport","newCTM","svgViewBox","viewBoxValues","zoom","bBox","newScale","offsetX","offsetY","safeCTM","willZoom","willPan","preventPan","preventPanX","preventPanY","ctm","shadowViewport","Wheel","ControlIcons","require$$2","require$$3","require$$4","SvgPanZoom","optionsDefaults","passiveListenerTrueOption","passiveListenerFalseOption","boundingClientRectNormalized","oldScale","oldPoint","newPoint","publicInstance","haltEventListeners","delta","timeDelta","divider","inversedScreenCTM","relativeMousePoint","zoomScale","zoomAbsolute","originalState","oldCTM","relativePoint","modifier","absolute","targetClass","zoomFactor","viewportCTM","touch1","touch2","relativeTouchPoint","viewBox","instancesStore","svgPanZoom_1","methods","sizes","pan","sizeWidth","sizeHeight","ratio","currentRatio","newWidth","newHeight","absoluteZoom","realZoom","relativeZoom","originalZoom","minZoomLevel","maxZoomLevel","min","max","constructor","createSvgPanZoomEx","userInit","userDestroy","useSvgPanZoom","mountedCallbacks","unmountedCallbacks","instanceMounted","instanceUnmounted","initialize","zoomLevelKey","provideZoomLevel","viewStyle","useZoomLevel","useTransitionWhile","transitionOption","transitionWhile","duration","timingFunction","nextTick","promise","useTranslatePathsToObject","input","idStore","containKeys","bindProp","emit","filter","update","filtered","bindPropKeySet","sourceObject","bound","provideSelections","useSelections","provideLayouts","useLayouts","pairwise","arr","removeItem","insertAfter","base","useBuiltInLayerOrder","slots","builtInLayers","request","layer","defined","order","lower","higher","asyncNextTick","resolve","areBoxesSame","box1","box2","error","boxAdd","boxMultiply","boxDivide","viewBoxToBox","boxToViewBox","mergeBox","NUMERIC_PATTERN","parseFitContentMargin","fitContentMargin","margins","parseFitContentMarginValue","calculateFit","nodesLayouts","scalingObjects","viewportBox","calculateFitWithScalingObjects","graphBox","getGraphBox","calculateFitWithoutScalingObjects","marginValue","baseSize","g","accum","r","calculateZoomLevelForFixedBox","calculatePanForCentering","nodesBox","fixedSizes","tmpTarget","calculateSizeWithoutMargin","hasOnlyGraphLayer","lastZoom","zoomed","zoomedBox","availableZooms","zooms","marginX","marginY","__props","arrowPoints","angleStroke","anglePoints","VMarkerHeadArrow","VMarkerHeadAngle","VMarkerHeadCircle","refX","refYOffset","basePoint","thickVerticals","thickHorizontals","normalVerticals","normalHorizontals","thickH","thickV","normalH","normalV","gi","maxWidth","maxHeight","inc","normalDasharray","thickDasharray","thickAttrs","normalAttrs","background","updateAttributes","attrs","bgLayer","vpLayer","attr","observer","records","pathD","f1","f2","strokeWidth","strokeDasharray","animationSpeed","speed","useAttrs","texts","fontSize","lineHeight","topDeltaY","dominantBaseline","backgroundRectPos","paddingVertical","paddingHorizontal","updateObserver","enableMutationObserver","updateBackgroundPosition","bbox","centerPos","edgeIds","labelConfig","shapeConfig","strokeConfig","edgeConfig","getStrokeConfig","toEdgePosition","calculateCenterPoint","getPathTotalLength","calculatePointAtLength","useSlots","hasEdgeOverlaySlot","v2d.calculateEdgeLabelArea","individual","summarized","getRepresentativeEdgeKey","shapeStyle","hasOverrideNodeSlot","labelDirections","denyAngles","inRange","handleNodeLabelAutoAdjustment","currentPos","oppositeNodes","getLoopCenter","defaultDirection","angles","oppositeNode","isSelfLoop","directionIndex","directionToIndex","azimuth","indexToDirection","amount","defaultValue","labelShiftV","labelShiftH","labelDiagonalShiftV","labelDiagonalShiftH","labelDirection","autoAdjustment","textAnchor","labelX","labelY","diagonalMargin","eventHandlers","groupClasses","handleEvents","labelClasses","hasOverrideNodeLabelSlot","onlyHasDisplayLabel","pathConfig","calcPathPoints","calcPathD","move","SYSTEM_SLOTS","__emit","_useSlots","nodesRef","edgesRef","pathsRef","layerDefs","definedSlots","layers","isShowGrid","isShowBackgroundViewport","builtInLayerOrder","show","onSvgPanZoomMounted","onSvgPanZoomUnmounted","isDoubleClickZoomEnabled","isMouseWheelZoomEnabled","rectSize","resizeObserver","stopEventPropagation","applyAbsoluteZoomLevel","absoluteZoomLevel","svgPanZoomInstance","applyZoomEnabled","initialZoomLevel","updateBorderBox","fitToContents","currentLayouts","panToCenter","getViewBox","setViewBox","currentSelectedNodes","currentSelectedEdges","currentSelectedPaths","dragging","touches","readonly","activateParams","newHandler","oldHandler","transitionStyles","autoPanAndZoom","nodesEmpty","pan1","pan2","panTo","panBy","getPan","getSizes","svgUtils.translateFromDomToSvgCoordinates","svgUtils.translateFromSvgToDomCoordinates","getAsSvg","exportAsSvgText","exportAsSvgElement","__expose","enable","enableDblClick","enableMouseWheel","view","_cache","_createElementBlock","_openBlock","_createBlock","_resolveDynamicComponent","_withCtx","degree","updatedConfig","DEFAULT_GRID","GridLayout","grid","install","app","components","componentName","component"],"mappings":"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","x_google_ignoreList":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,182,184,185,186,187,188,189]}